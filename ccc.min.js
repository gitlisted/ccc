ccc={};ccc.lib={};ccc.Object=function(){};ccc.Object.prototype.toSource=function(){return this.toString()};ccc.Object.prototype.compile=function(a){return this};ccc.Object.prototype.eval=function(b,a){return function(){return a(this)}.bind(this)};ccc.Object.prototype.eq=function(a){return this===a};ccc.Object.prototype.eqv=function(a){return this.eq(a)};ccc.Object.prototype.equal=function(a){return this.eqv(a)};ccc.Unspecified=function(){};ccc.Unspecified.prototype={__proto__:ccc.Object.prototype};ccc.Unspecified.prototype.constructor=ccc.Unspecified;ccc.Unspecified.prototype.toString=function(){return"#<unspecified>"};ccc.Unspecified.prototype.toSource=function(){return"#?"};ccc.unspecified=new ccc.Unspecified();ccc.Nil=function(){};ccc.Nil.prototype={__proto__:ccc.Object.prototype};ccc.Nil.prototype.constructor=ccc.Nil;ccc.Nil.prototype.toString=function(){return"#<nil>"};ccc.Nil.prototype.toSource=function(){return"()"};ccc.Nil.prototype.toArray=function(){return[]};ccc.nil=new ccc.Nil();ccc.Bool=function(a){this.value_=!!a};ccc.Bool.prototype={__proto__:ccc.Object.prototype};ccc.Bool.prototype.constructor=ccc.Bool;ccc.Bool.prototype.toString=function(){return"#<bool:"+this.value_.toString()+">"};ccc.Bool.prototype.toSource=function(){return this.value_?"#t":"#f"};ccc.t=new ccc.Bool(true);ccc.f=new ccc.Bool(false);ccc.Number=function(a){this.value_=a};ccc.Number.prototype={__proto__:ccc.Object.prototype};ccc.Number.prototype.constructor=ccc.Number;ccc.Number.prototype.toString=function(){return this.value_.toString()};ccc.Number.prototype.eq=function(a){return this.value_===a.value_};ccc.Char=function(a){this.charCode_=a};ccc.Char.prototype={__proto__:ccc.Object.prototype};ccc.Char.prototype.constructor=ccc.Char;ccc.Char.prototype.toString=function(){var a=this.charCode_.toString(16);return"#<char:"+"0000".substr(a.length)+a+">"};ccc.Char.prototype.toSource=function(){var a=this.charCode_.toString(16);return"#\\u"+"0000".substr(a.length)+a};ccc.Char.prototype.eq=function(a){return this.charCode_===a.charCode_};ccc.String=function(a){this.value_=a};ccc.String.prototype={__proto__:ccc.Object.prototype};ccc.String.prototype.constructor=ccc.String;ccc.String.prototype.sanitizedValue_=function(){return this.value_.replace("\n","\\n")};ccc.String.prototype.toString=function(){return'"'+this.sanitizedValue_()+'"'};ccc.String.prototype.eq=function(a){return this.value_===a.value_};ccc.Symbol=function(a){this.name=a};ccc.Symbol.prototype={__proto__:ccc.Object.prototype};ccc.Symbol.prototype.constructor=ccc.Symbol;ccc.Symbol.prototype.toString=function(){if(this.name.match(/[ \t\n\r\f\v()[\]\|;#"]/)){return"|"+this.name.replace("|","\\|").replace("\n","\\n")+"|"}return this.name};ccc.Symbol.prototype.compile=function(a){var b=a.lookup(this.name);if(b){return b}return new ccc.GlobalBinding(this.name)};ccc.Symbol.prototype.eq=function(a){return this.name===a.name};ccc.Pair=function(a,b){this.car_=a;this.cdr_=b};ccc.Pair.prototype={__proto__:ccc.Object.prototype};ccc.Pair.prototype.constructor=ccc.Pair;ccc.Pair.prototype.toString=function(){return"#<pair:"+this.car_.toString()+" . "+this.cdr_.toString()+">"};ccc.Pair.prototype.toSource=function(){return"("+this.sourcify_()+")"};ccc.Pair.prototype.sourcify_=function(){var a=this.car_.toSource();if(this.cdr_.constructor===ccc.Pair){a+=" "+this.cdr_.sourcify_()}else{if(this.cdr_!==ccc.nil){a+=" . "+this.cdr_.toSource()}}return a};ccc.Pair.makeList=function(){var b=ccc.nil;for(var a=arguments.length-1;a>=0;--a){b=new ccc.Pair(arguments[a],b)}return b};ccc.Pair.makeImproperList=function(a,b){var d=b;for(var c=a.length-1;c>=0;--c){d=new ccc.Pair(a[c],d)}return d};ccc.Pair.prototype.toArray=function(){var b=[];var a=this;while(a.constructor===ccc.Pair){b.push(a.car_);a=a.cdr_}if(a!==ccc.nil){throw new Error("Cannot convert improper list to an array")}return b};ccc.Pair.prototype.isList=function(){var a=this;while(a.constructor===ccc.Pair){a=a.cdr_}if(a===ccc.nil){return true}return false};ccc.Pair.prototype.forEach=function(b,a){var c=this;while(c.constructor===ccc.Pair){b(c.car_,c);c=c.cdr_}if(c.constructor!==ccc.Nil&&a){a(c)}};ccc.Pair.prototype.car=function(){return this.car_};ccc.Pair.prototype.cdr=function(){return this.cdr_};ccc.Pair.prototype.withCar=function(a){return new ccc.Pair(a,this.cdr_)};ccc.Pair.prototype.compileElements_=function(a){var b=this.car_.compile(a);if(this.cdr_.constructor===ccc.Pair){return new ccc.Pair(b,this.cdr_.compileElements_(a))}return new ccc.Pair(b,this.cdr_.compile(a))};ccc.Pair.prototype.compile=function(b){if(this.car_.constructor===ccc.Symbol&&!b.lookup(this.car_.name)){var a=b.lookupSyntax(this.car_.name);if(a){var c=a.transform(b,this.cdr_);return c.compile(b)}}return this.compileElements_(b)};ccc.Pair.prototype.eval=function(environment,continuation){return function(){return this.car_.eval(environment,function(callee){if(!callee.apply){throw new Error("Object "+this.car_.toString()+" is not applicable")}var argsForm=this.cdr_;var argEvaluator=function(argsRemaining,args){if(argsRemaining===ccc.nil){var argsList=ccc.Pair.makeList.apply(null,args);return callee.apply(environment,continuation,argsList)}if(argsRemaining.constructor!==ccc.Pair){throw new Error("Invalid argument list: "+argsForm.toSource())}var head=argsRemaining.car_;return head.eval(environment,function(value){return argEvaluator(argsRemaining.cdr_,args.concat(value))})};return argEvaluator(argsForm,[])}.bind(this))}.bind(this)};ccc.Pair.prototype.equal=function(d){var e=this,c=d;while(e.constructor===ccc.Pair&&c.constructor===ccc.Pair){if(e.constructor!==c.constructor||!e.car_.equal(c.car_)){return false}e=e.cdr_;c=c.cdr_}if(e.constructor!==c.constructor||!e.equal(c)){return false}return true};ccc.Vector=function(a){this.elements_=a};ccc.Vector.prototype={__proto__:ccc.Object.prototype};ccc.Vector.prototype.constructor=ccc.Vector;ccc.Vector.prototype.toString=function(){return"#<vector:"+this.elements_.toString()+">"};ccc.Vector.prototype.toSource=function(){return"#("+this.elements_.map(function(a){return a.toSource()}).join(" ")+")"};ccc.Vector.prototype.equal=function(a){if(this.elements_.length!==a.elements_.length){return false}for(var b=0;b<this.elements_.length;++b){if(!this.elements_[b].equal(a.elements_[b])){return false}}return true};ccc.Environment=function(a){this.syntaxBindings_={};this.globalBindings_={};this.lexicalBindings_={};this.localBindings_={};if(a){this.parent_=a;this.nextLocal_=a.nextLocal_}else{this.initToplevel_();this.nextLocal_=0}};ccc.Environment.prototype={__proto__:ccc.Object.prototype};ccc.Environment.prototype.constructor=ccc.Environment;ccc.Environment.prototype.toString=function(){return"#<environment>"};ccc.Environment.prototype.initToplevel_=function(){var b=ccc.PrimitiveTransformers;for(var a in b){if(b.hasOwnProperty(a)){this.bindSyntax(a,b[a])}}};ccc.Environment.prototype.lookupSyntax=function(a){if(this.syntaxBindings_.hasOwnProperty(a)){return this.syntaxBindings_[a]}if(this.parent_){return this.parent_.lookupSyntax(a)}return null};ccc.Environment.prototype.lookup=function(a){if(this.lexicalBindings_.hasOwnProperty(a)){return this.lexicalBindings_[a]}if(this.globalBindings_.hasOwnProperty(a)){return this.globalBindings_[a]}if(this.parent_){return this.parent_.lookup(a)}return null};ccc.Environment.prototype.lookupLocal=function(a){if(this.localBindings_.hasOwnProperty(a)){return this.localBindings_[a]}if(this.parent_){return this.parent_.lookupLocal(a)}return null};ccc.Environment.prototype.bindSyntax=function(b,a){this.syntaxBindings_[b]=a;return a};ccc.Environment.prototype.bindGlobal=function(b,c){var a=new ccc.Location(b,c);this.globalBindings_[b]=a;return a};ccc.Environment.prototype.bindLexical=function(a){var b=new ccc.LexicalBinding(a,++this.nextLocal_);this.lexicalBindings_[a]=b;return b};ccc.Environment.prototype.bindLocal=function(b,a){this.localBindings_[b.id_]=new ccc.Location(b.name_,a)};ccc.Environment.prototype.importLibrary=function(b,d){if(d===undefined){d=""}else{d=d+":"}var a=b.entries();for(var c in a){if(a.hasOwnProperty(c)){this.bindGlobal(d+c,a[c])}}};ccc.Environment.prototype.evalForm=function(form,opt_receiver){var compiledForm=form.compile(this);var terminate=function(value){if(opt_receiver){opt_receiver(value)}};var continuation=compiledForm.eval(this,terminate);var timeslice=function(){var cyclesPerSlice=1000;while(cyclesPerSlice-->0&&continuation){continuation=continuation()}if(continuation){setTimeout(timeslice,0)}};timeslice()};ccc.Environment.prototype.evalProgram=function(b,c){if(b.length===0){throw new Error("Empty program?")}b=b.slice();var a=function(){var d=b.shift();this.evalForm(d,function(e){if(c){c(e,false)}if(b.length>0){a()}else{if(c){c(e,true)}}})}.bind(this);a()};ccc.Location=function(a,b){this.name_=a;this.value_=b||ccc.unspecified};ccc.Location.prototype={__proto__:ccc.Object.prototype};ccc.Location.prototype.constructor=ccc.Location;ccc.Location.prototype.toString=function(){return"#<location:"+this.name_+">"};ccc.Location.prototype.eval=function(b,a){return function(){return a(this.value_)}.bind(this)};ccc.GlobalBinding=function(a){this.name_=a};ccc.GlobalBinding.prototype={__proto__:ccc.Object.prototype};ccc.GlobalBinding.prototype.constructor=ccc.GlobalBinding;ccc.GlobalBinding.prototype.toString=function(){return"#<global-binding:"+this.name_+">"};ccc.GlobalBinding.prototype.eval=function(b,a){return function(){var c=b.lookup(this.name_);if(!c){throw new Error("Unbound variable: "+this.name_)}return a(c.value_)}.bind(this)};ccc.LexicalBinding=function(a,b){this.name_=a;this.id_=b};ccc.LexicalBinding.prototype={__proto__:ccc.Object.prototype};ccc.LexicalBinding.prototype.constructor=ccc.LexicalBinding;ccc.LexicalBinding.prototype.toString=function(){return"#<binding:"+this.name_+">"};ccc.LexicalBinding.prototype.eval=function(b,a){return function(){return a(b.lookupLocal(this.id_).value_)}.bind(this)};ccc.NativeFunction=function(b,a){this.fn_=b;this.name_=a||"(anonymous)"};ccc.NativeFunction.prototype={__proto__:ccc.Object.prototype};ccc.NativeFunction.prototype.constructor=ccc.NativeFunction;ccc.NativeFunction.prototype.toString=function(){return"#<native-function:"+this.name_+">"};ccc.NativeFunction.prototype.apply=function(b,a,c){return this.fn_(b,a,c)};ccc.Closure=function(a,b,d,c){this.capturedEnvironment_=a;this.compiledBody_=b;this.namedArgBindings_=d;this.argsTailBinding_=c};ccc.Closure.prototype={__proto__:ccc.Object.prototype};ccc.Closure.prototype.constructor=ccc.Closure;ccc.Closure.prototype.toString=function(){return"#<closure>"};ccc.Closure.prototype.apply=function(environment,continuation,args){var callEnvironment=new ccc.Environment(this.capturedEnvironment_);for(var i=0;i<this.namedArgBindings_.length;++i){if(args.constructor!==ccc.Pair){throw new Error("Too few arguments applied to closure")}callEnvironment.bindLocal(this.namedArgBindings_[i],args.car());args=args.cdr()}if(args!==ccc.nil&&this.argsTailBinding_===ccc.nil){throw new Error("Too many arguments applied to closure")}if(this.argsTailBinding_!==ccc.nil){callEnvironment.bindLocal(this.argsTailBinding_,args)}var evalForms=function(forms){if(forms.length===1){return forms[0].eval(callEnvironment,continuation)}return forms[0].eval(callEnvironment,function(){return evalForms(forms.slice(1))})};return evalForms(this.compiledBody_.slice())};ccc.Continuation=function(a){this.fn_=a};ccc.Continuation.prototype={__proto__:ccc.Object.prototype};ccc.Continuation.prototype.constructor=ccc.Continuation;ccc.Continuation.prototype.toString=function(){return"#<continuation>"};ccc.Continuation.prototype.apply=function(b,a,c){if(c===ccc.nil||c.cdr()!==ccc.nil){throw new Error("Wrong number of args given to continuation")}return function(){return this.fn_(c.car())}.bind(this)};ccc.Transformer=function(a){this.transform_=a};ccc.Transformer.prototype={__proto__:ccc.Object.prototype};ccc.Transformer.prototype.constructor=ccc.Transformer;ccc.Transformer.prototype.toString=function(){return"#<transformer>"};ccc.Transformer.prototype.transform=function(a,b){return this.transform_(a,b)};ccc.PrimitiveTransformers={};ccc.PrimitiveTransformers.quote=new ccc.Transformer(function(a,c){var b=c.car();return new ccc.Pair(new ccc.NativeFunction(function(e,d,f){return function(){return d(b)}},"quote"),ccc.nil)});ccc.PrimitiveTransformers.define=new ccc.Transformer(function(b,e){if(e.constructor!==ccc.Pair){throw new Error("Invalid form for 'define: not enough arguments")}var f=e.car();if(f.constructor===ccc.Pair){var c=f.cdr();var a=e.cdr();f=f.car();return ccc.Pair.makeList(new ccc.Symbol("define"),f,new ccc.Pair(new ccc.Symbol("lambda"),new ccc.Pair(c,a)))}if(f.constructor!==ccc.Symbol){throw new Error("Invalid form for 'define: symbol expected as first argument")}var d=e.cdr();if(d.constructor!==ccc.Pair){throw new Error("Invalid form for 'define")}if(d.cdr()!==ccc.nil){throw new Error("Invalid form for 'define: too many arguments")}return e.withCar(new ccc.NativeFunction(function(h,g,i){return function(){var j=h.lookup(f.name);if(!j||j.constructor!==ccc.Location){h.bindGlobal(f.name,i.car())}else{j.value_=i.car()}return g(ccc.unspecified)}},"bind-variable"))});ccc.PrimitiveTransformers["set!"]=new ccc.Transformer(function(a,c){if(c.constructor!==ccc.Pair){throw new Error("Invalid form for 'set!: not enough arguments")}var d=c.car();if(d.constructor!==ccc.Symbol){throw new Error("Invalid form for 'set!: symbol expected as first argument")}var b=c.cdr();if(b.constructor!==ccc.Pair){throw new Error("Invalid form for 'set!")}if(b.cdr()!==ccc.nil){throw new Error("Invalid form for 'set!: too many arguments")}var e=d.compile(a);return c.withCar(new ccc.NativeFunction(function(g,f,h){return function(){var i=e;if(e.constructor===ccc.LexicalBinding){i=g.lookupLocal(e.id_)}else{if(e.constructor===ccc.GlobalBinding){i=g.lookup(e.name_)}}if(!i){throw new Error("Unbound variable: "+d.name)}i.value_=h.car();return f(ccc.unspecified)}},"set-variable"))});ccc.PrimitiveTransformers.lambda=new ccc.Transformer(function(d,a){if(a.constructor!==ccc.Pair){throw new Error("Bad lambda body: "+a.toString())}var h=a.car();var f=a.cdr();if(f.constructor!==ccc.Pair){throw new Error("Bad lambda body: "+a.toString())}var c=new ccc.Environment(d);var b=[];var e=ccc.nil;if(h.constructor===ccc.Symbol){e=c.bindLexical(h.name)}else{if(h.constructor===ccc.Pair){var j=function(k){if(k.constructor!==ccc.Symbol){throw new Error("Invalid args form")}b.push(c.bindLexical(k.name))};var g=function(k){if(k.constructor!==ccc.Symbol){throw new Error("Invalid args form")}e=c.bindLexical(k.name)};h.forEach(j,g)}else{if(h!==ccc.nil){throw new Error("Invalid args form")}}}var i=[];f.forEach(function(k){i.push(k.compile(c))},function(){throw new Error("Invalid lambda body")});return new ccc.Pair(new ccc.NativeFunction(function(l,k,m){return function(){return k(new ccc.Closure(l,i,b,e))}},"make-closure"),ccc.nil)});ccc.PrimitiveTransformers["if"]=new ccc.Transformer(function(environment,form){if(form.constructor!==ccc.Pair){throw new Error("Bad 'if form")}var condition=form.car();var consequent=form.cdr();if(consequent===ccc.nil||consequent.constructor!==ccc.Pair){throw new Error("Bad 'if form")}var alternate=consequent.cdr();consequent=consequent.car();if(alternate===ccc.nil){alternate=ccc.unspecified}else{if(alternate.constructor===ccc.Pair){if(alternate.cdr()!==ccc.nil){throw new Error("Bad 'if form")}alternate=alternate.car()}else{throw new Error("Bad 'if form")}}condition=condition.compile(environment);consequent=consequent.compile(environment);alternate=alternate.compile(environment);return new ccc.Pair(new ccc.NativeFunction(function(environment,continuation,args){return function(){return condition.eval(environment,function(value){if(value!==ccc.f){return consequent.eval(environment,continuation)}return alternate.eval(environment,continuation)})}},"if"),ccc.nil)});ccc.PrimitiveTransformers["native-apply"]=new ccc.Transformer(function(a,c){if(c.constructor!==ccc.Pair){throw new Error("Bad native call form")}var b=c.car();return c.withCar(new ccc.NativeFunction(function(e,d,f){f=f.toArray();return function(){var h=ccc.libutil.resolveNativeName(b);f=f.map(ccc.libutil.objectToNativeValue);var g=ccc.libutil.objectFromNativeValue(h.value.apply(h.object,f));return d(g)}},"native-apply"))});ccc.Library=function(a){this.name_=a;this.entries_={}};ccc.Library.prototype={__proto__:ccc.Object.prototype};ccc.Library.prototype.constructor=ccc.Library;ccc.Library.prototype.name=function(){return this.name_};ccc.Library.prototype.entries=function(){return this.entries_};ccc.Library.prototype.addNativeFunction=function(a,b){this.entries_[a]=new ccc.NativeFunction(b,this.name_+":"+a)};ccc.Library.prototype.addNativeFunctions=function(a){for(var b in a){if(a.hasOwnProperty(b)){this.addNativeFunction(b,a[b])}}};ccc.Library.prototype.addSimpleFunction=function(a,b){this.entries_[a]=new ccc.NativeFunction(function(e,d,f){f=f.toArray();if(b.length>0&&f.length!==b.length){throw new Error(a+": Wrong number of arguments. Expected "+b.length+"; received "+f.length)}var c=b.apply(null,f);if(c===undefined){c=ccc.unspecified}return d(c)},this.name_+":"+a)};ccc.Library.prototype.addSimpleFunctions=function(a){for(var b in a){if(a.hasOwnProperty(b)){this.addSimpleFunction(b,a[b])}}};ccc.Parser=(function(){function c(f,d){function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e()}function a(g,h,i,e,f){function d(l,m){function j(o){function p(q){return q.charCodeAt(0).toString(16).toUpperCase()}return o.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(q){return"\\x0"+p(q)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(q){return"\\x"+p(q)}).replace(/[\u0180-\u0FFF]/g,function(q){return"\\u0"+p(q)}).replace(/[\u1080-\uFFFF]/g,function(q){return"\\u"+p(q)})}var n,k;switch(l.length){case 0:n="end of input";break;case 1:n=l[0];break;default:n=l.slice(0,-1).join(", ")+" or "+l[l.length-1]}k=m?'"'+j(m)+'"':"end of input";return"Expected "+n+" but "+k+" found."}this.expected=g;this.found=h;this.offset=i;this.line=e;this.column=f;this.name="SyntaxError";this.message=d(g,h)}c(a,Error);function b(bg){var bZ=arguments.length>1?arguments[1]:{},s={start:cn,datum:o},bV=cn,aB=null,aA=function(cK){return cK},az=/^[ \t\f\r\n\x0B\xA0\u2000-\u200B\u2028\u2029\u202F\u3000]/,ay="[ \\t\\f\\r\\n\\x0B\\xA0\\u2000-\\u200B\\u2028\\u2029\\u202F\\u3000]",ax=[],av=function(){return""},au="",at=/^[ "\t\f\r\n();[\]|]/,ar='[ "\\t\\f\\r\\n();[\\]|]',aq="any character",cl=";",ck='";"',ci=/^[^\n\r]/,ch="[^\\n\\r]",cg=/^[\n\r]/,cf="[\\n\\r]",ce="#;",cd='"#;"',cc=function(cL,cK){return new ccc.Symbol(cL+cK.join(""))},cb=function(cK){return new ccc.Symbol(cK)},b9=/^[!$%&*\/:<=>?\^_~a-z0-9]/i,b7="[!$%&*\\/:<=>?\\^_~a-z0-9]i",b6=/^[\x80-\uFFFF]/,b5="[\\x80-\\uFFFF]",b4=function(cK){return cK},b3=/^[0-9]/,b2="[0-9]",b1=/^[0-9a-f]/i,b0="[0-9a-f]i",bY="+",bW='"+"',bU="-",bS='"-"',bQ=".",bP='"."',bO="@",bN='"@"',bM="...",bK='"..."',bJ="#t",bF='"#t"',bE=function(){return ccc.t},bD="#f",bC='"#f"',bB=function(){return ccc.f},bA="#\\space",bz='"#\\\\space"',by=function(){return new ccc.Char(32)},bx="#\\newline",bw='"#\\\\newline"',bs=function(){return new ccc.Char(10)},br="#\\x",bp='"#\\\\x"',bo=function(cL,cK){return new ccc.Char(parseInt(cL+cK,16))},bm="#\\u",bl='"#\\\\u"',bk=function(cL,cK,cN,cM){return new ccc.Char(parseInt(cL+cK+cN+cM,16))},bj="#\\",bi='"#\\\\"',bh=function(cK){return new ccc.Char(cK.charCodeAt(0))},bb='"',ba='"\\""',a9=function(cK){return new ccc.String(cK.join(""))},a8="\\\\",a7='"\\\\\\\\"',a6=function(){return"\\"},a5="\\n",a4='"\\\\n"',a3=function(){return"\n"},a2="\\t",aY='"\\\\t"',aX=function(){return"\t"},aW="\\f",aV='"\\\\f"',aU=function(){return"\f"},aT="\\r",aS='"\\\\r"',aR=function(){return"\r"},aQ="\\'",aO='"\\\\\'"',ap=function(){return"'"},ao='\\"',an='"\\\\\\""',am=function(){return'"'},al="\\x",ak='"\\\\x"',ai=function(cL,cK){return String.fromCharCode(parseInt(cL+cK,16))},ag="\\u",af='"\\\\u"',ae=function(cL,cK,cN,cM){return String.fromCharCode(parseInt(cL+cK+cN+cM,16))},O=/^[^"\\]/,N='[^"\\\\]',M="|",L='"|"',K=function(cK){return new ccc.Symbol(cK.join(""))},J=/^[^|\\]/,H="[^|\\\\]",G="\\|",F='"\\\\|"',D=function(){return"|"},aM="(",aL='"("',aK=")",aI='")"',aH=function(){return ccc.nil},aG="[",aF='"["',aE="]",aD='"]"',aC="#?",ad='"#?"',ac=function(){return ccc.unspecified},ab="#b",aa='"#b"',Z=/^[\-+]/,Y="[\\-+]",X=/^[01]/,U="[01]",T=function(cK,cL){return new ccc.Number(parseInt(cK+cL.join(""),2))},R="#o",C='"#o"',B=/^[0-7]/,A="[0-7]",z=function(cK,cL){return new ccc.Number(parseInt(cK+cL.join(""),8))},y="#x",x='"#x"',w=function(cK,cL){return new ccc.Number(parseInt(cK+cL.join(""),16))},v=/^[eE]/,u="[eE]",t=function(cL,cK,cM){return cL+cK+cM.join("")},n="#d",l='"#d"',k=function(cK,cM,cL,cN){return new ccc.Number(parseFloat(cK+cM.join("")+"."+cL.join("")+cN))},j=function(cK,cL,cM){return new ccc.Number(parseFloat(cK+cL.join("")+cM))},h=function(cK){return ccc.Pair.makeList.apply(null,cK.map(function(cL){return cL[0]}))},g=function(cL,cK){return ccc.Pair.makeImproperList(cL.map(function(cM){return cM[0]}),cK)},f=",@",e='",@"',d=function(cK){return ccc.Pair.makeList(new ccc.Symbol("unquote-splicing"),cK)},cJ="'",cH='"\'"',cF=function(cK){return ccc.Pair.makeList(new ccc.Symbol("quote"),cK)},cE="`",cD='"`"',cB=function(cK){return ccc.Pair.makeList(new ccc.Symbol("quasiquote"),cK)},cA=",",cy='","',cw=function(cK){return ccc.Pair.makeList(new ccc.Symbol("unquote"),cK)},cv="#(",cu='"#("',cs=function(cK){return new ccc.Vector(cK.map(function(cL){return cL[0]}))},cr="#[",cq='"#["',cp=function(cK){return cK.map(function(cL){return cL[0]})},bv=0,cI=0,co=0,aw={line:1,column:1,seenCR:false},a0=0,a1=[],cm=0,bd;if("startRule" in bZ){if(!(bZ.startRule in s)){throw new Error("Can't start parsing from rule \""+bZ.startRule+'".')}bV=s[bZ.startRule]}function b8(){return bg.substring(cI,bv)}function ct(){return cI}function cj(){return I(cI).line}function cz(){return I(cI).column}function I(cL){function cK(cO,cN,cM){var cQ,cP;for(cQ=cN;cQ<cM;cQ++){cP=bg.charAt(cQ);if(cP==="\n"){if(!cO.seenCR){cO.line++}cO.column=1;cO.seenCR=false}else{if(cP==="\r"||cP==="\u2028"||cP==="\u2029"){cO.line++;cO.column=1;cO.seenCR=true}else{cO.column++;cO.seenCR=false}}}}if(co!==cL){if(co>cL){co=0;aw={line:1,column:1,seenCR:false}}cK(aw,co,cL);co=cL}return aw}function ca(cK){if(bv<a0){return}if(bv>a0){a0=bv;a1=[]}a1.push(cK)}function S(cL){var cK=0;cL.sort();while(cK<cL.length){if(cL[cK-1]===cL[cK]){cL.splice(cK,1)}else{cK++}}}function cn(){var cN,cM,cL,cK;cN=bv;cM=cC();if(cM!==null){cL=cG();if(cL!==null){cK=cC();if(cK!==null){cI=cN;cM=aA(cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}return cN}function ah(){var cK;if(az.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ay)}}return cK}function bH(){var cK;cK=ah();if(cK===null){cK=cx()}return cK}function cC(){var cM,cL,cK;cM=bv;cL=[];cK=bH();while(cK!==null){cL.push(cK);cK=bH()}if(cL!==null){cI=cM;cL=av()}if(cL===null){bv=cM;cM=cL}else{cM=cL}return cM}function W(){var cM,cL,cK;cM=bv;cL=bv;cm++;if(at.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ar)}}cm--;if(cK!==null){bv=cL;cL=au}else{cL=aB}if(cL!==null){cK=cC();if(cK!==null){cL=[cL,cK];cM=cL}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}if(cM===null){cM=bv;cm++;if(bg.length>bv){cL=bg.charAt(bv);bv++}else{cL=null;if(cm===0){ca(aq)}}cm--;if(cL===null){cM=au}else{bv=cM;cM=aB}}return cM}function cx(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===59){cM=cl;bv++}else{cM=null;if(cm===0){ca(ck)}}if(cM!==null){cL=[];if(ci.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ch)}}while(cK!==null){cL.push(cK);if(ci.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ch)}}}if(cL!==null){if(cg.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(cf)}}if(cK===null){cK=au}if(cK!==null){cM=[cM,cL,cK];cN=cM}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.substr(bv,2)===ce){cM=ce;bv+=2}else{cM=null;if(cm===0){ca(cd)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cM=[cM,cL,cK];cN=cM}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}return cN}function bf(){var cN,cM,cL,cK;cN=bv;cM=V();if(cM!==null){cL=[];cK=i();while(cK!==null){cL.push(cK);cK=i()}if(cL!==null){cK=W();if(cK!==null){cI=cN;cM=cc(cM,cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;cM=bt();if(cM!==null){cL=W();if(cL!==null){cI=cN;cM=cb(cM);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bI()}}return cN}function V(){var cM,cL,cK;if(b9.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(b7)}}if(cM===null){cM=bv;cL=bv;cm++;cK=ah();cm--;if(cK===null){cL=au}else{bv=cL;cL=aB}if(cL!==null){if(b6.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(b5)}}if(cK!==null){cI=cM;cL=b4(cK);if(cL===null){bv=cM;cM=cL}else{cM=cL}}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}}return cM}function i(){var cK;cK=V();if(cK===null){cK=aZ();if(cK===null){cK=aJ()}}return cK}function aZ(){var cK;if(b3.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(b2)}}return cK}function bT(){var cK;if(b1.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(b0)}}return cK}function aJ(){var cK;if(bg.charCodeAt(bv)===43){cK=bY;bv++}else{cK=null;if(cm===0){ca(bW)}}if(cK===null){if(bg.charCodeAt(bv)===45){cK=bU;bv++}else{cK=null;if(cm===0){ca(bS)}}if(cK===null){if(bg.charCodeAt(bv)===46){cK=bQ;bv++}else{cK=null;if(cm===0){ca(bP)}}if(cK===null){if(bg.charCodeAt(bv)===64){cK=bO;bv++}else{cK=null;if(cm===0){ca(bN)}}}}}return cK}function bt(){var cK;if(bg.charCodeAt(bv)===43){cK=bY;bv++}else{cK=null;if(cm===0){ca(bW)}}if(cK===null){if(bg.charCodeAt(bv)===45){cK=bU;bv++}else{cK=null;if(cm===0){ca(bS)}}if(cK===null){if(bg.substr(bv,3)===bM){cK=bM;bv+=3}else{cK=null;if(cm===0){ca(bK)}}}}return cK}function aj(){var cM,cL,cK;cM=bv;if(bg.substr(bv,2).toLowerCase()===bJ){cL=bg.substr(bv,2);bv+=2}else{cL=null;if(cm===0){ca(bF)}}if(cL!==null){cK=W();if(cK!==null){cI=cM;cL=bE();if(cL===null){bv=cM;cM=cL}else{cM=cL}}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}if(cM===null){cM=bv;if(bg.substr(bv,2).toLowerCase()===bD){cL=bg.substr(bv,2);bv+=2}else{cL=null;if(cm===0){ca(bC)}}if(cL!==null){cK=W();if(cK!==null){cI=cM;cL=bB();if(cL===null){bv=cM;cM=cL}else{cM=cL}}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}}return cM}function Q(){var cP,cO,cN,cM,cL,cK,cQ;cP=bv;if(bg.substr(bv,7).toLowerCase()===bA){cO=bg.substr(bv,7);bv+=7}else{cO=null;if(cm===0){ca(bz)}}if(cO!==null){cN=W();if(cN!==null){cI=cP;cO=by();if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,9).toLowerCase()===bx){cO=bg.substr(bv,9);bv+=9}else{cO=null;if(cm===0){ca(bw)}}if(cO!==null){cN=W();if(cN!==null){cI=cP;cO=bs();if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,3).toLowerCase()===br){cO=bg.substr(bv,3);bv+=3}else{cO=null;if(cm===0){ca(bp)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cL=W();if(cL!==null){cI=cP;cO=bo(cN,cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,3).toLowerCase()===bm){cO=bg.substr(bv,3);bv+=3}else{cO=null;if(cm===0){ca(bl)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cL=bT();if(cL!==null){cK=bT();if(cK!==null){cQ=W();if(cQ!==null){cI=cP;cO=bk(cN,cM,cL,cK);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2)===bj){cO=bj;bv+=2}else{cO=null;if(cm===0){ca(bi)}}if(cO!==null){if(bg.length>bv){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(aq)}}if(cN!==null){cM=W();if(cM!==null){cI=cP;cO=bh(cN);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}}}}return cP}function bn(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===34){cM=bb;bv++}else{cM=null;if(cm===0){ca(ba)}}if(cM!==null){cL=[];cK=bR();while(cK!==null){cL.push(cK);cK=bR()}if(cL!==null){if(bg.charCodeAt(bv)===34){cK=bb;bv++}else{cK=null;if(cm===0){ca(ba)}}if(cK!==null){cI=cN;cM=a9(cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}return cN}function bX(){var cP,cO,cN,cM,cL,cK;cP=bv;if(bg.substr(bv,2)===a8){cO=a8;bv+=2}else{cO=null;if(cm===0){ca(a7)}}if(cO!==null){cI=cP;cO=a6()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===a5){cO=a5;bv+=2}else{cO=null;if(cm===0){ca(a4)}}if(cO!==null){cI=cP;cO=a3()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===a2){cO=a2;bv+=2}else{cO=null;if(cm===0){ca(aY)}}if(cO!==null){cI=cP;cO=aX()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===aW){cO=aW;bv+=2}else{cO=null;if(cm===0){ca(aV)}}if(cO!==null){cI=cP;cO=aU()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===aT){cO=aT;bv+=2}else{cO=null;if(cm===0){ca(aS)}}if(cO!==null){cI=cP;cO=aR()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===aQ){cO=aQ;bv+=2}else{cO=null;if(cm===0){ca(aO)}}if(cO!==null){cI=cP;cO=ap()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===ao){cO=ao;bv+=2}else{cO=null;if(cm===0){ca(an)}}if(cO!==null){cI=cP;cO=am()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===al){cO=al;bv+=2}else{cO=null;if(cm===0){ca(ak)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cI=cP;cO=ai(cN,cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2)===ag){cO=ag;bv+=2}else{cO=null;if(cm===0){ca(af)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cL=bT();if(cL!==null){cK=bT();if(cK!==null){cI=cP;cO=ae(cN,cM,cL,cK);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}}}}}}}}return cP}function bR(){var cK;if(O.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(N)}}if(cK===null){cK=bX()}return cK}function bI(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===124){cM=M;bv++}else{cM=null;if(cm===0){ca(L)}}if(cM!==null){cL=[];cK=bc();if(cK!==null){while(cK!==null){cL.push(cK);cK=bc()}}else{cL=aB}if(cL!==null){if(bg.charCodeAt(bv)===124){cK=M;bv++}else{cK=null;if(cm===0){ca(L)}}if(cK!==null){cI=cN;cM=K(cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}return cN}function bc(){var cL,cK;if(J.test(bg.charAt(bv))){cL=bg.charAt(bv);bv++}else{cL=null;if(cm===0){ca(H)}}if(cL===null){cL=bv;if(bg.substr(bv,2)===G){cK=G;bv+=2}else{cK=null;if(cm===0){ca(F)}}if(cK!==null){cI=cL;cK=D()}if(cK===null){bv=cL;cL=cK}else{cL=cK}if(cL===null){cL=bX()}}return cL}function aN(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===40){cM=aM;bv++}else{cM=null;if(cm===0){ca(aL)}}if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===41){cK=aK;bv++}else{cK=null;if(cm===0){ca(aI)}}if(cK!==null){cI=cN;cM=aH();if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===91){cM=aG;bv++}else{cM=null;if(cm===0){ca(aF)}}if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===93){cK=aE;bv++}else{cK=null;if(cm===0){ca(aD)}}if(cK!==null){cI=cN;cM=aH();if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}return cN}function be(){var cL,cK;cL=bv;if(bg.substr(bv,2)===aC){cK=aC;bv+=2}else{cK=null;if(cm===0){ca(ad)}}if(cK!==null){cI=cL;cK=ac()}if(cK===null){bv=cL;cL=cK}else{cL=cK}return cL}function P(){var cK;cK=q();if(cK===null){cK=m();if(cK===null){cK=p();if(cK===null){cK=r()}}}return cK}function q(){var cO,cN,cM,cL,cK;cO=bv;if(bg.substr(bv,2).toLowerCase()===ab){cN=bg.substr(bv,2);bv+=2}else{cN=null;if(cm===0){ca(aa)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];if(X.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(U)}}if(cK!==null){while(cK!==null){cL.push(cK);if(X.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(U)}}}}else{cL=aB}if(cL!==null){cK=W();if(cK!==null){cI=cO;cN=T(cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function m(){var cO,cN,cM,cL,cK;cO=bv;if(bg.substr(bv,2).toLowerCase()===R){cN=bg.substr(bv,2);bv+=2}else{cN=null;if(cm===0){ca(C)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];if(B.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(A)}}if(cK!==null){while(cK!==null){cL.push(cK);if(B.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(A)}}}}else{cL=aB}if(cL!==null){cK=W();if(cK!==null){cI=cO;cN=z(cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function p(){var cO,cN,cM,cL,cK;cO=bv;if(bg.substr(bv,2).toLowerCase()===y){cN=bg.substr(bv,2);bv+=2}else{cN=null;if(cm===0){ca(x)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];cK=bT();if(cK!==null){while(cK!==null){cL.push(cK);cK=bT()}}else{cL=aB}if(cL!==null){cK=W();if(cK!==null){cI=cO;cN=w(cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function bq(){var cO,cN,cM,cL,cK;cO=bv;if(v.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(u)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];cK=aZ();if(cK!==null){while(cK!==null){cL.push(cK);cK=aZ()}}else{cL=aB}if(cL!==null){cI=cO;cN=t(cN,cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function r(){var cP,cO,cN,cM,cL,cK,cR,cQ;cP=bv;if(bg.substr(bv,2).toLowerCase()===n){cO=bg.substr(bv,2);bv+=2}else{cO=null;if(cm===0){ca(l)}}if(cO===null){cO=au}if(cO!==null){if(Z.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(Y)}}if(cN===null){cN=au}if(cN!==null){cM=[];cL=aZ();while(cL!==null){cM.push(cL);cL=aZ()}if(cM!==null){if(bg.charCodeAt(bv)===46){cL=bQ;bv++}else{cL=null;if(cm===0){ca(bP)}}if(cL!==null){cK=[];cR=aZ();if(cR!==null){while(cR!==null){cK.push(cR);cR=aZ()}}else{cK=aB}if(cK!==null){cR=bq();if(cR===null){cR=au}if(cR!==null){cQ=W();if(cQ!==null){cI=cP;cO=k(cN,cM,cK,cR);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2).toLowerCase()===n){cO=bg.substr(bv,2);bv+=2}else{cO=null;if(cm===0){ca(l)}}if(cO===null){cO=au}if(cO!==null){if(Z.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(Y)}}if(cN===null){cN=au}if(cN!==null){cM=[];cL=aZ();if(cL!==null){while(cL!==null){cM.push(cL);cL=aZ()}}else{cM=aB}if(cM!==null){if(bg.charCodeAt(bv)===46){cL=bQ;bv++}else{cL=null;if(cm===0){ca(bP)}}if(cL!==null){cK=[];cR=aZ();while(cR!==null){cK.push(cR);cR=aZ()}if(cK!==null){cR=bq();if(cR===null){cR=au}if(cR!==null){cQ=W();if(cQ!==null){cI=cP;cO=k(cN,cM,cK,cR);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2).toLowerCase()===n){cO=bg.substr(bv,2);bv+=2}else{cO=null;if(cm===0){ca(l)}}if(cO===null){cO=au}if(cO!==null){if(Z.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(Y)}}if(cN===null){cN=au}if(cN!==null){cM=[];cL=aZ();if(cL!==null){while(cL!==null){cM.push(cL);cL=aZ()}}else{cM=aB}if(cM!==null){cL=bq();if(cL===null){cL=au}if(cL!==null){cK=W();if(cK!==null){cI=cP;cO=j(cN,cM,cL);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}}return cP}function o(){var cK;cK=bL();if(cK===null){cK=E()}return cK}function bL(){var cK;cK=aj();if(cK===null){cK=P();if(cK===null){cK=Q();if(cK===null){cK=bn();if(cK===null){cK=bf();if(cK===null){cK=aN();if(cK===null){cK=be()}}}}}}return cK}function E(){var cK;cK=aP();if(cK===null){cK=bu()}return cK}function aP(){var cS,cR,cQ,cP,cO,cN,cM,cL,cK;cS=bv;if(bg.charCodeAt(bv)===40){cR=aM;bv++}else{cR=null;if(cm===0){ca(aL)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===41){cO=aK;bv++}else{cO=null;if(cm===0){ca(aI)}}if(cO!==null){cI=cS;cR=h(cP);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bv;if(bg.charCodeAt(bv)===40){cR=aM;bv++}else{cR=null;if(cm===0){ca(aL)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===46){cO=bQ;bv++}else{cO=null;if(cm===0){ca(bP)}}if(cO!==null){cN=cC();if(cN!==null){cM=o();if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===41){cK=aK;bv++}else{cK=null;if(cm===0){ca(aI)}}if(cK!==null){cI=cS;cR=g(cP,cM);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bv;if(bg.charCodeAt(bv)===91){cR=aG;bv++}else{cR=null;if(cm===0){ca(aF)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===93){cO=aE;bv++}else{cO=null;if(cm===0){ca(aD)}}if(cO!==null){cI=cS;cR=h(cP);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bv;if(bg.charCodeAt(bv)===91){cR=aG;bv++}else{cR=null;if(cm===0){ca(aF)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===46){cO=bQ;bv++}else{cO=null;if(cm===0){ca(bP)}}if(cO!==null){cN=cC();if(cN!==null){cM=o();if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===93){cK=aE;bv++}else{cK=null;if(cm===0){ca(aD)}}if(cK!==null){cI=cS;cR=g(cP,cM);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bG()}}}}return cS}function bG(){var cN,cM,cL,cK;cN=bv;if(bg.substr(bv,2)===f){cM=f;bv+=2}else{cM=null;if(cm===0){ca(e)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=d(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===39){cM=cJ;bv++}else{cM=null;if(cm===0){ca(cH)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=cF(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===96){cM=cE;bv++}else{cM=null;if(cm===0){ca(cD)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=cB(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===44){cM=cA;bv++}else{cM=null;if(cm===0){ca(cy)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=cw(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}}}return cN}function bu(){var cP,cO,cN,cM,cL,cK,cQ;cP=bv;if(bg.substr(bv,2)===cv){cO=cv;bv+=2}else{cO=null;if(cm===0){ca(cu)}}if(cO!==null){cN=cC();if(cN!==null){cM=[];cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}while(cL!==null){cM.push(cL);cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}}if(cM!==null){if(bg.charCodeAt(bv)===41){cL=aK;bv++}else{cL=null;if(cm===0){ca(aI)}}if(cL!==null){cI=cP;cO=cs(cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2)===cr){cO=cr;bv+=2}else{cO=null;if(cm===0){ca(cq)}}if(cO!==null){cN=cC();if(cN!==null){cM=[];cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}while(cL!==null){cM.push(cL);cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}}if(cM!==null){if(bg.charCodeAt(bv)===93){cL=aE;bv++}else{cL=null;if(cm===0){ca(aD)}}if(cL!==null){cI=cP;cO=cs(cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}return cP}function cG(){var cO,cN,cM,cL,cK;cO=bv;cN=[];cM=bv;cL=o();if(cL!==null){cK=cC();if(cK!==null){cL=[cL,cK];cM=cL}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}while(cM!==null){cN.push(cM);cM=bv;cL=o();if(cL!==null){cK=cC();if(cK!==null){cL=[cL,cK];cM=cL}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}}if(cN!==null){cI=cO;cN=cp(cN)}if(cN===null){bv=cO;cO=cN}else{cO=cN}return cO}bd=bV();if(bd!==null&&bv===bg.length){return bd}else{S(a1);cI=Math.max(bv,a0);throw new a(a1,cI<bg.length?bg.charAt(cI):null,cI,I(cI).line,I(cI).column)}}return{SyntaxError:a,parse:b}})();ccc.libutil={};ccc.libutil.objectToNativeValue=function(b){var a=function(){throw new Error("Unable to convert object "+b+" to native value")};if(b===ccc.unspecified){return undefined}if(b===ccc.nil){return null}if(b===ccc.t){return true}if(b===ccc.f){return false}if(b.constructor===ccc.Number){return b.value_}if(b.constructor===ccc.String){return b.value_}if(b.constructor===ccc.Symbol){return b.name}if(b.constructor===ccc.Vector){return b.elements_.map(ccc.libutil.objectToNativeValue)}if(b.constructor===ccc.Pair){var c={};b.forEach(function(d){if(d.constructor!==ccc.Pair){a()}if(d.cdr().constructor!==ccc.Pair){a()}if(d.cdr().cdr()!==ccc.nil){a()}c[ccc.libutil.objectToNativeValue(d.car())]=ccc.libutil.objectToNativeValue(d.cdr().car())},function(){a()});return c}a()};ccc.libutil.objectFromNativeValue=function(e,b){if(e===undefined){return ccc.unspecified}if(e===null){return ccc.nil}if(e===true){return ccc.t}if(e===false){return ccc.f}if(+e===e){return new ccc.Number(e)}if(""+e===e){return new ccc.String(e)}if(e instanceof Array){if(b){return ccc.unspecified}var f=function(g){return ccc.libutil.objectFromNativeValue(g,true)};return new ccc.Vector(e.map(f))}if(e instanceof Object){if(b){return ccc.unspecified}var a=[];for(var c in e){if(e.hasOwnProperty(c)){var d=ccc.libutil.objectFromNativeValue(e[c],true);if(d!==undefined){a.push(ccc.Pair.makeList(new ccc.Symbol(c),d))}}}return ccc.Pair.makeList.apply(null,a)}throw new Error("Unable to convert native value "+e+" to object")};ccc.libutil.resolveNativeName=function(b){if(b.constructor===ccc.Symbol){return{object:window,value:window[b.name]}}else{if(b.constructor===ccc.Pair){var d=b.toArray().map(function(e){return e.toString()});var a=window;var c=window;while(c instanceof Object&&d.length>0){a=c;c=c[d.shift()]}if(d.length===0){return{object:a,value:c}}}}throw new Error("Unable to resolve native object name: "+b.toSource())};ccc.lib.base=new ccc.Library("base");(function(){var a=function(b){if(b.constructor===ccc.String){return b.value_}if(b.constructor===ccc.Symbol){return b.name}throw new Error("load: Names and prefixes must be symbols or strings")};ccc.lib.base.addNativeFunction("load",function(d,c,g){g=g.toArray();if(g.length<1){throw new Error("load: Expected at least 1 argument; received 0.")}for(var h=0;h<g.length;++h){var b=g[h];var f,j;if(b.constructor===ccc.Pair){f=a(b.car());j=a(b.cdr())}else{f=a(b);j=f}var e=ccc.lib[f];if(!e||e.constructor!==ccc.Library){throw new Error("load: Unknown library '"+f)}d.importLibrary(e,j)}return c(ccc.unspecified)})}());(function(){var b=function(f,d,e){if(f.constructor!==ccc.Number){throw new Error(e+": Argument "+d+" is not a number")}};ccc.lib.base.addSimpleFunctions({"+":function(){var d=0;Array.prototype.forEach.call(arguments,function(f,e){b(f,e,"+");d+=f.value_});return new ccc.Number(d)},"*":function(){var d=1;Array.prototype.forEach.call(arguments,function(f,e){b(f,e,"*");d*=f.value_});return new ccc.Number(d)},"-":function(){var d;if(arguments.length===0){throw new Error("-: Not enough arguments applied")}b(arguments[0],0,"-");if(arguments.length===1){return new ccc.Number(-arguments[0].value_)}else{d=arguments[0].value_}Array.prototype.slice.call(arguments,1).forEach(function(f,e){b(f,e+1,"-");d-=f.value_});return new ccc.Number(d)},"/":function(){var d;if(arguments.length===0){throw new Error("/: Not enough arguments applied")}b(arguments[0],0,"/");if(arguments.length===1){return new ccc.Number(1/arguments[0].value_)}else{d=arguments[0].value_}Array.prototype.slice.call(arguments,1).forEach(function(f,e){b(f,e+1,"/");d/=f.value_});return new ccc.Number(d)},"integer?":function(d){if(d.constructor===ccc.Number&&d.value_===(d.value_|0)){return ccc.t}return ccc.f},"zero?":function(d){b(d,0,"zero?");return d.value_===0?ccc.t:ccc.f},"positive?":function(d){b(d,0,"positive?");return d.value_>0?ccc.t:ccc.f},"negative?":function(d){b(d,0,"negative?");return d.value_<0?ccc.t:ccc.f},"even?":function(d){b(d,0,"even?");return d.value_%2===0?ccc.t:ccc.f},"odd?":function(d){b(d,0,"odd?");return d.value_%2===1?ccc.t:ccc.f},max:function(){var e=Array.prototype.slice.call(arguments);if(e.length===0){throw new Error("max: Expected at least 1 argument")}var d=e[0];b(d,0,"max");e.slice(1).forEach(function(g,f){b(g,f+1,"max");if(g.value_>d.value_){d=g}});return d},min:function(){var d=Array.prototype.slice.call(arguments);if(d.length===0){throw new Error("min: Expected at least 1 argument")}var e=d[0];b(e,0,"min");d.slice(1).forEach(function(g,f){b(g,f+1,"min");if(g.value_<e.value_){e=g}});return e},modulo:function(e,d){b(e,0,"modulo");b(d,1,"modulo");return new ccc.Number(e.value_%d.value_)},});var c=function(e,d){ccc.lib.base.addSimpleFunction(d,function(){var f=Array.prototype.slice.call(arguments);if(f.length!==e.length){throw new Error(d+": Expected exactly "+e.length+" arguments")}var g=f.map(function(i,h){b(i,h,d);return i.value_});return new ccc.Number(e.apply(null,g))})};c(Math.abs,"abs");c(Math.floor,"floor");c(Math.ceil,"ceiling");c(Math.exp,"exp");c(Math.log,"log");c(Math.sin,"sin");c(Math.cos,"cos");c(Math.tan,"tan");c(Math.asin,"asin");c(Math.acos,"acos");c(Math.sqrt,"sqrt");c(Math.pow,"expt");ccc.lib.base.addSimpleFunction("atan",function(){var d=Array.prototype.slice.call(arguments);if(d.length<1||d.length>2){throw new Error("atan: Expected 1 or 2 arguments")}b(d[0],0,"atan");if(d.length===1){return new ccc.Number(Math.atan(d[0].value_))}b(d[1],1,"atan");return new ccc.Number(Math.atan2(d[0].value_,d[1].value_))});var a=function(e,d){ccc.lib.base.addSimpleFunction(e,function(){var f=Array.prototype.slice.call(arguments);if(f.length<2){return ccc.t}var h=f[0];b(h,0,e);for(var g=1;g<f.length;++g){b(f[g],g,e);if(!d(h.value_,f[g].value_)){return ccc.f}h=f[g]}return ccc.t})};a("=",function(e,d){return e===d});a("<",function(e,d){return e<d});a(">",function(e,d){return e>d});a("<=",function(e,d){return e<=d});a(">=",function(e,d){return e>=d})}());(function(){var b=function(d){return function(e){return d(e)?ccc.t:ccc.f}};var a=function(d){return function(e){return e.constructor===d?ccc.t:ccc.f}};var c=function(d){return function(){var e=true;if(arguments.length<2){return ccc.t}var g=arguments[0];for(var f=1;f<arguments.length&&e;++f){e=e&&d(g,arguments[f])}return e?ccc.t:ccc.f}};ccc.lib.base.addSimpleFunctions({"boolean?":a(ccc.Boolean),"number?":a(ccc.Number),"string?":a(ccc.String),"char?":a(ccc.Char),"symbol?":a(ccc.Symbol),"pair?":a(ccc.Pair),"vector?":a(ccc.Vector),"null?":b(function(d){return d===ccc.nil}),"procedure?":b(function(d){return d.apply instanceof Function}),"eq?":c(function(e,d){return e.eq(d)}),"eqv?":c(function(e,d){return e.eqv(d)}),"equal?":c(function(e,d){return e.equal(d)}),not:b(function(d){return d===ccc.f}),})}());(function(){var b=function(e,c,d){if(e.constructor!==ccc.Pair){throw new Error(d+": Argument "+c+" is not a pair.")}};ccc.lib.base.addSimpleFunctions({car:function(c){b(c,0,"car");return c.car()},cdr:function(c){b(c,0,"cdr");return c.cdr()},cons:function(c,d){return new ccc.Pair(c,d)},list:function(){return ccc.Pair.makeList.apply(null,Array.prototype.slice.call(arguments))},"set-car!":function(d,c){b(d,0,"set-car!");d.car_=c},"set-cdr!":function(d,c){b(d,0,"set-cdr!");d.cdr_=c},length:function(d){if(d===ccc.nil){return new ccc.Number(0)}var c=0;b(d,0,"length");d.forEach(function(){++c},function(){throw new Error("length: Expected proper list")});return new ccc.Number(c)},append:function(){var e=Array.prototype.slice.call(arguments);var d=e.length>0?e[e.length-1]:ccc.nil;for(var f=e.length-2;f>=0;--f){var g=e[f];var c=[];if(g===ccc.nil){continue}b(g,f,"append");g.forEach(function(h){c.push(h)},function(){throw new Error("append: Argument "+f+" is not a proper list")});while(c.length>0){d=new ccc.Pair(c.pop(),d)}}return d},reverse:function(c){var d=ccc.nil;if(c===ccc.nil){return ccc.nil}b(c,0,"reverse");c.forEach(function(e){d=new ccc.Pair(e,d)},function(){throw new Error("reverse: Expected proper list")});return d},"list-tail":function(d,c){if(c.constructor!==ccc.Number){throw new Error("list-tail: Argument 1 is not a number")}if(c.value_<1){return d}c=c.value_;while(c>0){if(d.constructor!==ccc.Pair){throw new Error("list-tail: Wrong argument type")}d=d.cdr();--c}return d},"list-ref":function(d,c){if(c.constructor!==ccc.Number||c.value_<0){throw new Error("list-ref: Invalid index")}c=c.value_;while(c>0){if(d.constructor!==ccc.Pair){throw new Error("list-ref: Wrong argument type")}d=d.cdr();--c}if(d.constructor!==ccc.Pair){throw new Error("list-ref: Wrong argument type")}return d.car()},memq:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"memq");while(d.constructor===ccc.Pair){if(c.eq(d.car())){return d}d=d.cdr()}if(d!==ccc.nil){throw new Error("memq: Improper list")}return ccc.f},memv:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"memv");while(d.constructor===ccc.Pair){if(c.eqv(d.car())){return d}d=d.cdr()}if(d!==ccc.nil){throw new Error("memv: Improper list")}return ccc.f},member:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"member");while(d.constructor===ccc.Pair){if(c.equal(d.car())){return d}d=d.cdr()}if(d!==ccc.nil){throw new Error("member: Improper list")}return ccc.f},assq:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"assq");while(d.constructor===ccc.Pair){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assq: Invalid association list")}if(c.eq(e.car())){return e}d=d.cdr()}if(d!==ccc.nil){throw new Error("assq: Invalid association list")}return ccc.f},assv:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"assv");while(d.constructor===ccc.Pair){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assv: Invalid association list")}if(c.eqv(e.car())){return e}d=d.cdr()}if(d!==ccc.nil){throw new Error("assv: Invalid association list")}return ccc.f},assoc:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"assoc");while(d.constructor===ccc.Pair){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assoc: Invalid association list")}if(c.equal(e.car())){return e}d=d.cdr()}if(d!==ccc.nil){throw new Error("assoc: Invalid association list")}return ccc.f},});var a=function(f){var d="c"+f+"r";var c={a:ccc.Pair.prototype.car,d:ccc.Pair.prototype.cdr};var e=f.split("").map(function(g){return c[g]});e.reverse();ccc.lib.base.addSimpleFunction(d,function(g){e.forEach(function(h){if(g.constructor!==ccc.Pair){throw new Error(d+": Pair expected")}g=h.apply(g)});return g})};["aa","ad","da","dd","aaa","aad","ada","add","daa","dad","dda","ddd","aaaa","aaad","aada","aadd","adaa","adad","adda","addd","daaa","daad","dada","dadd","ddaa","ddad","ddda","dddd"].forEach(a)}());(function(){var d=function(h,f,g){if(h.constructor!==ccc.Number){throw new Error(g+": Argument "+f+" is not a number")}};var a=function(h,f,g){if(h.constructor!==ccc.Char){throw new Error(g+": Argument "+f+" is not a character")}};var e=function(g,f){ccc.lib.base.addSimpleFunction(g,function(i,h){a(i,0,g);a(h,1,g);return f(i.charCode_,h.charCode_)?ccc.t:ccc.f})};e("char=?",function(g,f){return g===f});e("char<?",function(g,f){return g<f});e("char>?",function(g,f){return g>f});e("char<=?",function(g,f){return g<=f});e("char>=?",function(g,f){return g>=f});var c=function(g,f){ccc.lib.base.addSimpleFunction(g,function(k,j){a(k,0,g);a(j,1,g);var i=String.fromCharCode(k.charCode_).toLocaleLowerCase().charCodeAt(0);var h=String.fromCharCode(j.charCode_).toLocaleLowerCase().charCodeAt(0);return f(i,h)?ccc.t:ccc.f})};c("char-ci=?",function(g,f){return g===f});c("char-ci<?",function(g,f){return g<f});c("char-ci>?",function(g,f){return g>f});c("char-ci<=?",function(g,f){return g<=f});c("char-ci>=?",function(g,f){return g>=f});var b=function(f,g){ccc.lib.base.addSimpleFunction(f,function(h){a(h,0,f);return String.fromCharCode(h.charCode_).match(g)?ccc.t:ccc.f})};b("char-alphabetic?",/[a-zA-Z]/);b("char-numeric?",/[0-9]/);b("char-whitespace?",/[ \t\f\r\n\v\xa0\u2000-\u200b\u2028\u2029\u202f\u3000]/);b("char-upper-case?",/[A-Z]/);b("char-lower-case?",/[a-z]/);ccc.lib.base.addSimpleFunctions({"char->integer":function(f){a(f,0,"char->integer");return new ccc.Number(f.charCode_)},"integer->char":function(f){d(f,0,"integer->char");if((f.value_|0)!==f.value_){throw new Error("integer->char: Expected integer")}return new ccc.Char(f.value_)},"char-upcase":function(f){a(f,0,"char-upcase");return new ccc.Char(String.fromCharCode(f.charCode_).toLocaleUpperCase().charCodeAt(0))},"char-downcase":function(f){a(f,0,"char-downcase");return new ccc.Char(String.fromCharCode(f.charCode_).toLocaleLowerCase().charCodeAt(0))},})}());(function(){var c=function(h,f,g){if(h.constructor!==ccc.String){throw new Error(g+": Argument "+f+" is not a string")}};var a=function(h,f,g){if(h.constructor!==ccc.Char){throw new Error(g+": Argument "+f+" is not a character")}};var d=function(h,f,g){if(h.constructor!==ccc.Number){throw new Error(g+": Argument "+f+" is not a number")}};ccc.lib.base.addSimpleFunctions({"make-string":function(g,f){d(g,0,"make-string");a(f,1,"make-string");return new ccc.String((Array(g.value_+1)).join(String.fromCharCode(f.charCode_)))},string:function(){var g=Array.prototype.slice.call(arguments);var f="";g.forEach(function(i,h){a(i,h,"string");f+=String.fromCharCode(i.charCode_)});return new ccc.String(f)},"string-length":function(f){c(f,0,"string-length");return new ccc.Number(f.value_.length)},"string-ref":function(g,f){c(g,0,"string-ref");d(f,1,"string-ref");f=f.value_|0;if(f<0||f>=g.value_.length){throw new Error("string-ref: Index out of bounds")}return new ccc.Char(g.value_.charCodeAt(f))},"string-set!":function(g,f,h){c(g,0,"string-set!");d(f,1,"string-set!");a(h,2,"string-set!");f=f.value_|0;if(f<0||f>=g.value_.length){throw new Error("string-set!: Index out of bounds")}g.value_=g.value_.substr(0,f)+String.fromCharCode(h.charCode_)+g.value_.substr(f+1)},substring:function(g,h,f){c(g,0,"substring");d(h,1,"substring");d(f,1,"substring");if(h>f){throw new Error("substring: Invalid range")}if(f>g.value_.length){throw new Error("substring: Index out of range")}return new ccc.String(g.value_.substring(h,f))},"string-append":function(){var g=Array.prototype.slice.call(arguments);var f="";g.forEach(function(h,i){c(h,i,"string-append");f+=h.value_});return new ccc.String(f)},"string->symbol":function(f){c(f,0,"string->symbol");return new ccc.Symbol(f.value_)},"symbol->string":function(f){if(f.constructor!==ccc.Symbol){throw new Error("symbol->string: Expected symbol; received "+f)}return new ccc.String(f.name)},"number->string":function(){var f=Array.prototype.slice.call(arguments);var g=10;if(f.length<1||f.length>2){throw new Error("number->string: Expected 1 or 2 arguments")}d(f[0],0,"number->string");if(f.length===2){d(f[1],1,"number->string");g=f[1].value_}return new ccc.String(f[0].value_.toString(g))},"string->number":function(){var f=Array.prototype.slice.call(arguments);var g=10;if(f.length<1||f.length>2){throw new Error("string->number: Expected 1 or 2 arguments")}if(f[0].constructor!==ccc.String){throw new Error("string->number: Argument 0 is not a string")}if(f.length===2){d(f[1],1,"string->number");g=f[1].value_}return new ccc.Number(parseInt(f[0].value_,g))},"string->list":function(f){c(f,0,"string->list");var h=[];for(var g=0;g<f.value_.length;++g){h.push(new ccc.Char(f.value_.charCodeAt(g)))}return ccc.Pair.makeList.apply(null,h)},"list->string":function(g){if(g!==ccc.nil&&g.constructor!==ccc.Pair){throw new Error("list->string: Argument 0 is not a list")}var f="";g.forEach(function(h){if(h.constructor!==ccc.Char){throw new Error("list->string: Expected list of characters")}f+=String.fromCharCode(h.charCode_)},function(){throw new Error("list->string: Argument 0 is not a proper list")});return new ccc.String(f)},"string-copy":function(f){c(f,0,"string-copy");return new ccc.String(f.value_)},"string-fill!":function(f,g){c(f,0,"string-fill!");a(g,1,"string-fill!");f.value_=(Array(f.value_.length+1)).join(String.fromCharCode(g.charCode_))},});var b=function(g,f){ccc.lib.base.addSimpleFunction(g,function(h,i){c(h,0,g);c(i,1,g);return f(h.value_,i.value_)?ccc.t:ccc.f})};b("string=?",function(g,f){return g===f});b("string<?",function(g,f){return g<f});b("string>?",function(g,f){return g>f});b("string<=?",function(g,f){return g<=f});b("string>=?",function(g,f){return g>=f});var e=function(g,f){ccc.lib.base.addSimpleFunction(g,function(h,i){c(h,0,g);c(i,1,g);return f(h.value_.toLocaleLowerCase(),i.value_.toLocaleLowerCase())?ccc.t:ccc.f})};e("string-ci=?",function(g,f){return g===f});e("string-ci<?",function(g,f){return g<f});e("string-ci>?",function(g,f){return g>f});e("string-ci<=?",function(g,f){return g<=f});e("string-ci>=?",function(g,f){return g>=f})}());(function(){var a=function(e,c,d){if(e.constructor!==ccc.Number||e.value_!==(e.value_|0)){throw new Error(d+": Argument "+c+" is not an integer")}};var b=function(e,c,d){if(e.constructor!==ccc.Vector){throw new Error(d+": Argument "+c+"is not a vector")}};ccc.lib.base.addSimpleFunctions({"make-vector":function(){var c=Array.prototype.slice.call(arguments);if(c.length===0){throw new Error("make-vector: Expected 1 or 2 argments; received 0")}if(c.length>2){throw new Error("make-vector: Expected 1 or 2 arguments; received "+c.length)}var f=c.length===2?c[1]:ccc.unspecified;var e=[];a(c[0],0,"make-vector");for(var d=0;d<c[0].value_;++d){e[d]=f}return new ccc.Vector(e)},vector:function(){var c=Array.prototype.slice.call(arguments);return new ccc.Vector(c)},"vector-length":function(c){b(c,0,"vector-length");return new ccc.Number(c.elements_.length)},"vector-ref":function(c,d){b(c,0,"vector-ref");a(d,1,"vector-ref");if(d<0||d>=c.elements_.length){throw new Error("vector-ref: Index out of bounds")}return c.elements_[d]},"vector-set!":function(c,e,d){b(c,0,"vector-ref");a(e,1,"vector-ref");if(e<0||e>=c.elements_.length){throw new Error("vector-ref: Index out of bounds")}c.elements_[e]=d},"vector->list":function(c){b(c,0,"vector->list");return ccc.Pair.makeList.apply(null,c.elements_)},"list->vector":function(d){if(d!==ccc.nil&&d.constructor!==ccc.Pair){throw new Error("list->vector: Argument 0 is not a list")}var c=[];d.forEach(function(e){c.push(e)},function(){throw new Error("list->vector: Argument 0 is not a proper list")});return new ccc.Vector(c)},"vector-fill!":function(c,d){b(c,0,"vector-fill!");for(var e=0;e<c.elements_.length;++e){c.elements_[e]=d}},})}());ccc.lib.base.addNativeFunction("call/cc",function(b,a,c){c=c.toArray();if(c.length!==1){throw new Error("call/cc: Exactly 1 argument expected.")}if(!(c[0].apply instanceof Function)){throw new Error("call/cc: Object "+c[0]+" is not applicable.")}return c[0].apply(b,a,ccc.Pair.makeList(new ccc.Continuation(a)))});ccc.lib.base.addNativeFunction("apply",function(b,a,d){d=d.toArray();if(d.length<2){throw new Error("apply: At least 2 arguments expected")}var g=d[0];if(!(g.apply instanceof Function)){throw new Error("apply: Object "+g+" is not applicable.")}var c=d[d.length-1];if(c!==ccc.nil&&(c.constructor!==ccc.Pair||!c.isList())){throw new Error("apply: Argument "+(d.length-1)+" is not a list")}var f=d.slice(1,d.length-1);for(var e=f.length-1;e>=0;--e){c=new ccc.Pair(f[e],c)}return g.apply(b,a,c)});ccc.lib.base.addNativeFunction("map",function(c,b,d){d=d.toArray();if(d.length<2){throw new Error("map: At least 2 arguments expected; received "+d.length)}var e=d[0];if(!(e.apply instanceof Function)){throw new Error("map: Object "+e+" is not applicable")}var a=d.slice(1);a.forEach(function(h,g){if(h!==ccc.nil&&h.constructor!==ccc.Pair){throw new Error("map: Argument "+(g+1)+" is not a list")}});var f=function(h,g){var j=[];for(var k=0;k<h.length;++k){if(h[k]===ccc.nil){return b(ccc.Pair.makeList.apply(null,g))}j.push(h[k].car_)}var l=function(i){return f(h.map(function(m){return m.cdr_}),g.concat(i))};return e.apply(c,l,ccc.Pair.makeList.apply(null,j))};return f(a,[])});ccc.lib.base.addNativeFunction("for-each",function(d,c,e){e=e.toArray();if(e.length<2){throw new Error("for-each: At least 2 arguments expected; received "+e.length)}var f=e[0];if(!(f.apply instanceof Function)){throw new Error("for-each: Object "+f+" is not applicable")}var b=e.slice(1);b.forEach(function(h,g){if(h!==ccc.nil&&h.constructor!==ccc.Pair){throw new Error("for-each: Argument "+(g+1)+" is not a list")}});var a=function(g){var h=[];for(var j=0;j<g.length;++j){if(g[j]===ccc.nil){return c(ccc.unspecified)}h.push(g[j].car_)}var k=function(i){return a(g.map(function(l){return l.cdr_}))};return f.apply(d,k,ccc.Pair.makeList.apply(null,h))};return a(b)});ccc.lib.base.addSimpleFunction("display",function(a){console.log(a.toSource())});ccc.lib.window=new ccc.Library("window");ccc.lib.window.addSimpleFunctions({"set-title":function(a){if(a.constructor!==ccc.String){throw new Error("set-title: Expected string; received "+a)}window.document.title=a.value_},});