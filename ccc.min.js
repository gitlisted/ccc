var Ccc=(function(){var d={};var f=function(g,j){var k=[],h;for(h=0;h<g.length;h+=1){k[h]=j(g[h])}return k};var e=function(g){return g.toString()};var c=function(h,g){if(typeof g==="undefined"){g=" "}return f(h,e).join(g)};d.ParseUtil=(function(){var g={};g.realFromTokens=function(m,h,l){var k=parseInt(m.join(""),l);var j=true;if(h.length>0){j=false;k*=Math.pow(l,h.length)}return new d.Real(k,j)};g.numberFromPolar=function(j,h){var l=j*Math.cos(h);var k=j*Math.sin(h);return new d.Numeric(l,1,false,k,1,false)};g.numberFromDecimal=function(j,o,m,s,q){var h=1;var k=0;var r=false;if(typeof s==="object"){h=s.precision;k=s.value;r=true}var l=j instanceof d.Numeric?j:new d.Numeric(j);return new d.Real(l.realNumer*Math.pow(10,k+o.length),l.exact&&!r&&!q)};g.makeRational=function(j,h){if(!j.realExact||!h.realExact){return new d.Real(j.realNumer/h.realNumer)}return new d.Rational(j.realNumer,h.realNumer)};g.arrayFromArrays=function(k,n){var h=[],m,l;for(m=0;m<k.length;m+=1){h.push(k[m][n])}return h};return g}());d.Object=(function(){var g=function(){};g.prototype.toString=function(){return"#<generic-object>"};g.prototype.isEq=function(h){return this===h};g.prototype.isEqv=function(h){return this.isEq(h)||false};g.prototype.isEqual=function(h){return this.isEqv(h)||false};g.prototype.toBoolean=function(){return d.True};g.prototype.isNil=function(){return this===d.Nil};g.prototype.compile=function(){return[a.PUSH(this)]};g.prototype.isApplicable=function(){return false};g.prototype.doApply=function(){throw new TypeError("Object "+this+" is not applicable.")};g.prototype.toDisplayString=function(){return this.toString()};g.prototype.getFreeReferences=function(){return[]};g.prototype.transform=function(h){return this};g.prototype.replaceSymbols=function(){return this};return g}());d.Symbol=(function(){var h={};var g=function(k,j){if(h.hasOwnProperty(k)){return h[k]}if(typeof j==="undefined"){j=k;h[k]=this}this.id=k;this.name=j;this.quoted=/[ \t\f\r\n\v\xa0\u2000-\u200b\u2028\u2029\u202f\u3000]/.test(j)};g.prototype=new d.Object();g.prototype.toString=function(){return this.quoted?"|"+this.name.replace(/\|/,"\\|")+"|":this.name};g.prototype.getFreeReferences=function(j){return j.tryGetLocation(this.id)?[this.id]:(j.tryGetSyntax(this.id)?[this.id]:[])};g.prototype.transform=function(j){return this};g.prototype.compile=function(){return[a.LOAD(this)]};g.prototype.replaceSymbols=function(j){if(j.hasOwnProperty(this.id)){return j[this.id]}return this};return g}());d.Boolean=(function(){var g=function(j,h){if(h===true){this.value=j}else{return j===false?d.False:d.True}};g.prototype=new d.Object();g.prototype.toString=function(){return this.value===false?"#f":"#t"};g.prototype.toBoolean=function(){return this};return g}());d.True=new d.Boolean(true,true);d.False=new d.Boolean(false,true);d.Character=(function(){var g=function(h){this.value=h};g.prototype=new d.Object();g.prototype.toString=function(){return"#\\"+this.value.replace(/\n/,"newline").replace(/ /,"space")};g.prototype.isEq=function(h){return h instanceof d.Character&&this.value===h.value};g.prototype.toDisplayString=function(){return this.value};return g}());d.String=(function(){var g=function(h){this.value=h};g.prototype=new d.Object();g.prototype.toString=function(){return'"'+this.value.replace('"','\\"')+'"'};g.prototype.isEqv=function(h){return h instanceof d.String&&this.value===h.value};g.prototype.toDisplayString=function(){return this.value};return g}());d.Nil=new d.Object();d.Nil.toString=function(){return"()"};d.Nil.toArray=function(){return[]};d.Unspecified=new d.Object();d.Unspecified.toString=function(){return"#!unspecific"};d.Pair=(function(){var h=function(j,k){this.car=j;this.cdr=k};h.prototype=new d.Object();h.prototype.toString=function(j){var k="";if(j!==true){k="("}k+=this.car.toString();if(this.cdr===d.Nil){k+=")"}else{if(this.cdr instanceof d.Pair){k+=" "+this.cdr.toString(true)}else{k+=" . "+this.cdr.toString()+")"}}return k};h.prototype.isList=function(){var k=this,j=this;while(k instanceof d.Pair){k=k.cdr;if(!(k instanceof d.Pair)){break}k=k.cdr;j=j.cdr;if(k===j){return false}}return k.isNil()};h.prototype.splice=function(j){if(this.cdr.isNil()){return new d.Pair(this.car,j)}return new d.Pair(this.car,this.cdr.splice(j))};h.prototype.reverse=function(){var k=this,j=d.Nil;while(k instanceof d.Pair){j=new d.Pair(k.car,j);k=k.cdr}return j};h.prototype.isEqual=function(j){return j instanceof d.Pair&&this.car.isEqual(j.car)&&this.cdr.isEqual(j.cdr)};h.prototype.getTail=function(){var j=this;while(j instanceof d.Pair){j=j.cdr}return j};h.fromArray=function(j,k){var l;if(typeof k==="undefined"){k=d.Nil}for(l=j.length-1;l>=0;l-=1){k=new d.Pair(j[l],k)}return k};h.prototype.toArray=function(){var j=[],k=this;while(k instanceof d.Pair){j.push(k.car);k=k.cdr}return j};h.prototype.getFreeReferences=function(j){var l=this,k=[];while(l instanceof d.Pair){k=k.concat(l.car.getFreeReferences(j));l=l.cdr}if(l!==d.Nil){k=k.concat(l.getFreeReferences(j))}return k};h.prototype.transform=function(l){var m,n,p,k=[],j;if(this.car instanceof d.Symbol){m=l.tryGetSyntax(this.car.id);if((m instanceof d.TransformerSpec)&&!l.tryGet(this.car.id)){n=m.expand(this,l);return n.transform(l)}}p=this;while(p instanceof d.Pair){k.push(p.car.transform(l));p=p.cdr}if(p!==d.Nil){p=p.transform(l)}return h.fromArray(k,p)};h.prototype.compile=function(j){var l=0,m=[],k,n;k=this.car;n=this.cdr;while(n instanceof d.Pair){m=m.concat(n.car.compile());l+=1;n=n.cdr}if(n!==d.Nil){throw new Error("Function application arguments must be a proper list")}m=m.concat(k.compile());if(j===true){m.push(a.LEAVE());m.push(a.APPLYT(l))}else{m.push(a.APPLY(l))}return m};var g=function(j,l){var m,k;if(j instanceof d.Symbol&&l.hasOwnProperty(j.id)){return l[j.id]}if(j instanceof d.Pair){m=j;while(m instanceof d.Pair){m.car=g(m.car,l);if(m.cdr!==d.Pair&&m.cdr!==d.Nil){m.cdr=g(m.cdr,l)}m=m.cdr}}if(j instanceof d.Vector){for(k=0;k<j.elements.length;k+=1){j.elements[k]=g(j.elements[k],l)}}if(j instanceof d.Ellipsis){j.datum=g(j.datum,l)}return j};h.prototype.replaceSymbols=function(j){return g(this,j)};return h}());d.Vector=(function(){var g=function(h){this.elements=h};g.prototype=new d.Object();g.prototype.toString=function(){return"#("+c(this.elements)+")"};g.prototype.isEqual=function(k){var h,j=k instanceof d.Vector&&this.elements.length===k.elements.length;for(h=0;j&&h<this.elements.length&&h<k.elements.length;h+=1){j&=this.elements[h].isEqual(k.elements[h])}return j};g.prototype.getFreeReferences=function(h){var k,j=[];for(k=0;k<this.elements.length;k+=1){j=j.concat(this.elements[k].getFreeReferences(h))}return j};return g}());d.Program=(function(){var g=function(h){this.data=h};g.prototype=new d.Object();g.prototype.toString=function(){return f(this.data,e).join("\n")};g.prototype.transform=function(h){var j,k=[];for(j=0;j<this.data.length;j+=1){k[j]=this.data[j].transform(h)}return new d.Program(k)};g.prototype.compile=function(){var j,h=[];for(j=0;j<this.data.length;j+=1){h.push(this.data[j].compile())}return h};return g}());d.Numeric=(function(){var k=function(m){return parseFloat(m)===parseInt(m,10)&&!isNaN(m)};var l=function(p,o){var n,m,q;p=Math.abs(p);o=Math.abs(o);if(p<o){n=o;m=p}else{n=p;m=o}if(m===0){return n}do{q=m;m=n%m;n=q}while(m!==0);return q};var h=function(p){var o,m=1;for(o=1;!k(p*m);o+=1){m=Math.pow(10,o)}return m};var g=function(r,q,s,o,m,p){var n,t;if(typeof r==="undefined"){r=0}if(typeof q==="undefined"){q=1}if(typeof s==="undefined"){s=k(r)}if(typeof o==="undefined"){o=0}if(typeof m==="undefined"){m=1}if(typeof p==="undefined"){p=k(o)}if(s&&!k(r)){t=h(r);r*=t;q*=t}if(p&&!k(o)){t=h(o);o*=t;m*=t}if(r>0&&q>1){n=l(r,q);r/=n;q/=n}if(o>0&&m>1){n=l(o,m);o/=n;m/=n}Object.defineProperties(this,{exact:{get:function(){return s&&p}},realNumer:{get:function(){return r}},realDenom:{get:function(){return q}},realExact:{get:function(){return s}},imagNumer:{get:function(){return o}},imagDenom:{get:function(){return m}},imagExact:{get:function(){return p}}});if(q===0||m===0){throw new Error("Division by 0")}this._repr=this.toString()};g.prototype=new d.Object();var j=function(n,m,o,r){var p;if(o){if(m===1){return n.toString(r)}return n.toString(r)+"/"+m.toString(r)}p=n/m;if(k(p)){return p+".0"}return p.toString(r)};g.prototype.toString=function(n){if(n==="undefined"){n=10}var m=j(this.realNumer,this.realDenom,this.realExact,n);if(this.imagNumer>0){m+="+"}if(this.imagNumer!==0){m+=j(this.imagNumer,this.imagDenom,this.imagExact,n)+"i"}return m};g.prototype.toExact=function(){return new g(this.realNumer,this.realDenom,true,this.imagNumer,this.imagDenom,true)};g.prototype.toInexact=function(){return new g(this.realNumer,this.realDenom,false,this.imagNumer,this.imagDenom,false)};g.prototype.isExact=function(){return this.realExact&&this.imagExact};g.prototype.negative=function(){return new g(-this.realNumer,this.realDenom,this.realExact,-this.imagNumer,this.imagDenom,this.imagExact)};g.prototype.add=function(m){var n=this.realDenom*m.realDenom;var o=this.imagDenom*m.imagDenom;return new g((this.realNumer/this.realDenom+m.realNumer/m.realDenom)*n,n,this.realExact&&m.realExact,(this.imagNumer/this.imagDenom+m.imagNumer/m.imagDenom)*o,o,this.imagExact&&m.imagExact)};g.prototype.mul=function(m){var A=this.realNumer,z=this.realDenom,y=this.imagNumer,x=this.imagDenom;var w=m.realNumer,v=m.realDenom,u=m.imagNumer,s=m.imagDenom;var p=A*w*x*s-y*u*z*v;var n=z*v*x*s;var r=y*w*z*s+A*u*x*v;var q=x*v*z*s;var t=this.exact&&m.exact;return new g(p,n,t,r,q,t)};g.prototype.conjugate=function(m){return new g(this.realNumer,this.realDenom,this.realExact,-this.imagNumer,this.imagDenom,this.imagExact)};g.prototype.inverse=function(m){if(this.imagNumer===0){return new g(this.realDenom,this.realNumer,this.realExact)}var o=this.conjugate();var n=this.mul(o);return new g(o.realNumer*n.realDenom,o.realDenom*n.realNumer,this.realExact,o.imagNumer*n.realDenom,o.imagDenom*n.realNumer,this.imagExact)};g.prototype.isEq=function(m){return this.realNumer===m.realNumer&&this.realDenom===m.realDenom&&this.realExact===m.realExact&&this.imagNumer===m.imagNumer&&this.imagDenom===m.imagDenom&&this.imagExact===m.imagExact};g.prototype.cmp=function(n){var m;if(this.imagNumer!==0||n.imagNumer!==0){throw new TypeError("Connot compare non-real numbers")}m=this.realNumer*n.realDenom-this.realDenom*n.realNumer;return m<0?-1:(m===0?0:1)};g.prototype.gcd=function(m){return new g(l(this.realNumer,m.realNumer),1,this.realExact&&m.realExact)};g.prototype.lcm=function(m){return new g(Math.abs(this.realNumer*m.realNumer/l(this.realNumer,m.realNumer)),1,this.realExact&&m.realExact)};g.prototype.isInteger=function(m){return this.imagNumer===0&&this.realDenom===1&&parseFloat(this.realNumer)===parseInt(this.realNumer,10)};return g}());d.Real=(function(){var g=function(j,h){if(typeof j==="undefined"){return new d.Numeric(0)}if(typeof h==="undefined"){return new d.Numeric(j)}return new d.Numeric(j,1,h)};return g}());d.Rational=(function(){var g=function(j,h){if(typeof j==="undefined"){return new d.Numeric(0)}if(typeof h==="undefined"){return new d.Numeric(j,1,true)}if(h===0){throw new Error("Divide by zero")}return new d.Numeric(j,h,true)};return g}());d.Complex=(function(){var g=function(j,h){if(typeof j==="undefined"){return new d.Numeric(0)}if(typeof j==="number"){j=new d.Numeric(j)}if(typeof h==="undefined"){return j}if(typeof h==="number"){h=new d.Numeric(j.realNumer,j.realDenom,j.realExact,h)}return new d.Numeric(j.realNumer,j.realDenom,j.realExact,h.realNumer,h.realDenom,h.realExact)};return g}());d.Define=(function(){var g=function(h,j){this.symbol=h;this.expression=j;if(!(h instanceof d.Symbol)){throw new Error("Cannot define datum "+h)}};g.prototype=new d.Object();g.prototype.toString=function(){return"#<define "+this.symbol+" = "+this.expression+">"};g.prototype.compile=function(){return this.expression.compile().concat([a.RES(this.symbol),a.SET(this.symbol),a.PUSH(this.symbol)])};return g}());d.Lambda=(function(){var g=function(j,k,h){this.args=j;this.rest=k;this.body=h;this.formals=d.Pair.fromArray(j,k);this.compiled=null};g.prototype=new d.Object();g.prototype.toString=function(){return"(lambda "+this.formals+" "+this.body+")"};g.prototype.compile=function(){var j=[],k,h;j.push(a.ENTER());if(this.compiled===null){for(h=0;h<this.args.length;h+=1){j.push(a.RES(this.args[h]));j.push(a.SET(this.args[h]))}if(this.rest!==d.Nil){j.push(a.RES(this.rest));j.push(a.SET(this.rest))}k=this.body;while(k.cdr instanceof d.Pair){j=j.concat(k.car.compile());j.push(a.POP());k=k.cdr}j=j.concat(k.car.compile(true));j.push(a.LEAVE());j.push(a.RET());this.compiled=new d.CompiledProcedure(j,this.args.length,this.rest)}return[a.PUSH(this.compiled),a.CAP()]};return g}());d.CompiledProcedure=(function(){var g=function(k,h,j){this.ops=k;this.numArgs=h;this.rest=j;this.environment=null};g.prototype=new d.Object();g.prototype.toString=function(){return"<#proc:<"+this.ops.toString()+">"};g.prototype.doApply=function(h,k){var l,j=h.stack.slice();if(k.length<this.numArgs){throw new Error("Object "+this+" requires "+(this.rest!==d.Nil?"at least ":"exactly ")+this.numArgs+" arguments, but was called with "+k.length)}if(k.length>this.numArgs&&this.rest===d.Nil){throw new Error("Object "+this+" requires exactly "+this.numArgs+" arguments, but was called with "+k.length)}if(this.rest!==d.Nil){j.push(d.Pair.fromArray(k.slice(this.numArgs)));k=k.slice(0,this.numArgs)}for(l=k.length-1;l>=0;l-=1){j.push(k[l])}return new d.Continuation(this.environment,this.ops,0,j,h)};g.prototype.isApplicable=function(){return true};g.prototype.bind=function(h){var j=new g(this.ops,this.numArgs,this.rest);j.environment=h;return j};g.prototype.isEqv=function(h){return h instanceof d.CompiledProcedure&&h.ops===this.ops&&h.environment===this.environment};return g}());d.If=(function(){var g=function(k,h,j){this.test=k;this.consequent=h;this.alternate=j};g.prototype=new d.Object();g.prototype.toString=function(){return"#<if "+this.test+" then "+this.consequent+" else "+this.alternate+">"};g.prototype.compile=function(h){var j=[];var m=this.test.compile();var k=this.consequent.compile(h);var l=this.alternate.compile(h);j=j.concat(m);j.push(a.JMPF(k.length+1));j=j.concat(k);j.push(a.JMP(l.length));j=j.concat(l);return j};return g}());d.Assignment=(function(){var g=function(h,j){this.symbol=h;this.expression=j};g.prototype=new d.Object();g.prototype.toString=function(){return"#<assign: "+this.symbol+" = "+this.expression+">"};g.prototype.compile=function(){var h=[a.LOAD(this.symbol)];h=h.concat(this.expression.compile());h.push(a.SET(this.symbol));return h};return g}());d.Quote=(function(){var g=function(h){this.datum=h};g.prototype=new d.Object();g.prototype.toString=function(){return"#<quote "+this.datum+">"};g.prototype.compile=function(){return[a.PUSH(this.datum)]};return g}());d.Environment=(function(){var h={};var g=function(n){var m,l={},p={},o=0,j=this;this.syntax=l;this.bindings=p;if(typeof n==="undefined"){n=null}this.parent=n;this.define=function(q,k){p[q]={value:k}};this.defineSyntax=function(q,k){l[q]=k};this.reserve=function(k){p[k]={value:d.Unspecified}};this.set=function(s,r){var k=this.tryGetLocation(s),q;if(typeof k==="undefined"){throw new Error("Unbound variable: "+s)}q=k.value;k.value=r;return q};this.get=function(q){var k=this.tryGet(q);if(k===null){throw new Error("Unbound variable: "+q)}return k};this.tryGetLocation=function(q){var k=p[q];return k||(n&&n.tryGetLocation(q))||h[q]};this.tryGet=function(q){var k=p[q];return(k&&k.value)||(n&&n.tryGet(q))||(h[q]&&h[q].value)||null};this.getSyntax=function(q){var k=this.tryGetSyntax(q);if(k===null){throw new Error("Undefined keyword: "+q)}return k};this.tryGetSyntax=function(q){var k=l[q];return k||(n&&n.tryGetSyntax(q))||null};this.clone=function(){return new d.Environment(this)};this.getParent=function(){return n};this.gensym=function(){while(j.tryGetLocation("\x7f#"+o)||j.tryGetSyntax("\x7f#"+o)){o+=1}return"\x7f#"+o};this.builtins=h};g.prototype=new d.Object();g.prototype.toString=function(){return"#<environment>"};g.prototype.defineBuiltin=function(p,n,m,o){var j,l=[],k;if(typeof n==="function"){o=m;m=n;n=null}if(typeof o==="undefined"){o=false}if(p instanceof Array){l=p.slice(1);p=p[0]}k=new d.BuiltinProcedure(p,m,n,o);this.define(p,k);for(j=0;j<l.length;j+=1){this.define(l[j],k)}};g.prototype.defineLibrary=function(k){var l,p,n,m,j={};for(l in k){if(k.hasOwnProperty(l)){p=k[l];if(p instanceof Function){m=p;n=m.length-1}else{if(p instanceof Object){m=p.fn;if(p.hasOwnProperty("arity")){n=p.arity}else{if(p.hasOwnProperty("minArity")){if(p.minArity===0){n=null}else{n=-p.minArity}}else{n=m.length-1}}}else{if(p instanceof String){j[p]=l}else{throw new TypeError("Unexpected library entry: "+p)}}}if(!(p instanceof String)){if(!(m instanceof Function)){throw new Error("Library entry must be an alias or provide an implementation function")}this.defineBuiltin(l,n,m)}}}for(l in j){if(j.hasOwnProperty(l)){if(!this.tryGet(j[l])){throw new Error("Unable to alias non-existent builtin '"+j[l]+"'")}this.define(l,this.get(j[l]))}}};return g}());d.BuiltinProcedure=(function(){var g=function(l,h,j,k){this.id=l;this.arity=j;this.fn=h;this.returnContinuation=k};g.prototype=new d.Object();g.prototype.toString=function(){return"#<builtin-procedure:"+this.id+">"};g.prototype.doApply=function(j,k){var h;if(this.arity!=null&&this.arity>=0&&k.length!==this.arity){throw new Error("Builtin procedure "+this.id+" requires exactly "+this.arity+" arguments, but was called with "+k.length+".")}else{if(this.arity<0&&k.length<-this.arity){throw new Error("Builtin procedure "+this.id+" requires at least "+(-this.arity)+" arguments, but was called with "+k.length+".")}}h=this.fn.apply(null,[j].concat(k));if(this.returnContinuation){return h}if(typeof h==="undefined"){h=d.Unspecified}j.stack.push(h);return j};g.prototype.isApplicable=function(){return true};return g}());d.TransformerSpec=(function(){var g=function(h,j){this.literals={};this.rules=j;for(i=0;i<h.length;i+=1){if(this.literals.hasOwnProperty(h[i].id)){throw new Error("Duplicate literal in transformer spec")}this.literals[h[i].id]={}}};g.prototype=new d.Object();g.prototype.expand=function(m,j){var n,l,h;for(n=0;n<this.rules.length;n+=1){h=this.rules[n].tryExpand(this.literals,m,j);if(h!==null){return h}}throw new Error("Ill-formed special form: "+m)};g.prototype.getFreeReferences=function(h){var k,j=[];for(k=0;k<this.rules.length;k+=1){j=j.concat(this.rules[k].getFreeReferences(this.literals,h))}return j};g.prototype.replaceSymbols=function(j){var h;for(h=0;h<this.rules.length;h+=1){this.rules[h].replaceSymbols(j)}};return g}());d.SyntaxRule=(function(){var g=function(j,h){this.pattern=j;this.template=h};g.prototype=new d.Object();g.prototype.tryExpand=function(m,k,h){var j,l;j=this.pattern.match(m,k.cdr,h);if(j!==false){if(this.template instanceof Function){l=this.template(j,h)}else{l=this.template.expand(j,h)}if(l===null){throw new Error("Template expansion failed")}return l}return null};g.prototype.toString=function(){return"#<syntax-rule: "+this.pattern+" => "+this.template+">"};g.prototype.getFreeReferences=function(j,h){return this.template.getFreeReferences(this.pattern.getCaptureSymbols(j),h)};g.prototype.replaceSymbols=function(h){this.template.replaceSymbols(h)};return g}());d.ListCapture=(function(){var g=function(h){this.datum=h};g.prototype.toString=function(){return"<list-capture:"+this.datum+">"};g.prototype.generateExpansion=function(){var h;if(this.datum instanceof d.Pair){h=this.datum.car;this.datum=this.datum.cdr;if(this.datum===d.Nil){this.datum=false}return h}if(this.datum===d.Nil){return false}return this.datum};g.prototype.getFreeReferences=function(h){return this.datum.getFreeReferences(h)};g.prototype.replaceSymbols=function(h){this.datum=this.datum.replaceSymbols(h);return this};return g}());d.Pattern=(function(){var l=function(o){this.datum=o};l.prototype=new d.Object();var g=function(q,p){var o;for(o in q){if(q.hasOwnProperty(o)){p[o]=q[o]}}};var j=function(q,r){var p={};while(r instanceof d.Pair){g(j(q,r.car),p);r=r.cdr}if(r instanceof d.Ellipsis){g(j(q,r.datum),p)}if(r instanceof d.Symbol&&!q.hasOwnProperty(r.id)){p[r.id]=new d.ListCapture(d.Nil)}return p};l.prototype.getCaptureSymbols=function(o){return j(o,this.datum)};var n=function(o,q,v,t){var r={},x,w,s,u;if(o instanceof d.Pair){do{if(o.car instanceof d.Ellipsis){if(o.cdr!==d.Nil){throw new Error("Improper ... placement in syntax pattern")}if((x=n(o.car,q,v,t))===false){return false}g(x,r);return r}if(!(v instanceof d.Pair)){return false}if((x=n(o.car,q,v.car,t))===false){return false}g(x,r);o=o.cdr;v=v.cdr}while(o instanceof d.Pair);if(o!==d.Nil){if((x=n(o,q,v,t))===false){return false}g(x,r)}else{if(v!==d.Nil){return false}}return r}if(o instanceof d.Vector){if(!(v instanceof d.Vector)){return false}for(u=0;u<o.elements.length;u+=1){if(o.elements[u] instanceof d.Ellipsis){if(u<o.elements.length-1){throw new Error("Improper ... placement in syntax pattern")}if((x=n(d.Pair.fromArray(o.elements.slice(u)),q,d.Pair.fromArray(v.elements.slice(u)),t))===false){return false}g(x,r);return r}if(u>=v.elements.length){return false}if((x=n(o.elements[u],q,v.elements[u],t))===false){return false}}if(u<v.elements.length){return false}g(x,r);return r}if(o instanceof d.Ellipsis){if(v===d.Nil){return j(q,o.datum)}s=0;while(v instanceof d.Pair){if((x=n(o.datum,q,v.car,t))===false){return false}for(w in x){if(x.hasOwnProperty(w)){if(!r.hasOwnProperty(w)){r[w]=new d.Pair(x[w],d.Nil)}else{r[w]=new d.Pair(x[w],r[w])}}}v=v.cdr}if(v!==d.Nil){return false}for(w in r){if(r.hasOwnProperty(w)){r[w]=new d.ListCapture(r[w].reverse(),true)}}return r}if(o instanceof d.Symbol){if(q.hasOwnProperty(o.id)){return(v instanceof d.Symbol)&&o.id===v.id&&!t.tryGetLocation(o.id)&&r}r[o.id]=v;return r}return o.isEqual(v)&&r};l.prototype.match=function(q,p,o){return n(this.datum,q,p,o)};l.prototype.toString=function(){return"<"+this.datum+">"};var m=function(r){var p=[],q=null;while(r instanceof d.Pair){if(r.car instanceof d.Symbol&&r.car.id==="..."){if(q===null||r.cdr!==d.Nil){throw new Error("Improper placement of ... in syntax pattern")}p.pop();q=new d.Ellipsis(q)}else{q=h(r.car)}p.push(q);r=r.cdr}return d.Pair.fromArray(p,r)};var k=function(s){var r,p=[],q;for(r=0;r<s.elements.length;r+=1){q=s.elements[r];if(q instanceof d.Symbol&&q.id==="..."){if(prev===null||r<s.elements.length-1){throw new Error("Improper placement of ... in syntax pattern")}p.pop();prev=new d.Ellipsis(prev)}else{prev=h(q)}p.push(prev)}return new d.Vector(p)};var h=function(p){if(p instanceof d.Pair){return m(p)}if(p instanceof d.Vector){return k(p)}return p};l.fromObject=function(p){return new d.Pattern(h(p))};return l}());d.Template=(function(){var j=function(q){this.datum=q};j.prototype=new d.Object();var h=function(t,r){var q=[],s;if(t instanceof d.Pair){do{q.push(h(t.car,r));t=t.cdr}while(t instanceof d.Pair);t=h(t,r);return d.Pair.fromArray(q,t)}if(t instanceof d.Vector){for(s=0;s<t.elements.length;s+=1){q.push(h(t.elements[s],r))}return new d.Vector(q)}if(t instanceof d.Symbol&&r.hasOwnProperty(t.id)){if(r[t.id] instanceof d.ListCapture){return new d.ListCapture(r[t.id].datum)}return r[t.id]}if(t instanceof d.Ellipsis){return new d.Ellipsis(h(t.datum,r))}return t};var o=function(u,s){var q=[],t,r;if(u instanceof d.Pair){while(u instanceof d.Pair){t=o(u.car,s);if(t===false){return false}if(t!==null){q.push(t)}u=u.cdr}if(u!==d.Nil){u=o(u,s);if(u===false){return false}}return d.Pair.fromArray(q,u)}if(u instanceof d.Vector){for(r=0;r<u.elements.length;r+=1){t=o(u.elements[r],s);if(t===false){return false}if(t!==null){q.push(t)}}return new d.Vector(q)}if(u instanceof d.ListCapture){s.push(u);return u.generateExpansion()}if(u instanceof d.Ellipsis){return new d.Ellipsis(o(u.datum,s))}return u};var p=function(r){var t,s=[],q=[];t=o(r,s);if(t===false){return null}while(t!==false&&s.length>0){if(t!==null){q.push(t)}t=o(r,s)}if(s.length===0&&t!==false){throw new Error("Too many ellipses in syntax template")}return d.Pair.fromArray(q)};var k=function(s,r){var v,x,q=[],t=d.Nil,w=[],u;if(s instanceof d.Pair){while(s instanceof d.Pair){v=k(s.car,r);if(s.car instanceof d.Ellipsis){x=v;while(x instanceof d.Pair){q.push(x.car);x=x.cdr}}else{if(v!==null){q.push(v)}}s=s.cdr}if(s!==d.Nil){t=k(s,r)}v=d.Pair.fromArray(q,t)}else{if(s instanceof d.Vector){for(u=0;u<s.elements.length;u+=1){x=s.elements[u];v=k(x,r);if(x instanceof d.Ellipsis){x=v;while(x instanceof d.Pair){q.push(x.car);x=x.cdr}}else{if(v!==null){q.push(v)}}}v=new d.Vector(q)}else{if(s instanceof d.Ellipsis){s=p(s.datum);if(s===null){return null}while(s instanceof d.Pair){q.push(k(s.car,r));s=s.cdr}v=d.Pair.fromArray(q)}else{if(s instanceof d.ListCapture){v=s.datum}else{v=s}}}}return v};j.prototype.expand=function(r){var q,s;q=h(this.datum,r);s=k(q,r);return s};j.prototype.toString=function(){return"!<"+this.datum+">"};var m=function(s){var q=[],r=null;while(s instanceof d.Pair){if(s.car instanceof d.Symbol&&s.car.id==="..."){if(r===null){throw new Error("Improper placement of ... in syntax template")}q.pop();r=new d.Ellipsis(r)}else{r=l(s.car)}q.push(r);s=s.cdr}return d.Pair.fromArray(q,s)};var n=function(t){var s,q=[],r;for(s=0;s<t.elements.length;s+=1){r=t.elements[s];if(r instanceof d.Symbol&&r.id==="..."){if(prev===null){throw new Error("Improper placement of ... in syntax template")}q.pop();prev=new d.Ellipsis(prev)}else{prev=l(r)}q.push(prev)}return new d.Vector(q)};var l=function(q){if(q instanceof d.Pair){return m(q)}if(q instanceof d.Vector){return n(q)}return q};j.prototype.getFreeReferences=function(t,r){var s=this.datum.getFreeReferences(r),q=[],u;for(u=0;u<s.length;u+=1){if(!t.hasOwnProperty(s[u])){q.push(s[u])}}return q};var g=function(q,s){var t,r;if(q instanceof d.Symbol&&s.hasOwnProperty(q.id)){return s[q.id]}if(q instanceof d.Pair){t=q;while(t instanceof d.Pair){t.car=g(t.car,s);if(t.cdr!==d.Pair&&t.cdr!==d.Nil){t.cdr=g(t.cdr,s)}t=t.cdr}}if(q instanceof d.Vector){for(r=0;r<q.elements.length;r+=1){q.elements[r]=g(q.elements[r],s)}}if(q instanceof d.Ellipsis){q.datum=g(q.datum,s)}return q};j.prototype.replaceSymbols=function(q){this.datum=g(this.datum,q)};j.fromObject=function(q){return new d.Template(l(q))};return j}());d.Ellipsis=(function(){var g=function(h){this.datum=h};g.prototype=new d.Object();g.prototype.toString=function(){return this.datum+"..."};return g}());d.Continuation=(function(){var g=function(m,n,j,h,l,k){this.env=m;this.block=n;this.index=j;this.stack=h;this.outer=l;this.guards=k||(l&&l.guards.slice())||[]};g.prototype=new d.Object();g.prototype.toString=function(){return"#<continuation>"};g.prototype.doApply=function(h,k){var l,j;if(k.length!==1){throw new Error(this+" requires exactly "+this.numArgs+" arguments, but was called with "+k.length)}j=this.stack.concat(k[0]);return new d.Continuation(this.env,this.block,this.index,j,this.outer,this.guards.slice())};g.prototype.isApplicable=function(){return true};g.prototype.addGuard=function(h){this.guards.push(h)};return g}());d.Guard=(function(){var g=function(h,j){this.before=h;this.after=j};g.prototype=new d.Object();return g}());d.CompiledClosure=(function(){var g=function(h){this.values=h};g.prototype=new d.Object();g.prototype.toString=function(){return"#<compiled-closure:"+this.values+">"};g.prototype.doApply=function(h){return h.doApply(h,this.values)};g.prototype.isApplicable=function(){return true};return g}());d.Compiler=(function(){var g=function(h){this.options=h||{}};g.prototype.compile=function(l){var h,n,m,j,k=d.NullEnvironment.clone();n=new Date();h=d.Parser.parse(l);j=h.transform(k);m=j.compile();if(this.options.timer){console.log("Compilation completed in "+(new Date()-n)+" ms")}return m};return g}());d.OpCodes={};var a=d.OpCodes;var b=function(g){d.OpCodes[g]=function(h){return{op:g,arg:h,toString:function(){return"<"+g+((typeof h==="undefined")?"":":"+h)+">"}}}};b("PUSH");b("POP");b("DUP");b("JMP");b("JMPF");b("RET");b("CAP");b("RES");b("SET");b("LOAD");b("APPLY");b("APPLYT");b("APPLYV");b("ENTER");b("LEAVE");b("EVAL");d.Vm=(function(){var g=function(h){var k,j=d.NullEnvironment.clone(),l,n;h=h||{};k={PUSH:function(o,p){o.stack.push(p);o.index+=1;return o},POP:function(o){o.stack.pop();o.index+=1;return o},DUP:function(o){var p=o.stack[o.stack.length-1];o.stack.push(p);o.index+=1;return o},JMP:function(o,p){o.index+=p+1;return o},JMPF:function(o,q){var p=o.stack.pop();if(p===d.False){o.index+=q}o.index+=1;return o},RET:function(o){var p;if(!(o.outer instanceof d.Continuation)){throw new Error("Invalid RET operation")}p=o.outer;return new d.Continuation(p.env,p.block,p.index,o.stack.slice(),p.outer,p.guards)},CAP:function(o){var p=o.stack.pop();p=p.bind(o.env);o.stack.push(p);o.index+=1;return o},RES:function(o,p){o.env.reserve(p.id);o.index+=1;return o},SET:function(o,p){var q=o.stack.pop();o.env.set(p.id,q);o.index+=1;return o},LOAD:function(o,p){o.stack.push(o.env.get(p.id));o.index+=1;return o},APPLY:function(p,t){var q=[],r,s,o;s=p.stack.pop();if(!s.isApplicable()){throw new Error("Object "+s+" is not applicable")}for(r=0;r<t;r+=1){q.unshift(p.stack.pop())}p.index+=1;return s.doApply.call(s,p,q)},APPLYT:function(p,v){var q=[],s,t,o,r,u;t=p.stack.pop();if(!t.isApplicable()){throw new Error("Object "+t+" is not applicable")}for(s=0;s<v;s+=1){q.unshift(p.stack.pop())}u=t.doApply.call(t,p.outer,q);u.guards=u.guards.concat(p.guards);return u},APPLYV:function(o){var p=o.stack.pop(),q=o.stack.pop();if(!p.isApplicable()){throw new Error("Object "+p+" is not applicable")}o.index+=1;return p.doApply.call(p,o,(q instanceof d.CompiledClosure)?q.values:q)},ENTER:function(o){o.env=o.env.clone();o.index+=1;return o},LEAVE:function(o){var p=o.env.getParent();if(p===null){throw new Error("Invalid LEAVE operation")}o.env=p;o.index+=1;return o},EVAL:function(p,o){var q=p.stack.pop(),r;r=q.transform(o).compile();r.push(a.RET());p.index+=1;return new d.Continuation(o,r,0,p.stack,p)},};var m=function(t,p){var r=[],s=[],o=[],q;for(q=p.guards.length-1;q>=0;q-=1){if(t.guards.indexOf(p.guards[q])<0){o.push(p.guards[q])}}for(q=0;q<t.guards.length;q+=1){if(p.guards.indexOf(t.guards[q])<0){s.push(t.guards[q])}}for(q=0;q<o.length;q+=1){r=r.concat(a.PUSH(o[q].after),a.APPLY(0),a.POP())}for(q=0;q<s.length;q+=1){r=r.concat(a.PUSH(s[q].before),a.APPLY(0),a.POP())}if(r.length===0){return t}r.push(a.RET());return new d.Continuation(t.env,r,0,t.stack,t)};var n=function(q){var s,w,o,t,p,v,u,r;w=new d.Continuation(j,q,0,[],null);while(w.index<w.block.length){instruction=w.block[w.index];if(!k.hasOwnProperty(instruction.op)){throw new Error("Invalid instruction: "+instruction)}w=m(k[instruction.op](w,instruction.arg),w)}return w.stack};this.execute=function(p){var q,o,r;if(h.debug){console.log(";-------------------------------------------");for(q=0;q<p.length;q+=1){console.log(p[q].toString())}}if(h.logging){console.log(";===========================================")}r=new Date();for(q=0;q<p.length;q+=1){o=n(p[q]);if(h.logging){if(o.length===0){console.log(d.Unspecified)}else{console.log(o[o.length-1].toString())}}}if(h.timer){console.log("Execution completed in "+(new Date()-r)+" ms.")}return o}};return g}());d.NullEnvironment=new d.Environment();return d}());Ccc.Parser=(function(){function b(c){return'"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var a={parse:function(aH,aJ){var R={start:ae,space:g,nothing:au,WS:p,DL:x,comment:A,symbol:aj,initial:j,letter:X,special_initial:an,subsequent:al,digit:K,special_subsequent:f,peculiar_identifier:J,"boolean":w,character:av,string:am,escape_sequence:aI,string_element:o,quoted_symbol:az,symbol_element:t,null_value:B,unspecific:l,number:y,suffix:h,exponent_marker:ap,sign:ad,exactness:at,num_2:af,complex_2:aq,real_2:aa,ureal_2:F,uinteger_2:E,prefix_2:Z,radix_2:u,digit_2:S,num_8:ac,complex_8:ao,real_8:W,ureal_8:D,uinteger_8:C,prefix_8:U,radix_8:r,digit_8:P,num_10:q,complex_10:aF,real_10:ak,ureal_10:v,decimal_10:c,uinteger_10:aC,prefix_10:N,radix_10:V,num_16:m,complex_16:ay,real_16:ai,ureal_16:s,uinteger_16:ax,prefix_16:M,radix_16:Q,digit_16:aE,datum:aB,simple_datum:aA,compound_datum:e,list:L,abbreviation:T,vector:k,program:ag};if(aJ!==undefined){if(R[aJ]===undefined){throw new Error("Invalid rule name: "+b(aJ)+".")}}else{aJ="start"}var ar={offset:0,line:1,column:1,seenCR:false};var ah=0;var Y={offset:0,line:1,column:1,seenCR:false};var G=[];function aG(aL,aP,aN){var aK=aL;var aO=aN-aL.length;for(var aM=0;aM<aO;aM++){aK=aP+aK}return aK}function aw(aM){var aL=aM.charCodeAt(0);var aK;var aN;if(aL<=255){aK="x";aN=2}else{aK="u";aN=4}return"\\"+aK+aG(aL.toString(16).toUpperCase(),"0",aN)}function z(aL){var aK={};for(var aM in aL){aK[aM]=aL[aM]}return aK}function O(aO,aN){var aK=aO.offset+aN;for(var aM=aO.offset;aM<aK;aM++){var aL=aH.charAt(aM);if(aL==="\n"){if(!aO.seenCR){aO.line++}aO.column=1;aO.seenCR=false}else{if(aL==="\r"||aL==="\u2028"||aL==="\u2029"){aO.line++;aO.column=1;aO.seenCR=true}else{aO.column++;aO.seenCR=false}}}aO.offset+=aN}function I(aK){if(ar.offset<Y.offset){return}if(ar.offset>Y.offset){Y=z(ar);G=[]}G.push(aK)}function ae(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=p();if(aN!==null){aL=ag();if(aL!==null){aK=p();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR){return aR})(aO.offset,aO.line,aO.column,aN[1])}if(aN===null){ar=z(aO)}return aN}function g(){var aK;if(/^[ \t\f\r\n\x0B\xA0\u2000-\u200B\u2028\u2029\u202F\u3000]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[ \\t\\f\\r\\n\\x0B\\xA0\\u2000-\\u200B\\u2028\\u2029\\u202F\\u3000]")}}return aK}function au(){var aK;aK=g();if(aK===null){aK=A()}return aK}function p(){var aL,aK;var aM;aM=z(ar);aL=[];aK=au();while(aK!==null){aL.push(aK);aK=au()}if(aL!==null){aL=(function(aP,aN,aO){return""})(aM.offset,aM.line,aM.column)}if(aL===null){ar=z(aM)}return aL}function x(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);ah++;if(/^[ \t\f\r\n();[\]"]/.test(aH.charAt(ar.offset))){aM=aH.charAt(ar.offset);O(ar,1)}else{aM=null;if(ah===0){I('[ \\t\\f\\r\\n();[\\]"]')}}ah--;if(aM!==null){aM="";ar=z(aL)}else{aM=null}if(aM!==null){aK=p();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aN)}}else{aM=null;ar=z(aN)}if(aM===null){aN=z(ar);ah++;if(aH.length>ar.offset){aM=aH.charAt(ar.offset);O(ar,1)}else{aM=null;if(ah===0){I("any character")}}ah--;if(aM===null){aM=""}else{aM=null;ar=z(aN)}}return aM}function A(){var aM,aL,aK;var aN;aN=z(ar);if(aH.charCodeAt(ar.offset)===59){aM=";";O(ar,1)}else{aM=null;if(ah===0){I('";"')}}if(aM!==null){aL=[];if(/^[^\n\r]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[^\\n\\r]")}}while(aK!==null){aL.push(aK);if(/^[^\n\r]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[^\\n\\r]")}}}if(aL!==null){if(/^[\n\r]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[\\n\\r]")}}aK=aK!==null?aK:"";if(aK!==null){aM=[aM,aL,aK]}else{aM=null;ar=z(aN)}}else{aM=null;ar=z(aN)}}else{aM=null;ar=z(aN)}if(aM===null){aN=z(ar);if(aH.substr(ar.offset,2)==="#;"){aM="#;";O(ar,2)}else{aM=null;if(ah===0){I('"#;"')}}if(aM!==null){aL=p();if(aL!==null){aK=aB();if(aK!==null){aM=[aM,aL,aK]}else{aM=null;ar=z(aN)}}else{aM=null;ar=z(aN)}}else{aM=null;ar=z(aN)}}return aM}function aj(){var aN,aL,aK;var aO,aM;aO=z(ar);if(aH.charCodeAt(ar.offset)===955){aN="\u03BB";O(ar,1)}else{aN=null;if(ah===0){I('"\\u03BB"')}}if(aN!==null){aN=(function(aR,aP,aQ){return new Ccc.Symbol("lambda")})(aO.offset,aO.line,aO.column)}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);aN=j();if(aN!==null){aL=[];aK=al();while(aK!==null){aL.push(aK);aK=al()}if(aL!==null){aK=x();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aT,aP,aS,aR,aQ){return new Ccc.Symbol(aR+aQ.join(""))})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);aN=J();if(aN!==null){aL=x();if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aR,aQ){return new Ccc.Symbol(aQ)})(aO.offset,aO.line,aO.column,aN[0])}if(aN===null){ar=z(aO)}if(aN===null){aN=az()}}}return aN}function j(){var aK;aK=X();if(aK===null){aK=an()}return aK}function X(){var aK;if(/^[a-z]/i.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[a-z]i")}}return aK}function an(){var aN,aL;var aO,aM,aK;if(/^[!$%&*\/:<=>?^_~]/.test(aH.charAt(ar.offset))){aN=aH.charAt(ar.offset);O(ar,1)}else{aN=null;if(ah===0){I("[!$%&*\\/:<=>?^_~]")}}if(aN===null){aO=z(ar);aM=z(ar);aK=z(ar);ah++;aN=g();ah--;if(aN===null){aN=""}else{aN=null;ar=z(aK)}if(aN!==null){if(/^[\x80-\uFFFF]/.test(aH.charAt(ar.offset))){aL=aH.charAt(ar.offset);O(ar,1)}else{aL=null;if(ah===0){I("[\\x80-\\uFFFF]")}}if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aR,aP,aQ,aS){return aS})(aO.offset,aO.line,aO.column,aN[1])}if(aN===null){ar=z(aO)}}return aN}function al(){var aK;aK=j();if(aK===null){aK=K();if(aK===null){aK=f()}}return aK}function K(){var aK;if(/^[0-9]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[0-9]")}}return aK}function f(){var aK;if(aH.charCodeAt(ar.offset)===43){aK="+";O(ar,1)}else{aK=null;if(ah===0){I('"+"')}}if(aK===null){if(aH.charCodeAt(ar.offset)===45){aK="-";O(ar,1)}else{aK=null;if(ah===0){I('"-"')}}if(aK===null){if(aH.charCodeAt(ar.offset)===46){aK=".";O(ar,1)}else{aK=null;if(ah===0){I('"."')}}if(aK===null){if(aH.charCodeAt(ar.offset)===64){aK="@";O(ar,1)}else{aK=null;if(ah===0){I('"@"')}}}}}return aK}function J(){var aK;if(aH.charCodeAt(ar.offset)===43){aK="+";O(ar,1)}else{aK=null;if(ah===0){I('"+"')}}if(aK===null){if(aH.charCodeAt(ar.offset)===45){aK="-";O(ar,1)}else{aK=null;if(ah===0){I('"-"')}}if(aK===null){if(aH.substr(ar.offset,3)==="..."){aK="...";O(ar,3)}else{aK=null;if(ah===0){I('"..."')}}}}return aK}function w(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="#t"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"#t"')}}if(aM!==null){aK=x();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aQ,aO,aP){return Ccc.True})(aN.offset,aN.line,aN.column)}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aL=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="#f"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"#f"')}}if(aM!==null){aK=x();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aQ,aO,aP){return Ccc.False})(aN.offset,aN.line,aN.column)}if(aM===null){ar=z(aN)}}return aM}function av(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);if(aH.substr(ar.offset,7).toLowerCase()==="#\\space"){aN=aH.substr(ar.offset,7);O(ar,7)}else{aN=null;if(ah===0){I('"#\\\\space"')}}if(aN!==null){aL=x();if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aR,aP,aQ){return new Ccc.Character(" ")})(aO.offset,aO.line,aO.column)}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);if(aH.substr(ar.offset,9).toLowerCase()==="#\\newline"){aN=aH.substr(ar.offset,9);O(ar,9)}else{aN=null;if(ah===0){I('"#\\\\newline"')}}if(aN!==null){aL=x();if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aR,aP,aQ){return new Ccc.Character("\n")})(aO.offset,aO.line,aO.column)}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);if(aH.substr(ar.offset,2)==="#\\"){aN="#\\";O(ar,2)}else{aN=null;if(ah===0){I('"#\\\\"')}}if(aN!==null){if(aH.length>ar.offset){aL=aH.charAt(ar.offset);O(ar,1)}else{aL=null;if(ah===0){I("any character")}}if(aL!==null){aK=x();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aR,aP,aQ,aS){return new Ccc.Character(aS)})(aO.offset,aO.line,aO.column,aN[1])}if(aN===null){ar=z(aO)}}}return aN}function am(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);if(aH.charCodeAt(ar.offset)===34){aN='"';O(ar,1)}else{aN=null;if(ah===0){I('"\\""')}}if(aN!==null){aL=[];aK=o();while(aK!==null){aL.push(aK);aK=o()}if(aL!==null){if(aH.charCodeAt(ar.offset)===34){aK='"';O(ar,1)}else{aK=null;if(ah===0){I('"\\""')}}if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR){return new Ccc.String(aR.join(""))})(aO.offset,aO.line,aO.column,aN[1])}if(aN===null){ar=z(aO)}return aN}function aI(){var aP,aN,aM,aL,aK;var aQ,aO;aQ=z(ar);if(aH.substr(ar.offset,2)==="\\\\"){aP="\\\\";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\\\\\"')}}if(aP!==null){aP=(function(aT,aR,aS){return"\\"})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);if(aH.substr(ar.offset,2)==="\\n"){aP="\\n";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\n"')}}if(aP!==null){aP=(function(aT,aR,aS){return"\n"})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);if(aH.substr(ar.offset,2)==="\\t"){aP="\\t";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\t"')}}if(aP!==null){aP=(function(aT,aR,aS){return"\t"})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);if(aH.substr(ar.offset,2)==="\\f"){aP="\\f";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\f"')}}if(aP!==null){aP=(function(aT,aR,aS){return"\f"})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);if(aH.substr(ar.offset,2)==="\\r"){aP="\\r";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\r"')}}if(aP!==null){aP=(function(aT,aR,aS){return"\r"})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);if(aH.substr(ar.offset,2)==="\\'"){aP="\\'";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\\'"')}}if(aP!==null){aP=(function(aT,aR,aS){return"'"})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);if(aH.substr(ar.offset,2)==='\\"'){aP='\\"';O(ar,2)}else{aP=null;if(ah===0){I('"\\\\\\""')}}if(aP!==null){aP=(function(aT,aR,aS){return'"'})(aQ.offset,aQ.line,aQ.column)}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);aO=z(ar);if(aH.substr(ar.offset,2)==="\\x"){aP="\\x";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\x"')}}if(aP!==null){aN=aE();if(aN!==null){aM=aE();if(aM!==null){aP=[aP,aN,aM]}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}if(aP!==null){aP=(function(aV,aT,aU,aS,aR){return String.fromCharCode(parseInt(aS+aR,16))})(aQ.offset,aQ.line,aQ.column,aP[1],aP[2])}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);aO=z(ar);if(aH.substr(ar.offset,2)==="\\u"){aP="\\u";O(ar,2)}else{aP=null;if(ah===0){I('"\\\\u"')}}if(aP!==null){aN=aE();if(aN!==null){aM=aE();if(aM!==null){aL=aE();if(aL!==null){aK=aE();if(aK!==null){aP=[aP,aN,aM,aL,aK]}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}if(aP!==null){aP=(function(aW,aT,aU,aS,aR,aX,aV){return String.fromCharCode(parseInt(aS+aR+aX+aV,16))})(aQ.offset,aQ.line,aQ.column,aP[1],aP[2],aP[3],aP[4])}if(aP===null){ar=z(aQ)}}}}}}}}}return aP}function o(){var aK;if(/^[^"\\]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I('[^"\\\\]')}}if(aK===null){aK=aI()}return aK}function az(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);if(aH.charCodeAt(ar.offset)===124){aN="|";O(ar,1)}else{aN=null;if(ah===0){I('"|"')}}if(aN!==null){aK=t();if(aK!==null){aL=[];while(aK!==null){aL.push(aK);aK=t()}}else{aL=null}if(aL!==null){if(aH.charCodeAt(ar.offset)===124){aK="|";O(ar,1)}else{aK=null;if(ah===0){I('"|"')}}if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR){return new Ccc.Symbol(aR.join(""))})(aO.offset,aO.line,aO.column,aN[1])}if(aN===null){ar=z(aO)}return aN}function t(){var aK;var aL;if(/^[^|\\]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[^|\\\\]")}}if(aK===null){aL=z(ar);if(aH.substr(ar.offset,2)==="\\|"){aK="\\|";O(ar,2)}else{aK=null;if(ah===0){I('"\\\\|"')}}if(aK!==null){aK=(function(aO,aM,aN){return"|"})(aL.offset,aL.line,aL.column)}if(aK===null){ar=z(aL)}if(aK===null){aK=aI()}}return aK}function B(){var aK;var aL;aL=z(ar);if(aH.substr(ar.offset,2)==="()"){aK="()";O(ar,2)}else{aK=null;if(ah===0){I('"()"')}}if(aK!==null){aK=(function(aO,aM,aN){return Ccc.Nil})(aL.offset,aL.line,aL.column)}if(aK===null){ar=z(aL)}if(aK===null){aL=z(ar);if(aH.substr(ar.offset,2)==="[]"){aK="[]";O(ar,2)}else{aK=null;if(ah===0){I('"[]"')}}if(aK!==null){aK=(function(aO,aM,aN){return Ccc.Nil})(aL.offset,aL.line,aL.column)}if(aK===null){ar=z(aL)}}return aK}function l(){var aK;var aL;aL=z(ar);if(aH.substr(ar.offset,12)==="#!unspecific"){aK="#!unspecific";O(ar,12)}else{aK=null;if(ah===0){I('"#!unspecific"')}}if(aK!==null){aK=(function(aO,aM,aN){return Ccc.Unspecified})(aL.offset,aL.line,aL.column)}if(aK===null){ar=z(aL)}return aK}function y(){var aK;aK=af();if(aK===null){aK=ac();if(aK===null){aK=q();if(aK===null){aK=m()}}}return aK}function h(){var aO,aM,aL,aK;var aP,aN;aP=z(ar);aN=z(ar);aO=ap();if(aO!==null){aM=ad();aM=aM!==null?aM:"";if(aM!==null){aK=K();if(aK!==null){aL=[];while(aK!==null){aL.push(aK);aK=K()}}else{aL=null}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aW,aQ,aS,aT,aR,aV){var aU=parseInt(aV.join(""),10);if(aR==="-"){aU=-aU}aT={s:0,e:1,f:1,d:2,l:3}[aT];return{precision:aT,value:aU}})(aP.offset,aP.line,aP.column,aO[0],aO[1],aO[2])}if(aO===null){ar=z(aP)}return aO}function ap(){var aK;if(/^[esfdl]/i.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[esfdl]i")}}return aK}function ad(){var aK;if(aH.charCodeAt(ar.offset)===43){aK="+";O(ar,1)}else{aK=null;if(ah===0){I('"+"')}}if(aK===null){if(aH.charCodeAt(ar.offset)===45){aK="-";O(ar,1)}else{aK=null;if(ah===0){I('"-"')}}}return aK}function at(){var aK;var aL;aL=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="#i"){aK=aH.substr(ar.offset,2);O(ar,2)}else{aK=null;if(ah===0){I('"#i"')}}if(aK!==null){aK=(function(aO,aM,aN){return false})(aL.offset,aL.line,aL.column)}if(aK===null){ar=z(aL)}if(aK===null){aL=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="#e"){aK=aH.substr(ar.offset,2);O(ar,2)}else{aK=null;if(ah===0){I('"#e"')}}if(aK!==null){aK=(function(aO,aM,aN){return true})(aL.offset,aL.line,aL.column)}if(aK===null){ar=z(aL)}}return aK}function af(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=Z();if(aN!==null){aL=aq();if(aL!==null){aK=x();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR,aT){if(aR===true){return aT.toExact()}else{if(aR===false){return aT.toInexact()}else{return aT}}})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function aq(){var aO,aM,aL,aK;var aP,aN;aP=z(ar);aN=z(ar);aO=aa();if(aO!==null){if(aH.charCodeAt(ar.offset)===64){aM="@";O(ar,1)}else{aM=null;if(ah===0){I('"@"')}}if(aM!==null){aL=aa();if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aR,aS,aT,aQ){return Ccc.Numeric.fromPolar(aT.toInexact().realNumer,aQ.toInexact().realNumer)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=aa();if(aO!==null){if(aH.charCodeAt(ar.offset)===43){aM="+";O(ar,1)}else{aM=null;if(ah===0){I('"+"')}}if(aM!==null){aL=F();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=aa();if(aO!==null){if(aH.charCodeAt(ar.offset)===45){aM="-";O(ar,1)}else{aM=null;if(ah===0){I('"-"')}}if(aM!==null){aL=F();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR.negative())})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=aa();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"+i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=aa();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"-i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,-1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===43){aO="+";O(ar,1)}else{aO=null;if(ah===0){I('"+"')}}if(aO!==null){aM=F();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR)})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===45){aO="-";O(ar,1)}else{aO=null;if(ah===0){I('"-"')}}if(aO!==null){aM=F();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR.negative())})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aO=aa();if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"+i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"-i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,-1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}}}}}}}}}}return aO}function aa(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=ad();aM=aM!==null?aM:"";if(aM!==null){aK=F();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aQ,aP,aS){return(aP==="-")?aS.negative():aS})(aN.offset,aN.line,aN.column,aM[0],aM[1])}if(aM===null){ar=z(aN)}return aM}function F(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=E();if(aN!==null){if(aH.charCodeAt(ar.offset)===47){aL="/";O(ar,1)}else{aL=null;if(ah===0){I('"/"')}}if(aL!==null){aK=E();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aT,aR){return Ccc.ParseUtil.makeRational(aT,aR)})(aO.offset,aO.line,aO.column,aN[0],aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aN=E()}return aN}function E(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aL=S();if(aL!==null){aN=[];while(aL!==null){aN.push(aL);aL=S()}}else{aN=null}if(aN!==null){aL=[];if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}while(aK!==null){aL.push(aK);if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}}if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aT,aP,aR,aS,aQ){return Ccc.ParseUtil.realFromTokens(aS,aQ,2)})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function Z(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=u();if(aM!==null){aK=at();aK=aK!==null?aK:"";if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[1])}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aL=z(ar);aM=at();aM=aM!==null?aM:"";if(aM!==null){aK=u();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[0])}if(aM===null){ar=z(aN)}}return aM}function u(){var aK;if(aH.substr(ar.offset,2).toLowerCase()==="#b"){aK=aH.substr(ar.offset,2);O(ar,2)}else{aK=null;if(ah===0){I('"#b"')}}return aK}function S(){var aK;if(/^[01]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[01]")}}return aK}function ac(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=U();if(aN!==null){aL=ao();if(aL!==null){aK=x();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR,aT){if(aR===true){return aT.toExact()}else{if(aR===false){return aT.toInexact()}else{return aT}}})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function ao(){var aO,aM,aL,aK;var aP,aN;aP=z(ar);aN=z(ar);aO=W();if(aO!==null){if(aH.charCodeAt(ar.offset)===64){aM="@";O(ar,1)}else{aM=null;if(ah===0){I('"@"')}}if(aM!==null){aL=W();if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aR,aS,aT,aQ){return Ccc.Numeric.fromPolar(aT.toInexact().realNumer,aQ.toInexact().realNumer)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=W();if(aO!==null){if(aH.charCodeAt(ar.offset)===43){aM="+";O(ar,1)}else{aM=null;if(ah===0){I('"+"')}}if(aM!==null){aL=D();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=W();if(aO!==null){if(aH.charCodeAt(ar.offset)===45){aM="-";O(ar,1)}else{aM=null;if(ah===0){I('"-"')}}if(aM!==null){aL=D();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR.negative())})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=W();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"+i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=W();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"-i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,-1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===43){aO="+";O(ar,1)}else{aO=null;if(ah===0){I('"+"')}}if(aO!==null){aM=D();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR)})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===45){aO="-";O(ar,1)}else{aO=null;if(ah===0){I('"-"')}}if(aO!==null){aM=D();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR.negative())})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aO=W();if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"+i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"-i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,-1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}}}}}}}}}}return aO}function W(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=ad();aM=aM!==null?aM:"";if(aM!==null){aK=D();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aQ,aP,aS){return(aP==="-")?aS.negative():aS})(aN.offset,aN.line,aN.column,aM[0],aM[1])}if(aM===null){ar=z(aN)}return aM}function D(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=C();if(aN!==null){if(aH.charCodeAt(ar.offset)===47){aL="/";O(ar,1)}else{aL=null;if(ah===0){I('"/"')}}if(aL!==null){aK=C();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aT,aR){return Ccc.ParseUtil.makeRational(aT,aR)})(aO.offset,aO.line,aO.column,aN[0],aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aN=C()}return aN}function C(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aL=P();if(aL!==null){aN=[];while(aL!==null){aN.push(aL);aL=P()}}else{aN=null}if(aN!==null){aL=[];if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}while(aK!==null){aL.push(aK);if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}}if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aT,aP,aR,aS,aQ){return Ccc.ParseUtil.realFromTokens(aS,aQ,8)})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function U(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=r();if(aM!==null){aK=at();aK=aK!==null?aK:"";if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[1])}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aL=z(ar);aM=at();aM=aM!==null?aM:"";if(aM!==null){aK=r();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[0])}if(aM===null){ar=z(aN)}}return aM}function r(){var aK;if(aH.substr(ar.offset,2).toLowerCase()==="#o"){aK=aH.substr(ar.offset,2);O(ar,2)}else{aK=null;if(ah===0){I('"#o"')}}return aK}function P(){var aK;if(/^[0-7]/.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[0-7]")}}return aK}function q(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=N();aN=aN!==null?aN:"";if(aN!==null){aL=aF();if(aL!==null){aK=x();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR,aT){if(aR===true){return aT.toExact()}else{if(aR===false){return aT.toInexact()}else{return aT}}})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function aF(){var aO,aM,aL,aK;var aP,aN;aP=z(ar);aN=z(ar);aO=ak();if(aO!==null){if(aH.charCodeAt(ar.offset)===64){aM="@";O(ar,1)}else{aM=null;if(ah===0){I('"@"')}}if(aM!==null){aL=ak();if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aR,aS,aT,aQ){return Ccc.Numeric.fromPolar(aT.toInexact().realNumer,aQ.toInexact().realNumer)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ak();if(aO!==null){if(aH.charCodeAt(ar.offset)===43){aM="+";O(ar,1)}else{aM=null;if(ah===0){I('"+"')}}if(aM!==null){aL=v();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ak();if(aO!==null){if(aH.charCodeAt(ar.offset)===45){aM="-";O(ar,1)}else{aM=null;if(ah===0){I('"-"')}}if(aM!==null){aL=v();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR.negative())})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ak();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"+i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ak();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"-i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,-1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===43){aO="+";O(ar,1)}else{aO=null;if(ah===0){I('"+"')}}if(aO!==null){aM=v();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR)})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===45){aO="-";O(ar,1)}else{aO=null;if(ah===0){I('"-"')}}if(aO!==null){aM=v();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR.negative())})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aO=ak();if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"+i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"-i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,-1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}}}}}}}}}}return aO}function ak(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=ad();aM=aM!==null?aM:"";if(aM!==null){aK=v();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aQ,aP,aS){return(aP==="-")?aS.negative():aS})(aN.offset,aN.line,aN.column,aM[0],aM[1])}if(aM===null){ar=z(aN)}return aM}function v(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=aC();if(aN!==null){if(aH.charCodeAt(ar.offset)===47){aL="/";O(ar,1)}else{aL=null;if(ah===0){I('"/"')}}if(aL!==null){aK=aC();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aT,aR){return Ccc.ParseUtil.makeRational(aT,aR)})(aO.offset,aO.line,aO.column,aN[0],aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aN=c();if(aN===null){aN=aC()}}return aN}function c(){var aP,aN,aM,aL,aK;var aQ,aO;aQ=z(ar);aO=z(ar);aN=K();if(aN!==null){aP=[];while(aN!==null){aP.push(aN);aN=K()}}else{aP=null}if(aP!==null){if(aH.charCodeAt(ar.offset)===35){aM="#";O(ar,1)}else{aM=null;if(ah===0){I('"#"')}}if(aM!==null){aN=[];while(aM!==null){aN.push(aM);if(aH.charCodeAt(ar.offset)===35){aM="#";O(ar,1)}else{aM=null;if(ah===0){I('"#"')}}}}else{aN=null}if(aN!==null){if(aH.charCodeAt(ar.offset)===46){aM=".";O(ar,1)}else{aM=null;if(ah===0){I('"."')}}if(aM!==null){aL=[];if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}while(aK!==null){aL.push(aK);if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}}if(aL!==null){aK=h();aK=aK!==null?aK:"";if(aK!==null){aP=[aP,aN,aM,aL,aK]}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}if(aP!==null){aP=(function(aW,aT,aV,aS,aR,aX,aU){return Ccc.ParseUtil.numberFromDecimal(parseFloat(aS.join("")+"."),aR,aX,aU,true)})(aQ.offset,aQ.line,aQ.column,aP[0],aP[1],aP[3],aP[4])}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);aO=z(ar);aN=K();if(aN!==null){aP=[];while(aN!==null){aP.push(aN);aN=K()}}else{aP=null}if(aP!==null){if(aH.charCodeAt(ar.offset)===46){aN=".";O(ar,1)}else{aN=null;if(ah===0){I('"."')}}if(aN!==null){aM=[];aL=K();while(aL!==null){aM.push(aL);aL=K()}if(aM!==null){aL=[];if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}while(aK!==null){aL.push(aK);if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}}if(aL!==null){aK=h();aK=aK!==null?aK:"";if(aK!==null){aP=[aP,aN,aM,aL,aK]}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}if(aP!==null){aP=(function(aW,aT,aV,aS,aR,aX,aU){return Ccc.ParseUtil.numberFromDecimal(parseFloat(aS.join("")+"."+aR.join("")),"",aX,aU,true)})(aQ.offset,aQ.line,aQ.column,aP[0],aP[2],aP[3],aP[4])}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);aO=z(ar);if(aH.charCodeAt(ar.offset)===46){aP=".";O(ar,1)}else{aP=null;if(ah===0){I('"."')}}if(aP!==null){aM=K();if(aM!==null){aN=[];while(aM!==null){aN.push(aM);aM=K()}}else{aN=null}if(aN!==null){aM=[];if(aH.charCodeAt(ar.offset)===35){aL="#";O(ar,1)}else{aL=null;if(ah===0){I('"#"')}}while(aL!==null){aM.push(aL);if(aH.charCodeAt(ar.offset)===35){aL="#";O(ar,1)}else{aL=null;if(ah===0){I('"#"')}}}if(aM!==null){aL=h();aL=aL!==null?aL:"";if(aL!==null){aP=[aP,aN,aM,aL]}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}if(aP!==null){aP=(function(aV,aS,aU,aR,aW,aT){return Ccc.ParseUtil.numberFromDecimal(parseFloat("."+aR.join("")),"",aW,aT,true)})(aQ.offset,aQ.line,aQ.column,aP[1],aP[2],aP[3])}if(aP===null){ar=z(aQ)}if(aP===null){aQ=z(ar);aO=z(ar);aP=aC();if(aP!==null){aN=h();aN=aN!==null?aN:"";if(aN!==null){aP=[aP,aN]}else{aP=null;ar=z(aO)}}else{aP=null;ar=z(aO)}if(aP!==null){aP=(function(aU,aR,aT,aV,aS){return Ccc.ParseUtil.numberFromDecimal(aV,"","",aS,false)})(aQ.offset,aQ.line,aQ.column,aP[0],aP[1])}if(aP===null){ar=z(aQ)}}}}return aP}function aC(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aL=K();if(aL!==null){aN=[];while(aL!==null){aN.push(aL);aL=K()}}else{aN=null}if(aN!==null){aL=[];if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}while(aK!==null){aL.push(aK);if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}}if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aT,aP,aR,aS,aQ){return Ccc.ParseUtil.realFromTokens(aS,aQ,10)})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function N(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=V();if(aM!==null){aK=at();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[1])}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aL=z(ar);aM=at();if(aM!==null){aK=V();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[0])}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aM=at();if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM)}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aM=V();if(aM!==null){aM=(function(aQ,aO,aP){return""})(aN.offset,aN.line,aN.column)}if(aM===null){ar=z(aN)}}}}return aM}function V(){var aK;if(aH.substr(ar.offset,2).toLowerCase()==="#d"){aK=aH.substr(ar.offset,2);O(ar,2)}else{aK=null;if(ah===0){I('"#d"')}}return aK}function m(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=M();if(aN!==null){aL=ay();if(aL!==null){aK=x();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aR,aT){if(aR===true){return aT.toExact()}else{if(aR===false){return aT.toInexact()}else{return aT}}})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function ay(){var aO,aM,aL,aK;var aP,aN;aP=z(ar);aN=z(ar);aO=ai();if(aO!==null){if(aH.charCodeAt(ar.offset)===64){aM="@";O(ar,1)}else{aM=null;if(ah===0){I('"@"')}}if(aM!==null){aL=ai();if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aR,aS,aT,aQ){return Ccc.Numeric.fromPolar(aT.toInexact().realNumer,aQ.toInexact().realNumer)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ai();if(aO!==null){if(aH.charCodeAt(ar.offset)===43){aM="+";O(ar,1)}else{aM=null;if(ah===0){I('"+"')}}if(aM!==null){aL=s();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR)})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ai();if(aO!==null){if(aH.charCodeAt(ar.offset)===45){aM="-";O(ar,1)}else{aM=null;if(ah===0){I('"-"')}}if(aM!==null){aL=s();if(aL!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aK=aH.substr(ar.offset,1);O(ar,1)}else{aK=null;if(ah===0){I('"i"')}}if(aK!==null){aO=[aO,aM,aL,aK]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aU,aQ,aS,aT,aR){return new Ccc.Complex(aT,aR.negative())})(aP.offset,aP.line,aP.column,aO[0],aO[2])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ai();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"+i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);aO=ai();if(aO!==null){if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aM=aH.substr(ar.offset,2);O(ar,2)}else{aM=null;if(ah===0){I('"-i"')}}if(aM!==null){aO=[aO,aM]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aR,aS){return new Ccc.Complex(aS,-1)})(aP.offset,aP.line,aP.column,aO[0])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===43){aO="+";O(ar,1)}else{aO=null;if(ah===0){I('"+"')}}if(aO!==null){aM=s();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR)})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);aN=z(ar);if(aH.charCodeAt(ar.offset)===45){aO="-";O(ar,1)}else{aO=null;if(ah===0){I('"-"')}}if(aO!==null){aM=s();if(aM!==null){if(aH.substr(ar.offset,1).toLowerCase()==="i"){aL=aH.substr(ar.offset,1);O(ar,1)}else{aL=null;if(ah===0){I('"i"')}}if(aL!==null){aO=[aO,aM,aL]}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}}else{aO=null;ar=z(aN)}if(aO!==null){aO=(function(aT,aQ,aS,aR){return new Ccc.Complex(0,aR.negative())})(aP.offset,aP.line,aP.column,aO[1])}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="+i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"+i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}if(aO===null){aP=z(ar);if(aH.substr(ar.offset,2).toLowerCase()==="-i"){aO=aH.substr(ar.offset,2);O(ar,2)}else{aO=null;if(ah===0){I('"-i"')}}if(aO!==null){aO=(function(aS,aQ,aR){return new Ccc.Complex(0,-1)})(aP.offset,aP.line,aP.column)}if(aO===null){ar=z(aP)}if(aO===null){aO=ai()}}}}}}}}}return aO}function ai(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=ad();aM=aM!==null?aM:"";if(aM!==null){aK=s();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aQ,aP,aS){return(aP==="-")?aS.negative():aS})(aN.offset,aN.line,aN.column,aM[0],aM[1])}if(aM===null){ar=z(aN)}return aM}function s(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aN=ax();if(aN!==null){if(aH.charCodeAt(ar.offset)===47){aL="/";O(ar,1)}else{aL=null;if(ah===0){I('"/"')}}if(aL!==null){aK=ax();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aQ,aT,aR){return Ccc.ParseUtil.makeRational(aT,aR)})(aO.offset,aO.line,aO.column,aN[0],aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aN=ax()}return aN}function ax(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);aL=aE();if(aL!==null){aN=[];while(aL!==null){aN.push(aL);aL=aE()}}else{aN=null}if(aN!==null){aL=[];if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}while(aK!==null){aL.push(aK);if(aH.charCodeAt(ar.offset)===35){aK="#";O(ar,1)}else{aK=null;if(ah===0){I('"#"')}}}if(aL!==null){aN=[aN,aL]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aT,aP,aR,aS,aQ){return Ccc.ParseUtil.realFromTokens(aS,aQ,16)})(aO.offset,aO.line,aO.column,aN[0],aN[1])}if(aN===null){ar=z(aO)}return aN}function M(){var aM,aK;var aN,aL;aN=z(ar);aL=z(ar);aM=Q();if(aM!==null){aK=at();aK=aK!==null?aK:"";if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[1])}if(aM===null){ar=z(aN)}if(aM===null){aN=z(ar);aL=z(ar);aM=at();aM=aM!==null?aM:"";if(aM!==null){aK=Q();if(aK!==null){aM=[aM,aK]}else{aM=null;ar=z(aL)}}else{aM=null;ar=z(aL)}if(aM!==null){aM=(function(aR,aO,aP,aQ){return aQ})(aN.offset,aN.line,aN.column,aM[0])}if(aM===null){ar=z(aN)}}return aM}function Q(){var aK;if(aH.substr(ar.offset,2).toLowerCase()==="#x"){aK=aH.substr(ar.offset,2);O(ar,2)}else{aK=null;if(ah===0){I('"#x"')}}return aK}function aE(){var aK;aK=K();if(aK===null){if(/^[abcdef]/i.test(aH.charAt(ar.offset))){aK=aH.charAt(ar.offset);O(ar,1)}else{aK=null;if(ah===0){I("[abcdef]i")}}}return aK}function aB(){var aK;aK=aA();if(aK===null){aK=e()}return aK}function aA(){var aK;aK=w();if(aK===null){aK=y();if(aK===null){aK=av();if(aK===null){aK=am();if(aK===null){aK=aj();if(aK===null){aK=B();if(aK===null){aK=l()}}}}}}return aK}function e(){var aK;aK=L();if(aK===null){aK=k()}return aK}function L(){var aR,aQ,aP,aO,aN,aM,aL,aK;var aU,aT,aS;aU=z(ar);aT=z(ar);if(aH.charCodeAt(ar.offset)===40){aR="(";O(ar,1)}else{aR=null;if(ah===0){I('"("')}}if(aR!==null){aQ=p();if(aQ!==null){aP=[];aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}while(aO!==null){aP.push(aO);aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}}if(aP!==null){if(aH.charCodeAt(ar.offset)===41){aO=")";O(ar,1)}else{aO=null;if(ah===0){I('")"')}}if(aO!==null){aR=[aR,aQ,aP,aO]}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}if(aR!==null){aR=(function(aZ,aV,aX,aW){var aY=Ccc.ParseUtil.arrayFromArrays(aW,0);return Ccc.Pair.fromArray(aY)})(aU.offset,aU.line,aU.column,aR[2])}if(aR===null){ar=z(aU)}if(aR===null){aU=z(ar);aT=z(ar);if(aH.charCodeAt(ar.offset)===91){aR="[";O(ar,1)}else{aR=null;if(ah===0){I('"["')}}if(aR!==null){aQ=p();if(aQ!==null){aP=[];aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}while(aO!==null){aP.push(aO);aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}}if(aP!==null){if(aH.charCodeAt(ar.offset)===93){aO="]";O(ar,1)}else{aO=null;if(ah===0){I('"]"')}}if(aO!==null){aR=[aR,aQ,aP,aO]}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}if(aR!==null){aR=(function(aZ,aV,aX,aW){var aY=Ccc.ParseUtil.arrayFromArrays(aW,0);return Ccc.Pair.fromArray(aY)})(aU.offset,aU.line,aU.column,aR[2])}if(aR===null){ar=z(aU)}if(aR===null){aU=z(ar);aT=z(ar);if(aH.charCodeAt(ar.offset)===40){aR="(";O(ar,1)}else{aR=null;if(ah===0){I('"("')}}if(aR!==null){aQ=p();if(aQ!==null){aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}if(aO!==null){aP=[];while(aO!==null){aP.push(aO);aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}}}else{aP=null}if(aP!==null){if(aH.charCodeAt(ar.offset)===46){aO=".";O(ar,1)}else{aO=null;if(ah===0){I('"."')}}if(aO!==null){aN=x();if(aN!==null){aM=aB();if(aM!==null){aL=p();if(aL!==null){if(aH.charCodeAt(ar.offset)===41){aK=")";O(ar,1)}else{aK=null;if(ah===0){I('")"')}}if(aK!==null){aR=[aR,aQ,aP,aO,aN,aM,aL,aK]}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}if(aR!==null){aR=(function(a0,aV,aY,aW,aX){var aZ=Ccc.ParseUtil.arrayFromArrays(aW,0);return Ccc.Pair.fromArray(aZ,aX)})(aU.offset,aU.line,aU.column,aR[2],aR[5])}if(aR===null){ar=z(aU)}if(aR===null){aU=z(ar);aT=z(ar);if(aH.charCodeAt(ar.offset)===91){aR="[";O(ar,1)}else{aR=null;if(ah===0){I('"["')}}if(aR!==null){aQ=p();if(aQ!==null){aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}if(aO!==null){aP=[];while(aO!==null){aP.push(aO);aS=z(ar);aO=aB();if(aO!==null){aN=p();if(aN!==null){aO=[aO,aN]}else{aO=null;ar=z(aS)}}else{aO=null;ar=z(aS)}}}else{aP=null}if(aP!==null){if(aH.charCodeAt(ar.offset)===46){aO=".";O(ar,1)}else{aO=null;if(ah===0){I('"."')}}if(aO!==null){aN=x();if(aN!==null){aM=aB();if(aM!==null){aL=p();if(aL!==null){if(aH.charCodeAt(ar.offset)===93){aK="]";O(ar,1)}else{aK=null;if(ah===0){I('"]"')}}if(aK!==null){aR=[aR,aQ,aP,aO,aN,aM,aL,aK]}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}}else{aR=null;ar=z(aT)}if(aR!==null){aR=(function(a0,aV,aY,aW,aX){var aZ=Ccc.ParseUtil.arrayFromArrays(aW,0);return Ccc.Pair.fromArray(aZ,aX)})(aU.offset,aU.line,aU.column,aR[2],aR[5])}if(aR===null){ar=z(aU)}if(aR===null){aR=T()}}}}return aR}function T(){var aN,aL,aK;var aO,aM;aO=z(ar);aM=z(ar);if(aH.substr(ar.offset,2)===",@"){aN=",@";O(ar,2)}else{aN=null;if(ah===0){I('",@"')}}if(aN!==null){aL=p();if(aL!==null){aK=aB();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aR,aQ){return new Ccc.Pair(new Ccc.Symbol("unquote-splicing"),new Ccc.Pair(aQ,Ccc.Nil))})(aO.offset,aO.line,aO.column,aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);if(aH.charCodeAt(ar.offset)===39){aN="'";O(ar,1)}else{aN=null;if(ah===0){I('"\'"')}}if(aN!==null){aL=p();if(aL!==null){aK=aB();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aR,aQ){return new Ccc.Pair(new Ccc.Symbol("quote"),new Ccc.Pair(aQ,Ccc.Nil))})(aO.offset,aO.line,aO.column,aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);if(aH.charCodeAt(ar.offset)===96){aN="`";O(ar,1)}else{aN=null;if(ah===0){I('"`"')}}if(aN!==null){aL=p();if(aL!==null){aK=aB();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aR,aQ){return new Ccc.Pair(new Ccc.Symbol("quasiquote"),new Ccc.Pair(aQ,Ccc.Nil))})(aO.offset,aO.line,aO.column,aN[2])}if(aN===null){ar=z(aO)}if(aN===null){aO=z(ar);aM=z(ar);if(aH.charCodeAt(ar.offset)===44){aN=",";O(ar,1)}else{aN=null;if(ah===0){I('","')}}if(aN!==null){aL=p();if(aL!==null){aK=aB();if(aK!==null){aN=[aN,aL,aK]}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}}else{aN=null;ar=z(aM)}if(aN!==null){aN=(function(aS,aP,aR,aQ){return new Ccc.Pair(new Ccc.Symbol("unquote"),new Ccc.Pair(aQ,Ccc.Nil))})(aO.offset,aO.line,aO.column,aN[2])}if(aN===null){ar=z(aO)}}}}return aN}function k(){var aQ,aO,aM,aL,aK;var aR,aP,aN;aR=z(ar);aP=z(ar);if(aH.substr(ar.offset,2)==="#("){aQ="#(";O(ar,2)}else{aQ=null;if(ah===0){I('"#("')}}if(aQ!==null){aO=p();if(aO!==null){aM=[];aN=z(ar);aL=aB();if(aL!==null){aK=p();if(aK!==null){aL=[aL,aK]}else{aL=null;ar=z(aN)}}else{aL=null;ar=z(aN)}while(aL!==null){aM.push(aL);aN=z(ar);aL=aB();if(aL!==null){aK=p();if(aK!==null){aL=[aL,aK]}else{aL=null;ar=z(aN)}}else{aL=null;ar=z(aN)}}if(aM!==null){if(aH.charCodeAt(ar.offset)===41){aL=")";O(ar,1)}else{aL=null;if(ah===0){I('")"')}}if(aL!==null){aQ=[aQ,aO,aM,aL]}else{aQ=null;ar=z(aP)}}else{aQ=null;ar=z(aP)}}else{aQ=null;ar=z(aP)}}else{aQ=null;ar=z(aP)}if(aQ!==null){aQ=(function(aW,aS,aU,aT){var aV=Ccc.ParseUtil.arrayFromArrays(aT,0);return new Ccc.Vector(aV)})(aR.offset,aR.line,aR.column,aQ[2])}if(aQ===null){ar=z(aR)}if(aQ===null){aR=z(ar);aP=z(ar);if(aH.substr(ar.offset,2)==="#["){aQ="#[";O(ar,2)}else{aQ=null;if(ah===0){I('"#["')}}if(aQ!==null){aO=p();if(aO!==null){aM=[];aN=z(ar);aL=aB();if(aL!==null){aK=p();if(aK!==null){aL=[aL,aK]}else{aL=null;ar=z(aN)}}else{aL=null;ar=z(aN)}while(aL!==null){aM.push(aL);aN=z(ar);aL=aB();if(aL!==null){aK=p();if(aK!==null){aL=[aL,aK]}else{aL=null;ar=z(aN)}}else{aL=null;ar=z(aN)}}if(aM!==null){if(aH.charCodeAt(ar.offset)===93){aL="]";O(ar,1)}else{aL=null;if(ah===0){I('"]"')}}if(aL!==null){aQ=[aQ,aO,aM,aL]}else{aQ=null;ar=z(aP)}}else{aQ=null;ar=z(aP)}}else{aQ=null;ar=z(aP)}}else{aQ=null;ar=z(aP)}if(aQ!==null){aQ=(function(aW,aS,aU,aT){var aV=Ccc.ParseUtil.arrayFromArrays(aT,0);return new Ccc.Vector(aV)})(aR.offset,aR.line,aR.column,aQ[2])}if(aQ===null){ar=z(aR)}}return aQ}function ag(){var aN,aL,aK;var aO,aM;aO=z(ar);aN=[];aM=z(ar);aL=aB();if(aL!==null){aK=p();if(aK!==null){aL=[aL,aK]}else{aL=null;ar=z(aM)}}else{aL=null;ar=z(aM)}while(aL!==null){aN.push(aL);aM=z(ar);aL=aB();if(aL!==null){aK=p();if(aK!==null){aL=[aL,aK]}else{aL=null;ar=z(aM)}}else{aL=null;ar=z(aM)}}if(aN!==null){aN=(function(aS,aP,aQ,aR){return new Ccc.Program(Ccc.ParseUtil.arrayFromArrays(aR,0))})(aO.offset,aO.line,aO.column,aN)}if(aN===null){ar=z(aO)}return aN}function H(aM){aM.sort();var aN=null;var aL=[];for(var aK=0;aK<aM.length;aK++){if(aM[aK]!==aN){aL.push(aM[aK]);aN=aM[aK]}}return aL}var aD=R[aJ]();if(aD===null||ar.offset!==aH.length){var n=Math.max(ar.offset,Y.offset);var ab=n<aH.length?aH.charAt(n):null;var d=ar.offset>Y.offset?ar:Y;throw new this.SyntaxError(H(G),ab,n,d.line,d.column)}return aD},toSource:function(){return this._source}};a.SyntaxError=function(f,g,h,d,e){function c(l,m){var j,k;switch(l.length){case 0:j="end of input";break;case 1:j=l[0];break;default:j=l.slice(0,l.length-1).join(", ")+" or "+l[l.length-1]}k=m?b(m):"end of input";return"Expected "+j+" but "+k+" found."}this.name="SyntaxError";this.expected=f;this.found=g;this.message=c(f,g);this.offset=h;this.line=d;this.column=e};a.SyntaxError.prototype=Error.prototype;return a})();(function(){var c=function(m,p){var q=[],n;for(n=0;n<m.length;n+=1){q[n]=p(m[n])}return q};var h=Ccc.NullEnvironment;var a=function(o,m){h.defineSyntax(o,m)};var b=function(n,m){return new Ccc.TransformerSpec(n,m)};var j=function(m){return Ccc.Pair.fromArray([].slice.call(arguments))};var d=function(m){return new Ccc.Symbol(m)};var g=function(m,n){return new Ccc.Pair(m,n)};var e=function(m,n){return new Ccc.SyntaxRule(new Ccc.Pattern(m),n)};var l=function(m){return new Ccc.Ellipsis(m)};a("quote",b([],[e(j(d("datum")),function(m){return new Ccc.Quote(m.datum)})]));a("define-syntax",b([],[e(j(d("keyword"),d("transformer-spec")),function(o,m){var n=o.keyword;h.defineSyntax(n.id,o["transformer-spec"].transform(m));return new Ccc.Pair(new Ccc.Symbol("quote"),new Ccc.Pair(n,Ccc.Nil))})]));a("let-syntax",b([],[e(j(j(l(j(d("keyword"),d("transformer-spec")))),l(d("body"))),function(o,v){var z=v.clone(),t=c(o.keyword.datum.toArray(),function(C){return C}),n=c(o["transformer-spec"].datum.toArray(),function(C){return C.transform(v)}),x,u,A,s={},y={},B,q=[],m,p,w,r;for(x=0;x<t.length;x+=1){y[t[x].id]={}}for(x=0;x<t.length;x+=1){B=n[x].getFreeReferences(z);for(u=0;u<B.length;u+=1){if(!y.hasOwnProperty(B[u])&&!z.tryGet(B[u])&&z.tryGetSyntax(B[u])){w=new Ccc.Symbol(z.gensym(),B[u]);z.defineSyntax(w.id,z.getSyntax(B[u]));r={};r[B[u]]=w;n[x].replaceSymbols(r)}else{if(!s.hasOwnProperty(B[u])){s[B[u]]=new Ccc.Symbol(z.gensym(),B[u]);z.reserve(s[B[u]].id)}}}n[x].replaceSymbols(s);z.defineSyntax(t[x].id,n[x])}for(x in s){if(s.hasOwnProperty(x)){q.push(x)}}m=Ccc.Pair.fromArray(c(q,function(C){return s[C]}));p=Ccc.Pair.fromArray(c(q,function(C){return new Ccc.Symbol(C)}));A=c(o.body.datum.toArray(),function(C){return C.transform(z)});return(new Ccc.Pair(new Ccc.Pair(new Ccc.Symbol("lambda"),new Ccc.Pair(m,Ccc.Pair.fromArray(A))),p)).transform(z)})]));a("letrec-syntax",b([],[e(j(j(l(j(d("keyword"),d("transformer-spec")))),l(d("body"))),function(o,v){var z=v.clone(),t=c(o.keyword.datum.toArray(),function(C){return C}),n=c(o["transformer-spec"].datum.toArray(),function(C){return C.transform(v)}),x,u,A,y={},s={},B,q=[],m,p,w,r;for(x=0;x<t.length;x+=1){y[t[x].id]={}}for(x=0;x<t.length;x+=1){B=n[x].getFreeReferences(z);for(u=0;u<B.length;u+=1){if(!y.hasOwnProperty(B[u])&&!z.tryGet(B[u])&&z.tryGetSyntax(B[u])){w=new Ccc.Symbol(z.gensym(),B[u]);w.name=w.id;z.defineSyntax(w.id,z.getSyntax(B[u]));r={};r[B[u]]=w;n[x].replaceSymbols(r)}else{if(!s.hasOwnProperty(B[u])&&!y.hasOwnProperty(B[u])){s[B[u]]=new Ccc.Symbol(z.gensym(),B[u]);z.reserve(s[B[u]].id)}}}n[x].replaceSymbols(s);z.defineSyntax(t[x].id,n[x])}for(x in s){if(s.hasOwnProperty(x)){q.push(x)}}m=Ccc.Pair.fromArray(c(q,function(C){return s[C]}));p=Ccc.Pair.fromArray(c(q,function(C){return new Ccc.Symbol(C)}));A=c(o.body.datum.toArray(),function(C){return C.transform(z)});return(new Ccc.Pair(new Ccc.Pair(new Ccc.Symbol("lambda"),new Ccc.Pair(m,Ccc.Pair.fromArray(A))),p)).transform(v)})]));a("syntax-rules",b([d("...")],[e(j(j(l(d("identifiers"))),l(j(d("pattern"),d("template")))),function(n,m){var o=c(n.identifiers.datum.toArray(),function(p){return p});patterns=c(n.pattern.datum.toArray(),function(q){return Ccc.Pattern.fromObject(q.cdr)}),templates=c(n.template.datum.toArray(),function(p){return Ccc.Template.fromObject(p)}),rules=[],i;for(i=0;i<patterns.length;i+=1){rules[i]=new Ccc.SyntaxRule(patterns[i],templates[i])}return new Ccc.TransformerSpec(o,rules)})]));a("define",b([],[e(j(j(d("v"),l(d("formals"))),l(d("body"))),function(o,n){var p=c(o.formals.datum.toArray(),function(q){return q});var m=c(o.body.datum.toArray(),function(q){return q.transform(n)});return new Ccc.Pair(d("define"),new Ccc.Pair(o.v,new Ccc.Pair(new Ccc.Pair(d("lambda"),new Ccc.Pair(Ccc.Pair.fromArray(p),Ccc.Pair.fromArray(m))),Ccc.Nil)))}),e(j(g(d("v"),d("formal")),l(d("body"))),function(p,o){var n=p.formal;var m=c(p.body.datum.toArray(),function(q){return q.transform(o)});return new Ccc.Pair(d("define"),new Ccc.Pair(p.v,new Ccc.Pair(new Ccc.Pair(d("lambda"),new Ccc.Pair(n,Ccc.Pair.fromArray(m))),Ccc.Nil)))}),e(j(d("v"),d("e")),function(n,m){return new Ccc.Define(n.v,n.e.transform(m))}),]));a("internal-lambda",b([],[e(j(d("formals"),l(d("body"))),function(p,n){var s=p.formals,t=s,q=[],r=Ccc.Nil;n=n.clone();if(t instanceof Ccc.Symbol){n.reserve(t.id);r=t}else{if(t instanceof Ccc.Pair){do{if(t.car instanceof Ccc.Symbol){q.push(t.car);n.reserve(t.car.id)}else{throw new Error("Invalid formals spec in lambda: "+s)}t=t.cdr}while(t instanceof Ccc.Pair);if(t instanceof Ccc.Symbol){r=t;n.reserve(t)}else{if(t!==Ccc.Nil){throw new Error("Invalid formals spec in lambda: "+s)}}}else{if(t!==Ccc.Nil){throw new Error("Invalid formals spec in lambda: "+s)}}}var m=c(p.body.datum.toArray(),function(o){return o.transform(n)});return(new Ccc.Lambda(q,r,Ccc.Pair.fromArray(m))).transform(n)})]));a("if",b([],[e(j(d("test"),d("consequent"),d("alternate")),function(n,m){var q=n.test.transform(m);var o=n.consequent.transform(m);var p=n.alternate.transform(m);return new Ccc.If(q,o,p)}),e(j(d("test"),d("consequent")),function(n,m){var p=n.test.transform(m);var o=n.consequent.transform(m);return new Ccc.If(p,o,Ccc.Unspecified)})]));a("set!",b([],[e(j(d("symbol"),d("expr")),function(n,m){return new Ccc.Assignment(n.symbol,n.expr.transform(m))})]));var k='(define-syntax begin (syntax-rules () ((_ expr ...) ((lambda () expr ...))))) (define-syntax lambda (syntax-rules (define) ((_ "with-defs" formals defs (define v e) body ...) (lambda "with-defs" formals (defs . (v e)) body ...)) ((_ "with-defs" formals defs (define (v . a) e ...) body ...) (lambda "with-defs" formals (defs . (v (lambda a e ...))) body ...)) ((_ "with-defs" formals ((v e) ...) body ...) (lambda formals (letrec ((v e) ...) body ...))) ((_ formals body ...) (internal-lambda formals body ...)))) (define-syntax do (syntax-rules () ((_ ((var init . step) ...) end-clause . commands) (let loop ((var init) ...) (cond end-clause (else (begin #f . commands) (loop (begin var . step) ...))))))) (define-syntax letrec (syntax-rules () ((_ ((var init) ...) . body) (let ((var \'undefined) ...) (let ((var (let ((temp init)) (lambda () (set! var temp)))) ... (bod (lambda () . body))) (var) ... (bod)))))) (define-syntax let (syntax-rules () ((let ((name val) ...) body1 body2 ...) ((lambda (name ...) body1 body2 ...) val ...)) ((let tag ((name val) ...) body1 body2 ...) ((letrec ((tag (lambda (name ...) body1 body2 ...))) tag) val ...)))) (define-syntax let* (syntax-rules () ((let* () body1 body2 ...) (let () body1 body2 ...)) ((let* ((name1 val1) (name2 val2) ...) body1 body2 ...) (let ((name1 val1)) (let* ((name2 val2) ...) body1 body2 ...))))) (define-syntax case (syntax-rules (else) ((_ (x . y) . clauses) (let ((key (x . y))) (case key . clauses))) ((_ key (else . exps)) (begin #f . exps)) ((_ key (atoms . exps) . clauses) (if (memv key \'atoms) (begin . exps) (case key . clauses))) ((_ key) #!unspecific))) (define-syntax cond (syntax-rules (else =>) ((_) #f) ((_ (else . exps)) (begin #f . exps)) ((_ (x) . rest) (or x (cond . rest))) ((_ (x => proc) . rest) (let ((tmp x)) (cond (tmp (proc tmp)) . rest))) ((_ (x . exps) . rest) (if x (begin . exps) (cond . rest))))) (define-syntax and (syntax-rules () ((_) #t) ((_ test) test) ((_ test . tests) (if test (and . tests) #f)))) (define-syntax or (syntax-rules () ((_) #f) ((_ test) test) ((_ test . tests) (let ((x test)) (if x x (or . tests)))))) (define-syntax quasiquote (syntax-rules (unquote unquote-splicing quasiquote) (`,x x) (`(,@x . y) (append x `y)) ((_ `x . d) (cons \'quasiquote (quasiquote (x) d))) ((_ ,x d) (cons \'unquote (quasiquote (x) . d))) ((_ ,@x d) (cons \'unquote-splicing (quasiquote (x) . d))) ((_ (x . y) . d) (cons (quasiquote x . d) (quasiquote y . d))) ((_ #(x ...) . d) (list->vector (quasiquote (x ...) . d))) ((_ x . d) \'x))) (define-syntax force (syntax-rules () ((_ promise) (promise)))) (define-syntax delay (syntax-rules () ((_ expr) ((lambda (proc) (let ((result-ready? #f) (result #f)) (lambda () (if result-ready? result (let ((x (proc))) (if result-ready? result (begin (set! result-ready? #t) (set! result x) result))))))) (lambda () expr))))) ';var f=Ccc.Parser.parse(k);f.transform(h)}());