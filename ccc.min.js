ccc={};ccc.lib={};ccc.PrimitiveTransformers={};ccc.Object=function(){};ccc.Object.prototype.toSource=function(){return this.toString()};ccc.Object.prototype.compile=function(a){return this};ccc.Object.prototype.eval=function(b,a){return function(){return a(this)}.bind(this)};ccc.Object.prototype.eq=function(a){return this===a};ccc.Object.prototype.eqv=function(a){return this.eq(a)};ccc.Object.prototype.equal=function(a){return this.eqv(a)};ccc.Unspecified=function(){};ccc.Unspecified.prototype={__proto__:ccc.Object.prototype};ccc.Unspecified.prototype.constructor=ccc.Unspecified;ccc.Unspecified.prototype.toString=function(){return"#<unspecified>"};ccc.Unspecified.prototype.toSource=function(){return"#?"};ccc.unspecified=new ccc.Unspecified();ccc.Nil=function(){};ccc.Nil.prototype={__proto__:ccc.Object.prototype};ccc.Nil.prototype.constructor=ccc.Nil;ccc.Nil.prototype.toString=function(){return"#<nil>"};ccc.Nil.prototype.toSource=function(){return"()"};ccc.Nil.prototype.toArray=function(){return[]};ccc.nil=new ccc.Nil();ccc.Bool=function(a){this.value_=!!a};ccc.Bool.prototype={__proto__:ccc.Object.prototype};ccc.Bool.prototype.constructor=ccc.Bool;ccc.Bool.prototype.toString=function(){return"#<bool:"+this.value_.toString()+">"};ccc.Bool.prototype.toSource=function(){return this.value_?"#t":"#f"};ccc.t=new ccc.Bool(true);ccc.f=new ccc.Bool(false);ccc.Number=function(a){this.value_=a};ccc.Number.prototype={__proto__:ccc.Object.prototype};ccc.Number.prototype.constructor=ccc.Number;ccc.Number.prototype.toString=function(){return this.value_.toString()};ccc.Number.prototype.eq=function(a){return this.value_===a.value_};ccc.Char=function(a){this.charCode_=a};ccc.Char.prototype={__proto__:ccc.Object.prototype};ccc.Char.prototype.constructor=ccc.Char;ccc.Char.prototype.toString=function(){var a=this.charCode_.toString(16);return"#<char:"+"0000".substr(a.length)+a+">"};ccc.Char.prototype.toSource=function(){var a=this.charCode_.toString(16);return"#\\u"+"0000".substr(a.length)+a};ccc.Char.prototype.eq=function(a){return this.charCode_===a.charCode_};ccc.String=function(a){this.value_=a};ccc.String.prototype={__proto__:ccc.Object.prototype};ccc.String.prototype.constructor=ccc.String;ccc.String.prototype.sanitizedValue_=function(){return this.value_.replace("\n","\\n")};ccc.String.prototype.toString=function(){return'"'+this.sanitizedValue_()+'"'};ccc.String.prototype.eq=function(a){return this.value_===a.value_};ccc.Symbol=function(a){this.name=a};ccc.Symbol.prototype={__proto__:ccc.Object.prototype};ccc.Symbol.prototype.constructor=ccc.Symbol;ccc.Symbol.prototype.toString=function(){if(this.name.match(/[ \t\n\r\f\v()[\]\|;#"]/)){return"|"+this.name.replace("|","\\|").replace("\n","\\n")+"|"}return this.name};ccc.Symbol.prototype.compile=function(a){var b=a.lookup(this.name);if(b){return b}return new ccc.GlobalBinding(this.name)};ccc.Symbol.prototype.eq=function(a){return this.name===a.name};ccc.Pair=function(a,b){this.car_=a;this.cdr_=b};ccc.Pair.prototype={__proto__:ccc.Object.prototype};ccc.Pair.prototype.constructor=ccc.Pair;ccc.Pair.prototype.toString=function(){return"#<pair:"+this.car_.toString()+" . "+this.cdr_.toString()+">"};ccc.Pair.prototype.toSource=function(){return"("+this.sourcify_()+")"};ccc.Pair.prototype.sourcify_=function(){var a=this.car_.toSource();if(this.cdr_.constructor===ccc.Pair){a+=" "+this.cdr_.sourcify_()}else{if(this.cdr_!==ccc.nil){a+=" . "+this.cdr_.toSource()}}return a};ccc.Pair.makeList=function(){var b=ccc.nil;for(var a=arguments.length-1;a>=0;--a){b=new ccc.Pair(arguments[a],b)}return b};ccc.Pair.makeImproperList=function(a,b){var d=b;for(var c=a.length-1;c>=0;--c){d=new ccc.Pair(a[c],d)}return d};ccc.Pair.prototype.toArray=function(){var b=[];var a=this;while(a.constructor===ccc.Pair){b.push(a.car_);a=a.cdr_}if(a!==ccc.nil){throw new Error("Cannot convert improper list to an array")}return b};ccc.Pair.prototype.isList=function(){var a=this;while(a.constructor===ccc.Pair){a=a.cdr_}if(a===ccc.nil){return true}return false};ccc.Pair.prototype.forEach=function(b,a){var c=this;while(c.constructor===ccc.Pair){b(c.car_,c);c=c.cdr_}if(c.constructor!==ccc.Nil&&a){a(c)}};ccc.Pair.prototype.car=function(){return this.car_};ccc.Pair.prototype.cdr=function(){return this.cdr_};ccc.Pair.prototype.withCar=function(a){return new ccc.Pair(a,this.cdr_)};ccc.Pair.prototype.compileElements_=function(a){var b=this.car_.compile(a);if(this.cdr_.constructor===ccc.Pair){return new ccc.Pair(b,this.cdr_.compileElements_(a))}return new ccc.Pair(b,this.cdr_.compile(a))};ccc.Pair.prototype.compile=function(b){if(this.car_.constructor===ccc.Symbol&&!b.lookup(this.car_.name)){var a=b.lookupSyntax(this.car_.name);if(a){var c=a.transform(b,this);return c.compile(b)}}return this.compileElements_(b)};ccc.Pair.prototype.eval=function(environment,continuation){return function(){return this.car_.eval(environment,function(callee){if(!callee.apply){throw new Error("Object "+this.car_.toString()+" is not applicable")}var argsForm=this.cdr_;var argEvaluator=function(argsRemaining,args){if(argsRemaining===ccc.nil){var argsList=ccc.Pair.makeList.apply(null,args);return callee.apply(environment,continuation,argsList)}if(argsRemaining.constructor!==ccc.Pair){throw new Error("Invalid argument list: "+argsForm.toSource())}var head=argsRemaining.car_;return head.eval(environment,function(value){return argEvaluator(argsRemaining.cdr_,args.concat(value))})};return argEvaluator(argsForm,[])}.bind(this))}.bind(this)};ccc.Pair.prototype.equal=function(d){var e=this,c=d;while(e.constructor===ccc.Pair&&c.constructor===ccc.Pair){if(e.constructor!==c.constructor||!e.car_.equal(c.car_)){return false}e=e.cdr_;c=c.cdr_}if(e.constructor!==c.constructor||!e.equal(c)){return false}return true};ccc.Vector=function(a){this.elements_=a};ccc.Vector.prototype={__proto__:ccc.Object.prototype};ccc.Vector.prototype.constructor=ccc.Vector;ccc.Vector.prototype.toString=function(){return"#<vector:"+this.elements_.toString()+">"};ccc.Vector.prototype.toSource=function(){return"#("+this.elements_.map(function(a){return a.toSource()}).join(" ")+")"};ccc.Vector.prototype.equal=function(a){if(this.elements_.length!==a.elements_.length){return false}for(var b=0;b<this.elements_.length;++b){if(!this.elements_[b].equal(a.elements_[b])){return false}}return true};ccc.Environment=function(a){this.syntaxBindings_={};this.globalBindings_={};this.lexicalBindings_={};this.localBindings_={};if(a){this.parent_=a;this.nextLocal_=a.nextLocal_;this.topLevel_=false}else{this.initToplevel_();this.nextLocal_=0;this.topLevel_=true}};ccc.Environment.prototype={__proto__:ccc.Object.prototype};ccc.Environment.prototype.constructor=ccc.Environment;ccc.Environment.prototype.toString=function(){return"#<environment>"};ccc.Environment.prototype.isTopLevel=function(){return this.topLevel_};ccc.Environment.prototype.initToplevel_=function(){var b=ccc.PrimitiveTransformers;for(var a in b){if(b.hasOwnProperty(a)){this.bindSyntax(a,b[a])}}};ccc.Environment.prototype.lookupSyntax=function(a){if(this.syntaxBindings_.hasOwnProperty(a)){return this.syntaxBindings_[a]}if(this.parent_){return this.parent_.lookupSyntax(a)}return null};ccc.Environment.prototype.lookup=function(a){if(this.lexicalBindings_.hasOwnProperty(a)){return this.lexicalBindings_[a]}if(this.globalBindings_.hasOwnProperty(a)){return this.globalBindings_[a]}if(this.parent_){return this.parent_.lookup(a)}return null};ccc.Environment.prototype.lookupLocal=function(a){if(this.localBindings_.hasOwnProperty(a)){return this.localBindings_[a]}if(this.parent_){return this.parent_.lookupLocal(a)}return null};ccc.Environment.prototype.bindSyntax=function(b,a){this.syntaxBindings_[b]=a;return a};ccc.Environment.prototype.bindGlobal=function(b,c){var a=new ccc.Location(b,c);this.globalBindings_[b]=a;return a};ccc.Environment.prototype.bindLexical=function(a){var b=new ccc.LexicalBinding(a,++this.nextLocal_);this.lexicalBindings_[a]=b;return b};ccc.Environment.prototype.bindLocal=function(b,a){this.localBindings_[b.id_]=new ccc.Location(b.name_,a)};ccc.Environment.prototype.importLibrary=function(b,d){if(d===undefined){d=""}else{d=d+":"}var a=b.entries();for(var c in a){if(a.hasOwnProperty(c)){this.bindGlobal(d+c,a[c])}}};ccc.Environment.prototype.evalForm=function(form,opt_receiver){var compiledForm=form.compile(this);var terminate=function(value){if(opt_receiver){opt_receiver(value)}};var continuation=compiledForm.eval(this,terminate);var timeslice=function(){var cyclesPerSlice=1000;while(cyclesPerSlice-->0&&continuation){continuation=continuation()}if(continuation){setTimeout(timeslice,0)}};timeslice()};ccc.Environment.prototype.evalProgram=function(b,c){if(b.length===0){throw new Error("Empty program?")}b=b.slice();var a=function(){var d=b.shift();this.evalForm(d,function(e){if(c){c(e,false)}if(b.length>0){a()}else{if(c){c(e,true)}}})}.bind(this);a()};ccc.Location=function(a,b){this.name_=a;this.value_=b||ccc.unspecified};ccc.Location.prototype={__proto__:ccc.Object.prototype};ccc.Location.prototype.constructor=ccc.Location;ccc.Location.prototype.toString=function(){return"#<location:"+this.name_+">"};ccc.Location.prototype.eval=function(b,a){return function(){return a(this.value_)}.bind(this)};ccc.GlobalBinding=function(a){this.name_=a};ccc.GlobalBinding.prototype={__proto__:ccc.Object.prototype};ccc.GlobalBinding.prototype.constructor=ccc.GlobalBinding;ccc.GlobalBinding.prototype.toString=function(){return"#<global-binding:"+this.name_+">"};ccc.GlobalBinding.prototype.eval=function(b,a){return function(){var c=b.lookup(this.name_);if(!c){throw new Error("Unbound variable: "+this.name_)}return a(c.value_)}.bind(this)};ccc.LexicalBinding=function(a,b){this.name_=a;this.id_=b};ccc.LexicalBinding.prototype={__proto__:ccc.Object.prototype};ccc.LexicalBinding.prototype.constructor=ccc.LexicalBinding;ccc.LexicalBinding.prototype.toString=function(){return"#<binding:"+this.name_+">"};ccc.LexicalBinding.prototype.eval=function(b,a){return function(){return a(b.lookupLocal(this.id_).value_)}.bind(this)};ccc.NativeFunction=function(b,a){this.fn_=b;this.name_=a||"(anonymous)"};ccc.NativeFunction.prototype={__proto__:ccc.Object.prototype};ccc.NativeFunction.prototype.constructor=ccc.NativeFunction;ccc.NativeFunction.prototype.toString=function(){return"#<native-function:"+this.name_+">"};ccc.NativeFunction.prototype.apply=function(b,a,c){return this.fn_(b,a,c)};ccc.Closure=function(a,b,d,c){this.capturedEnvironment_=a;this.compiledBody_=b;this.namedArgBindings_=d;this.argsTailBinding_=c};ccc.Closure.prototype={__proto__:ccc.Object.prototype};ccc.Closure.prototype.constructor=ccc.Closure;ccc.Closure.prototype.toString=function(){return"#<closure>"};ccc.Closure.prototype.apply=function(environment,continuation,args){var callEnvironment=new ccc.Environment(this.capturedEnvironment_);for(var i=0;i<this.namedArgBindings_.length;++i){if(args.constructor!==ccc.Pair){throw new Error("Too few arguments applied to closure")}callEnvironment.bindLocal(this.namedArgBindings_[i],args.car());args=args.cdr()}if(args!==ccc.nil&&this.argsTailBinding_===ccc.nil){throw new Error("Too many arguments applied to closure")}if(this.argsTailBinding_!==ccc.nil){callEnvironment.bindLocal(this.argsTailBinding_,args)}var evalForms=function(forms){if(forms.length===1){return forms[0].eval(callEnvironment,continuation)}return forms[0].eval(callEnvironment,function(){return evalForms(forms.slice(1))})};return evalForms(this.compiledBody_.slice())};ccc.Continuation=function(a){this.fn_=a};ccc.Continuation.prototype={__proto__:ccc.Object.prototype};ccc.Continuation.prototype.constructor=ccc.Continuation;ccc.Continuation.prototype.toString=function(){return"#<continuation>"};ccc.Continuation.prototype.apply=function(b,a,c){if(c===ccc.nil||c.cdr()!==ccc.nil){throw new Error("Wrong number of args given to continuation")}return function(){return this.fn_(c.car())}.bind(this)};ccc.Transformer=function(a){this.transform_=a};ccc.Transformer.prototype={__proto__:ccc.Object.prototype};ccc.Transformer.prototype.constructor=ccc.Transformer;ccc.Transformer.prototype.toString=function(){return"#<transformer>"};ccc.Transformer.prototype.transform=function(a,b){return this.transform_(a,b)};ccc.Library=function(a){this.name_=a;this.entries_={}};ccc.Library.prototype={__proto__:ccc.Object.prototype};ccc.Library.prototype.constructor=ccc.Library;ccc.Library.prototype.name=function(){return this.name_};ccc.Library.prototype.entries=function(){return this.entries_};ccc.Library.prototype.addNativeFunction=function(a,b){this.entries_[a]=new ccc.NativeFunction(b,this.name_+":"+a)};ccc.Library.prototype.addSimpleFunction=function(a,b){this.entries_[a]=new ccc.NativeFunction(function(e,d,f){f=f.toArray();if(b.length>0&&f.length!==b.length){throw new Error(a+": Wrong number of arguments. Expected "+b.length+"; received "+f.length)}var c=b.apply(null,f);if(c===undefined){c=ccc.unspecified}return d(c)},this.name_+":"+a)};ccc.Library.prototype.addSimpleFunctions=function(a){for(var b in a){if(a.hasOwnProperty(b)){this.addSimpleFunction(b,a[b])}}};(function(){var b={ANY:function(){return true},BOOLEAN:function(c){return c.constructor===ccc.Boolean},INTEGER:function(c){return c.constructor===ccc.Number&&(c.value_|0)===c.value_},NUMBER:function(c){return c.constructor===ccc.Number},CHAR:function(c){return c.constructor===ccc.Char},STRING:function(c){return c.constructor===ccc.String},SYMBOL:function(c){return c.constructor===ccc.Symbol},VECTOR:function(c){return c.constructor===ccc.Vector},PAIR:function(c){return c.constructor===ccc.Pair},PAIR_OR_NIL:function(c){return c===ccc.nil||c.constructor===ccc.Pair},LIST:function(c){return c===ccc.nil||(c.constructor===ccc.Pair&&c.isList())},PROCEDURE:function(c){return c.apply instanceof Function},};var a=function(c){if(!c){return[]}if(c instanceof Array){return c.map(function(d){return d.toUpperCase()})}return c.toUpperCase()};ccc.Library.prototype.registerEntries=function(c){c.forEach(ccc.Library.prototype.registerEntry.bind(this))};ccc.Library.prototype.registerEntry=function(d){var c=d.name;d.requiredArgs=a(d.requiredArgs);d.optionalArgs=a(d.optionalArgs);this.addNativeFunction(c,function(f,g,j){var i=j;var l=[];d.requiredArgs.forEach(function(p,o){if(i.constructor!==ccc.Pair){throw new Error(c+": Not enough arguments")}var q=i.car();var n=b[p];if(!n(q)){throw new Error(c+": Wrong type for argument "+o)}l.push(q);i=i.cdr()});if(d.optionalArgs instanceof Array){d.optionalArgs.forEach(function(o){if(i.constructor!==ccc.Pair){l.push(ccc.unspecified)}else{var p=i.car();var n=b[o];if(!n(p)){throw new Error(c+": Wrong type for argument "+l.length)}l.push(p);i=i.cdr()}})}else{l.push(i);if(i!==ccc.nil&&d.optionalArgs!=="ANY"){var h=l.length;var e=b[d.optionalArgs];i.forEach(function(n){if(!e(n)){throw new Error(c+": Wrong type for argument "+h)}h+=1})}i=ccc.nil}if(i!==ccc.nil){throw new Error(c+": Too many arguments")}var k={environment:f,continuation:g};var m=d.impl.apply(k,l);if(d.customContinuation){return m}if(m===undefined){m=ccc.unspecified}return g(m)})}}());ccc.PrimitiveTransformers.quote=new ccc.Transformer(function(a,c){c=c.cdr();if(c.constructor!==ccc.Pair){throw new Error("quote: Bad form")}if(c.cdr()!==ccc.nil){throw new Error("quote: Bad form")}var b=c.car();return new ccc.Pair(new ccc.NativeFunction(function(e,d,f){return function(){return d(b)}},"quote"),ccc.nil)});ccc.PrimitiveTransformers.define=new ccc.Transformer(function(b,e){e=e.cdr();if(e.constructor!==ccc.Pair){throw new Error("define: Bad form")}var f=e.car();if(f.constructor===ccc.Pair){var c=f.cdr();var a=e.cdr();f=f.car();return ccc.Pair.makeList(new ccc.Symbol("define"),f,new ccc.Pair(new ccc.Symbol("lambda"),new ccc.Pair(c,a)))}if(f.constructor!==ccc.Symbol){throw new Error("define: Bad form")}var d=e.cdr();if(d.constructor!==ccc.Pair){throw new Error("define: Bad form")}if(d.cdr()!==ccc.nil){throw new Error("define: Bad form")}return e.withCar(new ccc.NativeFunction(function(h,g,i){return function(){var j=h.lookup(f.name);if(!j||j.constructor!==ccc.Location){h.bindGlobal(f.name,i.car())}else{j.value_=i.car()}return g(ccc.unspecified)}},"bind-variable"))});ccc.PrimitiveTransformers["set!"]=new ccc.Transformer(function(a,c){c=c.cdr();if(c.constructor!==ccc.Pair){throw new Error("set!: Bad form")}var d=c.car();if(d.constructor!==ccc.Symbol){throw new Error("set!: Bad form")}var b=c.cdr();if(b.constructor!==ccc.Pair){throw new Error("set!: Bad form")}if(b.cdr()!==ccc.nil){throw new Error("set!: Bad form")}var e=d.compile(a);return c.withCar(new ccc.NativeFunction(function(g,f,h){return function(){var i=e;if(e.constructor===ccc.LexicalBinding){i=g.lookupLocal(e.id_)}else{if(e.constructor===ccc.GlobalBinding){i=g.lookup(e.name_)}}if(!i){throw new Error("Unbound variable: "+d.name)}i.value_=h.car();return f(ccc.unspecified)}},"set-variable"))});ccc.PrimitiveTransformers["if"]=new ccc.Transformer(function(environment,form){form=form.cdr();if(form.constructor!==ccc.Pair){throw new Error("if: Bad form")}var condition=form.car();var consequent=form.cdr();if(consequent===ccc.nil||consequent.constructor!==ccc.Pair){throw new Error("if: Bad form")}var alternate=consequent.cdr();consequent=consequent.car();if(alternate===ccc.nil){alternate=ccc.unspecified}else{if(alternate.constructor===ccc.Pair){if(alternate.cdr()!==ccc.nil){throw new Error("if: Bad form")}alternate=alternate.car()}else{throw new Error("if: Bad form")}}condition=condition.compile(environment);consequent=consequent.compile(environment);alternate=alternate.compile(environment);return new ccc.Pair(new ccc.NativeFunction(function(environment,continuation,args){return function(){return condition.eval(environment,function(value){if(value!==ccc.f){return consequent.eval(environment,continuation)}return alternate.eval(environment,continuation)})}},"if"),ccc.nil)});ccc.PrimitiveTransformers["\u03bb"]=ccc.PrimitiveTransformers.lambda=new ccc.Transformer(function(d,a){a=a.cdr();if(a.constructor!==ccc.Pair){throw new Error("lambda: Bad form")}var h=a.car();var f=a.cdr();if(f.constructor!==ccc.Pair){throw new Error("lambda: Bad form")}var c=new ccc.Environment(d);var b=[];var e=ccc.nil;if(h.constructor===ccc.Symbol){e=c.bindLexical(h.name)}else{if(h.constructor===ccc.Pair){var j=function(k){if(k.constructor!==ccc.Symbol){throw new Error("lambda: Bad form")}b.push(c.bindLexical(k.name))};var g=function(k){if(k.constructor!==ccc.Symbol){throw new Error("lambda: Bad form")}e=c.bindLexical(k.name)};h.forEach(j,g)}else{if(h!==ccc.nil){throw new Error("lambda: Bad form")}}}var i=[];f.forEach(function(k){i.push(k.compile(c))},function(){throw new Error("lambda: Bad form")});return new ccc.Pair(new ccc.NativeFunction(function(l,k,m){return function(){return k(new ccc.Closure(l,i,b,e))}},"make-closure"),ccc.nil)});ccc.PrimitiveTransformers["define-syntax"]=new ccc.Transformer(function(b,e){var c=function(){throw new Error("define-syntax: Bad form")};if(!b.isTopLevel()){throw new Error("define-syntax: Invalid outside of top-level environment")}e=e.cdr();if(e.constructor!==ccc.Pair){c()}var f=e.car();if(f.constructor!==ccc.Symbol){c()}e=e.cdr();var d=e.car();if(e.cdr()!==ccc.nil){c()}var a=d.compile(b);if(a.constructor!==ccc.Transformer){c()}b.bindSyntax(f.name,a);return ccc.unspecified});ccc.PrimitiveTransformers["let-syntax"]=new ccc.Transformer(function(b,g){var e=function(){throw new Error("let-syntax: Bad form")};var d=function(i){if(i.constructor!==ccc.Pair){e()}};g=g.cdr();d(g);var h=g.car();d(h);var a=g.cdr();d(a);var c=new ccc.Environment(b);h.forEach(function(l){d(l);d(l.cdr());if(l.cdr().cdr()!==ccc.nil){e()}var k=l.car();if(k.constructor!==ccc.Symbol){e()}var j=l.cdr().car();d(j);var i=j.compile(b);if(i.constructor!==ccc.Transformer){e()}c.bindSyntax(k.name,i)},function(){e()});var f=[];a.forEach(function(i){f.push(i.compile(c))},function(){e()});return new ccc.Pair(new ccc.Pair(new ccc.NativeFunction(function(j,i,k){return function(){return i(new ccc.Closure(j,f,[],[]))}},"make-closure"),ccc.nil),ccc.nil)});ccc.PrimitiveTransformers["letrec-syntax"]=new ccc.Transformer(function(b,g){var e=function(){throw new Error("letrec-syntax: Bad form")};var d=function(i){if(i.constructor!==ccc.Pair){e()}};g=g.cdr();d(g);var h=g.car();d(h);var a=g.cdr();d(a);var c=new ccc.Environment(b);h.forEach(function(l){d(l);d(l.cdr());if(l.cdr().cdr()!==ccc.nil){e()}var k=l.car();if(k.constructor!==ccc.Symbol){e()}var j=l.cdr().car();d(j);var i=j.compile(c);if(i.constructor!==ccc.Transformer){e()}c.bindSyntax(k.name,i)},function(){e()});var f=[];a.forEach(function(i){f.push(i.compile(c))},function(){e()});return new ccc.Pair(new ccc.Pair(new ccc.NativeFunction(function(j,i,k){return function(){return i(new ccc.Closure(j,f,[],[]))}},"make-closure"),ccc.nil),ccc.nil)});(function(){ccc.PrimitiveTransformers["syntax-rules"]=new ccc.Transformer(function(c,g){var f=function(){throw new Error("syntax-rules: Bad form")};var e=function(k){if(k.constructor!==ccc.Pair){f()}};g=g.cdr();e(g);var d=g.car();if(d!==ccc.nil&&d.constructor!==ccc.Pair){f()}var h=[];if(d!==ccc.nil){d.forEach(function(k){if(k.constructor!==ccc.Symbol){f()}if(k.name==="..."){f()}h.push(k)},f)}var j=[];var i=g.cdr();e(i);i.forEach(function(m){e(m);var l=m.car();e(l);m=m.cdr();if(m===ccc.nil){f()}if(m.cdr()!==ccc.nil){f()}l=b(l);var k=a(m.car(),l);j.push({pattern:l,template:k})},f);return new ccc.Transformer(function(k,l){return ccc.nil})});var b=function(c){return c};var a=function(c,d){console.log("PATTERN "+d.toSource()+" -> "+c.toSource())}}());ccc.PrimitiveTransformers["native-apply"]=new ccc.Transformer(function(a,c){c=c.cdr();if(c.constructor!==ccc.Pair){throw new Error("native-apply: Bad form")}var b=c.car();return c.withCar(new ccc.NativeFunction(function(e,d,f){f=f.toArray();return function(){var h=ccc.libutil.resolveNativeName(b);f=f.map(ccc.libutil.objectToNativeValue);var g=ccc.libutil.objectFromNativeValue(h.value.apply(h.object,f));return d(g)}},"native-apply"))});ccc.Parser=(function(){function c(f,d){function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e()}function a(g,h,i,e,f){function d(l,m){function j(o){function p(q){return q.charCodeAt(0).toString(16).toUpperCase()}return o.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(q){return"\\x0"+p(q)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(q){return"\\x"+p(q)}).replace(/[\u0180-\u0FFF]/g,function(q){return"\\u0"+p(q)}).replace(/[\u1080-\uFFFF]/g,function(q){return"\\u"+p(q)})}var n,k;switch(l.length){case 0:n="end of input";break;case 1:n=l[0];break;default:n=l.slice(0,-1).join(", ")+" or "+l[l.length-1]}k=m?'"'+j(m)+'"':"end of input";return"Expected "+n+" but "+k+" found."}this.expected=g;this.found=h;this.offset=i;this.line=e;this.column=f;this.name="SyntaxError";this.message=d(g,h)}c(a,Error);function b(bg){var bZ=arguments.length>1?arguments[1]:{},s={start:cn,datum:o},bV=cn,aB=null,aA=function(cK){return cK},az=/^[ \t\f\r\n\x0B\xA0\u2000-\u200B\u2028\u2029\u202F\u3000]/,ay="[ \\t\\f\\r\\n\\x0B\\xA0\\u2000-\\u200B\\u2028\\u2029\\u202F\\u3000]",ax=[],av=function(){return""},au="",at=/^[ "\t\f\r\n();[\]|]/,ar='[ "\\t\\f\\r\\n();[\\]|]',aq="any character",cl=";",ck='";"',ci=/^[^\n\r]/,ch="[^\\n\\r]",cg=/^[\n\r]/,cf="[\\n\\r]",ce="#;",cd='"#;"',cc=function(cL,cK){return new ccc.Symbol(cL+cK.join(""))},cb=function(cK){return new ccc.Symbol(cK)},b9=/^[!$%&*\/:<=>?\^_~a-z0-9]/i,b7="[!$%&*\\/:<=>?\\^_~a-z0-9]i",b6=/^[\x80-\uFFFF]/,b5="[\\x80-\\uFFFF]",b4=function(cK){return cK},b3=/^[0-9]/,b2="[0-9]",b1=/^[0-9a-f]/i,b0="[0-9a-f]i",bY="+",bW='"+"',bU="-",bS='"-"',bQ=".",bP='"."',bO="@",bN='"@"',bM="...",bK='"..."',bJ="#t",bF='"#t"',bE=function(){return ccc.t},bD="#f",bC='"#f"',bB=function(){return ccc.f},bA="#\\space",bz='"#\\\\space"',by=function(){return new ccc.Char(32)},bx="#\\newline",bw='"#\\\\newline"',bs=function(){return new ccc.Char(10)},br="#\\x",bp='"#\\\\x"',bo=function(cL,cK){return new ccc.Char(parseInt(cL+cK,16))},bm="#\\u",bl='"#\\\\u"',bk=function(cL,cK,cN,cM){return new ccc.Char(parseInt(cL+cK+cN+cM,16))},bj="#\\",bi='"#\\\\"',bh=function(cK){return new ccc.Char(cK.charCodeAt(0))},bb='"',ba='"\\""',a9=function(cK){return new ccc.String(cK.join(""))},a8="\\\\",a7='"\\\\\\\\"',a6=function(){return"\\"},a5="\\n",a4='"\\\\n"',a3=function(){return"\n"},a2="\\t",aY='"\\\\t"',aX=function(){return"\t"},aW="\\f",aV='"\\\\f"',aU=function(){return"\f"},aT="\\r",aS='"\\\\r"',aR=function(){return"\r"},aQ="\\'",aO='"\\\\\'"',ap=function(){return"'"},ao='\\"',an='"\\\\\\""',am=function(){return'"'},al="\\x",ak='"\\\\x"',ai=function(cL,cK){return String.fromCharCode(parseInt(cL+cK,16))},ag="\\u",af='"\\\\u"',ae=function(cL,cK,cN,cM){return String.fromCharCode(parseInt(cL+cK+cN+cM,16))},O=/^[^"\\]/,N='[^"\\\\]',M="|",L='"|"',K=function(cK){return new ccc.Symbol(cK.join(""))},J=/^[^|\\]/,H="[^|\\\\]",G="\\|",F='"\\\\|"',D=function(){return"|"},aM="(",aL='"("',aK=")",aI='")"',aH=function(){return ccc.nil},aG="[",aF='"["',aE="]",aD='"]"',aC="#?",ad='"#?"',ac=function(){return ccc.unspecified},ab="#b",aa='"#b"',Z=/^[\-+]/,Y="[\\-+]",X=/^[01]/,U="[01]",T=function(cK,cL){return new ccc.Number(parseInt(cK+cL.join(""),2))},R="#o",C='"#o"',B=/^[0-7]/,A="[0-7]",z=function(cK,cL){return new ccc.Number(parseInt(cK+cL.join(""),8))},y="#x",x='"#x"',w=function(cK,cL){return new ccc.Number(parseInt(cK+cL.join(""),16))},v=/^[eE]/,u="[eE]",t=function(cL,cK,cM){return cL+cK+cM.join("")},n="#d",l='"#d"',k=function(cK,cM,cL,cN){return new ccc.Number(parseFloat(cK+cM.join("")+"."+cL.join("")+cN))},j=function(cK,cL,cM){return new ccc.Number(parseFloat(cK+cL.join("")+cM))},h=function(cK){return ccc.Pair.makeList.apply(null,cK.map(function(cL){return cL[0]}))},g=function(cL,cK){return ccc.Pair.makeImproperList(cL.map(function(cM){return cM[0]}),cK)},f=",@",e='",@"',d=function(cK){return ccc.Pair.makeList(new ccc.Symbol("unquote-splicing"),cK)},cJ="'",cH='"\'"',cF=function(cK){return ccc.Pair.makeList(new ccc.Symbol("quote"),cK)},cE="`",cD='"`"',cB=function(cK){return ccc.Pair.makeList(new ccc.Symbol("quasiquote"),cK)},cA=",",cy='","',cw=function(cK){return ccc.Pair.makeList(new ccc.Symbol("unquote"),cK)},cv="#(",cu='"#("',cs=function(cK){return new ccc.Vector(cK.map(function(cL){return cL[0]}))},cr="#[",cq='"#["',cp=function(cK){return cK.map(function(cL){return cL[0]})},bv=0,cI=0,co=0,aw={line:1,column:1,seenCR:false},a0=0,a1=[],cm=0,bd;if("startRule" in bZ){if(!(bZ.startRule in s)){throw new Error("Can't start parsing from rule \""+bZ.startRule+'".')}bV=s[bZ.startRule]}function b8(){return bg.substring(cI,bv)}function ct(){return cI}function cj(){return I(cI).line}function cz(){return I(cI).column}function I(cL){function cK(cO,cN,cM){var cQ,cP;for(cQ=cN;cQ<cM;cQ++){cP=bg.charAt(cQ);if(cP==="\n"){if(!cO.seenCR){cO.line++}cO.column=1;cO.seenCR=false}else{if(cP==="\r"||cP==="\u2028"||cP==="\u2029"){cO.line++;cO.column=1;cO.seenCR=true}else{cO.column++;cO.seenCR=false}}}}if(co!==cL){if(co>cL){co=0;aw={line:1,column:1,seenCR:false}}cK(aw,co,cL);co=cL}return aw}function ca(cK){if(bv<a0){return}if(bv>a0){a0=bv;a1=[]}a1.push(cK)}function S(cL){var cK=0;cL.sort();while(cK<cL.length){if(cL[cK-1]===cL[cK]){cL.splice(cK,1)}else{cK++}}}function cn(){var cN,cM,cL,cK;cN=bv;cM=cC();if(cM!==null){cL=cG();if(cL!==null){cK=cC();if(cK!==null){cI=cN;cM=aA(cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}return cN}function ah(){var cK;if(az.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ay)}}return cK}function bH(){var cK;cK=ah();if(cK===null){cK=cx()}return cK}function cC(){var cM,cL,cK;cM=bv;cL=[];cK=bH();while(cK!==null){cL.push(cK);cK=bH()}if(cL!==null){cI=cM;cL=av()}if(cL===null){bv=cM;cM=cL}else{cM=cL}return cM}function W(){var cM,cL,cK;cM=bv;cL=bv;cm++;if(at.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ar)}}cm--;if(cK!==null){bv=cL;cL=au}else{cL=aB}if(cL!==null){cK=cC();if(cK!==null){cL=[cL,cK];cM=cL}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}if(cM===null){cM=bv;cm++;if(bg.length>bv){cL=bg.charAt(bv);bv++}else{cL=null;if(cm===0){ca(aq)}}cm--;if(cL===null){cM=au}else{bv=cM;cM=aB}}return cM}function cx(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===59){cM=cl;bv++}else{cM=null;if(cm===0){ca(ck)}}if(cM!==null){cL=[];if(ci.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ch)}}while(cK!==null){cL.push(cK);if(ci.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(ch)}}}if(cL!==null){if(cg.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(cf)}}if(cK===null){cK=au}if(cK!==null){cM=[cM,cL,cK];cN=cM}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.substr(bv,2)===ce){cM=ce;bv+=2}else{cM=null;if(cm===0){ca(cd)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cM=[cM,cL,cK];cN=cM}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}return cN}function bf(){var cN,cM,cL,cK;cN=bv;cM=V();if(cM!==null){cL=[];cK=i();while(cK!==null){cL.push(cK);cK=i()}if(cL!==null){cK=W();if(cK!==null){cI=cN;cM=cc(cM,cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;cM=bt();if(cM!==null){cL=W();if(cL!==null){cI=cN;cM=cb(cM);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bI()}}return cN}function V(){var cM,cL,cK;if(b9.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(b7)}}if(cM===null){cM=bv;cL=bv;cm++;cK=ah();cm--;if(cK===null){cL=au}else{bv=cL;cL=aB}if(cL!==null){if(b6.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(b5)}}if(cK!==null){cI=cM;cL=b4(cK);if(cL===null){bv=cM;cM=cL}else{cM=cL}}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}}return cM}function i(){var cK;cK=V();if(cK===null){cK=aZ();if(cK===null){cK=aJ()}}return cK}function aZ(){var cK;if(b3.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(b2)}}return cK}function bT(){var cK;if(b1.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(b0)}}return cK}function aJ(){var cK;if(bg.charCodeAt(bv)===43){cK=bY;bv++}else{cK=null;if(cm===0){ca(bW)}}if(cK===null){if(bg.charCodeAt(bv)===45){cK=bU;bv++}else{cK=null;if(cm===0){ca(bS)}}if(cK===null){if(bg.charCodeAt(bv)===46){cK=bQ;bv++}else{cK=null;if(cm===0){ca(bP)}}if(cK===null){if(bg.charCodeAt(bv)===64){cK=bO;bv++}else{cK=null;if(cm===0){ca(bN)}}}}}return cK}function bt(){var cK;if(bg.charCodeAt(bv)===43){cK=bY;bv++}else{cK=null;if(cm===0){ca(bW)}}if(cK===null){if(bg.charCodeAt(bv)===45){cK=bU;bv++}else{cK=null;if(cm===0){ca(bS)}}if(cK===null){if(bg.substr(bv,3)===bM){cK=bM;bv+=3}else{cK=null;if(cm===0){ca(bK)}}}}return cK}function aj(){var cM,cL,cK;cM=bv;if(bg.substr(bv,2).toLowerCase()===bJ){cL=bg.substr(bv,2);bv+=2}else{cL=null;if(cm===0){ca(bF)}}if(cL!==null){cK=W();if(cK!==null){cI=cM;cL=bE();if(cL===null){bv=cM;cM=cL}else{cM=cL}}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}if(cM===null){cM=bv;if(bg.substr(bv,2).toLowerCase()===bD){cL=bg.substr(bv,2);bv+=2}else{cL=null;if(cm===0){ca(bC)}}if(cL!==null){cK=W();if(cK!==null){cI=cM;cL=bB();if(cL===null){bv=cM;cM=cL}else{cM=cL}}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}}return cM}function Q(){var cP,cO,cN,cM,cL,cK,cQ;cP=bv;if(bg.substr(bv,7).toLowerCase()===bA){cO=bg.substr(bv,7);bv+=7}else{cO=null;if(cm===0){ca(bz)}}if(cO!==null){cN=W();if(cN!==null){cI=cP;cO=by();if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,9).toLowerCase()===bx){cO=bg.substr(bv,9);bv+=9}else{cO=null;if(cm===0){ca(bw)}}if(cO!==null){cN=W();if(cN!==null){cI=cP;cO=bs();if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,3).toLowerCase()===br){cO=bg.substr(bv,3);bv+=3}else{cO=null;if(cm===0){ca(bp)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cL=W();if(cL!==null){cI=cP;cO=bo(cN,cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,3).toLowerCase()===bm){cO=bg.substr(bv,3);bv+=3}else{cO=null;if(cm===0){ca(bl)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cL=bT();if(cL!==null){cK=bT();if(cK!==null){cQ=W();if(cQ!==null){cI=cP;cO=bk(cN,cM,cL,cK);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2)===bj){cO=bj;bv+=2}else{cO=null;if(cm===0){ca(bi)}}if(cO!==null){if(bg.length>bv){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(aq)}}if(cN!==null){cM=W();if(cM!==null){cI=cP;cO=bh(cN);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}}}}return cP}function bn(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===34){cM=bb;bv++}else{cM=null;if(cm===0){ca(ba)}}if(cM!==null){cL=[];cK=bR();while(cK!==null){cL.push(cK);cK=bR()}if(cL!==null){if(bg.charCodeAt(bv)===34){cK=bb;bv++}else{cK=null;if(cm===0){ca(ba)}}if(cK!==null){cI=cN;cM=a9(cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}return cN}function bX(){var cP,cO,cN,cM,cL,cK;cP=bv;if(bg.substr(bv,2)===a8){cO=a8;bv+=2}else{cO=null;if(cm===0){ca(a7)}}if(cO!==null){cI=cP;cO=a6()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===a5){cO=a5;bv+=2}else{cO=null;if(cm===0){ca(a4)}}if(cO!==null){cI=cP;cO=a3()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===a2){cO=a2;bv+=2}else{cO=null;if(cm===0){ca(aY)}}if(cO!==null){cI=cP;cO=aX()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===aW){cO=aW;bv+=2}else{cO=null;if(cm===0){ca(aV)}}if(cO!==null){cI=cP;cO=aU()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===aT){cO=aT;bv+=2}else{cO=null;if(cm===0){ca(aS)}}if(cO!==null){cI=cP;cO=aR()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===aQ){cO=aQ;bv+=2}else{cO=null;if(cm===0){ca(aO)}}if(cO!==null){cI=cP;cO=ap()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===ao){cO=ao;bv+=2}else{cO=null;if(cm===0){ca(an)}}if(cO!==null){cI=cP;cO=am()}if(cO===null){bv=cP;cP=cO}else{cP=cO}if(cP===null){cP=bv;if(bg.substr(bv,2)===al){cO=al;bv+=2}else{cO=null;if(cm===0){ca(ak)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cI=cP;cO=ai(cN,cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2)===ag){cO=ag;bv+=2}else{cO=null;if(cm===0){ca(af)}}if(cO!==null){cN=bT();if(cN!==null){cM=bT();if(cM!==null){cL=bT();if(cL!==null){cK=bT();if(cK!==null){cI=cP;cO=ae(cN,cM,cL,cK);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}}}}}}}}return cP}function bR(){var cK;if(O.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(N)}}if(cK===null){cK=bX()}return cK}function bI(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===124){cM=M;bv++}else{cM=null;if(cm===0){ca(L)}}if(cM!==null){cL=[];cK=bc();if(cK!==null){while(cK!==null){cL.push(cK);cK=bc()}}else{cL=aB}if(cL!==null){if(bg.charCodeAt(bv)===124){cK=M;bv++}else{cK=null;if(cm===0){ca(L)}}if(cK!==null){cI=cN;cM=K(cL);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}return cN}function bc(){var cL,cK;if(J.test(bg.charAt(bv))){cL=bg.charAt(bv);bv++}else{cL=null;if(cm===0){ca(H)}}if(cL===null){cL=bv;if(bg.substr(bv,2)===G){cK=G;bv+=2}else{cK=null;if(cm===0){ca(F)}}if(cK!==null){cI=cL;cK=D()}if(cK===null){bv=cL;cL=cK}else{cL=cK}if(cL===null){cL=bX()}}return cL}function aN(){var cN,cM,cL,cK;cN=bv;if(bg.charCodeAt(bv)===40){cM=aM;bv++}else{cM=null;if(cm===0){ca(aL)}}if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===41){cK=aK;bv++}else{cK=null;if(cm===0){ca(aI)}}if(cK!==null){cI=cN;cM=aH();if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===91){cM=aG;bv++}else{cM=null;if(cm===0){ca(aF)}}if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===93){cK=aE;bv++}else{cK=null;if(cm===0){ca(aD)}}if(cK!==null){cI=cN;cM=aH();if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}return cN}function be(){var cL,cK;cL=bv;if(bg.substr(bv,2)===aC){cK=aC;bv+=2}else{cK=null;if(cm===0){ca(ad)}}if(cK!==null){cI=cL;cK=ac()}if(cK===null){bv=cL;cL=cK}else{cL=cK}return cL}function P(){var cK;cK=q();if(cK===null){cK=m();if(cK===null){cK=p();if(cK===null){cK=r()}}}return cK}function q(){var cO,cN,cM,cL,cK;cO=bv;if(bg.substr(bv,2).toLowerCase()===ab){cN=bg.substr(bv,2);bv+=2}else{cN=null;if(cm===0){ca(aa)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];if(X.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(U)}}if(cK!==null){while(cK!==null){cL.push(cK);if(X.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(U)}}}}else{cL=aB}if(cL!==null){cK=W();if(cK!==null){cI=cO;cN=T(cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function m(){var cO,cN,cM,cL,cK;cO=bv;if(bg.substr(bv,2).toLowerCase()===R){cN=bg.substr(bv,2);bv+=2}else{cN=null;if(cm===0){ca(C)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];if(B.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(A)}}if(cK!==null){while(cK!==null){cL.push(cK);if(B.test(bg.charAt(bv))){cK=bg.charAt(bv);bv++}else{cK=null;if(cm===0){ca(A)}}}}else{cL=aB}if(cL!==null){cK=W();if(cK!==null){cI=cO;cN=z(cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function p(){var cO,cN,cM,cL,cK;cO=bv;if(bg.substr(bv,2).toLowerCase()===y){cN=bg.substr(bv,2);bv+=2}else{cN=null;if(cm===0){ca(x)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];cK=bT();if(cK!==null){while(cK!==null){cL.push(cK);cK=bT()}}else{cL=aB}if(cL!==null){cK=W();if(cK!==null){cI=cO;cN=w(cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function bq(){var cO,cN,cM,cL,cK;cO=bv;if(v.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(u)}}if(cN!==null){if(Z.test(bg.charAt(bv))){cM=bg.charAt(bv);bv++}else{cM=null;if(cm===0){ca(Y)}}if(cM===null){cM=au}if(cM!==null){cL=[];cK=aZ();if(cK!==null){while(cK!==null){cL.push(cK);cK=aZ()}}else{cL=aB}if(cL!==null){cI=cO;cN=t(cN,cM,cL);if(cN===null){bv=cO;cO=cN}else{cO=cN}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}return cO}function r(){var cP,cO,cN,cM,cL,cK,cR,cQ;cP=bv;if(bg.substr(bv,2).toLowerCase()===n){cO=bg.substr(bv,2);bv+=2}else{cO=null;if(cm===0){ca(l)}}if(cO===null){cO=au}if(cO!==null){if(Z.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(Y)}}if(cN===null){cN=au}if(cN!==null){cM=[];cL=aZ();while(cL!==null){cM.push(cL);cL=aZ()}if(cM!==null){if(bg.charCodeAt(bv)===46){cL=bQ;bv++}else{cL=null;if(cm===0){ca(bP)}}if(cL!==null){cK=[];cR=aZ();if(cR!==null){while(cR!==null){cK.push(cR);cR=aZ()}}else{cK=aB}if(cK!==null){cR=bq();if(cR===null){cR=au}if(cR!==null){cQ=W();if(cQ!==null){cI=cP;cO=k(cN,cM,cK,cR);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2).toLowerCase()===n){cO=bg.substr(bv,2);bv+=2}else{cO=null;if(cm===0){ca(l)}}if(cO===null){cO=au}if(cO!==null){if(Z.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(Y)}}if(cN===null){cN=au}if(cN!==null){cM=[];cL=aZ();if(cL!==null){while(cL!==null){cM.push(cL);cL=aZ()}}else{cM=aB}if(cM!==null){if(bg.charCodeAt(bv)===46){cL=bQ;bv++}else{cL=null;if(cm===0){ca(bP)}}if(cL!==null){cK=[];cR=aZ();while(cR!==null){cK.push(cR);cR=aZ()}if(cK!==null){cR=bq();if(cR===null){cR=au}if(cR!==null){cQ=W();if(cQ!==null){cI=cP;cO=k(cN,cM,cK,cR);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2).toLowerCase()===n){cO=bg.substr(bv,2);bv+=2}else{cO=null;if(cm===0){ca(l)}}if(cO===null){cO=au}if(cO!==null){if(Z.test(bg.charAt(bv))){cN=bg.charAt(bv);bv++}else{cN=null;if(cm===0){ca(Y)}}if(cN===null){cN=au}if(cN!==null){cM=[];cL=aZ();if(cL!==null){while(cL!==null){cM.push(cL);cL=aZ()}}else{cM=aB}if(cM!==null){cL=bq();if(cL===null){cL=au}if(cL!==null){cK=W();if(cK!==null){cI=cP;cO=j(cN,cM,cL);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}}return cP}function o(){var cK;cK=bL();if(cK===null){cK=E()}return cK}function bL(){var cK;cK=aj();if(cK===null){cK=P();if(cK===null){cK=Q();if(cK===null){cK=bn();if(cK===null){cK=bf();if(cK===null){cK=aN();if(cK===null){cK=be()}}}}}}return cK}function E(){var cK;cK=aP();if(cK===null){cK=bu()}return cK}function aP(){var cS,cR,cQ,cP,cO,cN,cM,cL,cK;cS=bv;if(bg.charCodeAt(bv)===40){cR=aM;bv++}else{cR=null;if(cm===0){ca(aL)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===41){cO=aK;bv++}else{cO=null;if(cm===0){ca(aI)}}if(cO!==null){cI=cS;cR=h(cP);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bv;if(bg.charCodeAt(bv)===40){cR=aM;bv++}else{cR=null;if(cm===0){ca(aL)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===46){cO=bQ;bv++}else{cO=null;if(cm===0){ca(bP)}}if(cO!==null){cN=cC();if(cN!==null){cM=o();if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===41){cK=aK;bv++}else{cK=null;if(cm===0){ca(aI)}}if(cK!==null){cI=cS;cR=g(cP,cM);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bv;if(bg.charCodeAt(bv)===91){cR=aG;bv++}else{cR=null;if(cm===0){ca(aF)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===93){cO=aE;bv++}else{cO=null;if(cm===0){ca(aD)}}if(cO!==null){cI=cS;cR=h(cP);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bv;if(bg.charCodeAt(bv)===91){cR=aG;bv++}else{cR=null;if(cm===0){ca(aF)}}if(cR!==null){cQ=cC();if(cQ!==null){cP=[];cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}if(cO!==null){while(cO!==null){cP.push(cO);cO=bv;cN=o();if(cN!==null){cM=cC();if(cM!==null){cN=[cN,cM];cO=cN}else{bv=cO;cO=aB}}else{bv=cO;cO=aB}}}else{cP=aB}if(cP!==null){if(bg.charCodeAt(bv)===46){cO=bQ;bv++}else{cO=null;if(cm===0){ca(bP)}}if(cO!==null){cN=cC();if(cN!==null){cM=o();if(cM!==null){cL=cC();if(cL!==null){if(bg.charCodeAt(bv)===93){cK=aE;bv++}else{cK=null;if(cm===0){ca(aD)}}if(cK!==null){cI=cS;cR=g(cP,cM);if(cR===null){bv=cS;cS=cR}else{cS=cR}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}}else{bv=cS;cS=aB}if(cS===null){cS=bG()}}}}return cS}function bG(){var cN,cM,cL,cK;cN=bv;if(bg.substr(bv,2)===f){cM=f;bv+=2}else{cM=null;if(cm===0){ca(e)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=d(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===39){cM=cJ;bv++}else{cM=null;if(cm===0){ca(cH)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=cF(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===96){cM=cE;bv++}else{cM=null;if(cm===0){ca(cD)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=cB(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}if(cN===null){cN=bv;if(bg.charCodeAt(bv)===44){cM=cA;bv++}else{cM=null;if(cm===0){ca(cy)}}if(cM!==null){cL=cC();if(cL!==null){cK=o();if(cK!==null){cI=cN;cM=cw(cK);if(cM===null){bv=cN;cN=cM}else{cN=cM}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}else{bv=cN;cN=aB}}}}return cN}function bu(){var cP,cO,cN,cM,cL,cK,cQ;cP=bv;if(bg.substr(bv,2)===cv){cO=cv;bv+=2}else{cO=null;if(cm===0){ca(cu)}}if(cO!==null){cN=cC();if(cN!==null){cM=[];cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}while(cL!==null){cM.push(cL);cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}}if(cM!==null){if(bg.charCodeAt(bv)===41){cL=aK;bv++}else{cL=null;if(cm===0){ca(aI)}}if(cL!==null){cI=cP;cO=cs(cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}if(cP===null){cP=bv;if(bg.substr(bv,2)===cr){cO=cr;bv+=2}else{cO=null;if(cm===0){ca(cq)}}if(cO!==null){cN=cC();if(cN!==null){cM=[];cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}while(cL!==null){cM.push(cL);cL=bv;cK=o();if(cK!==null){cQ=cC();if(cQ!==null){cK=[cK,cQ];cL=cK}else{bv=cL;cL=aB}}else{bv=cL;cL=aB}}if(cM!==null){if(bg.charCodeAt(bv)===93){cL=aE;bv++}else{cL=null;if(cm===0){ca(aD)}}if(cL!==null){cI=cP;cO=cs(cM);if(cO===null){bv=cP;cP=cO}else{cP=cO}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}else{bv=cP;cP=aB}}return cP}function cG(){var cO,cN,cM,cL,cK;cO=bv;cN=[];cM=bv;cL=o();if(cL!==null){cK=cC();if(cK!==null){cL=[cL,cK];cM=cL}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}while(cM!==null){cN.push(cM);cM=bv;cL=o();if(cL!==null){cK=cC();if(cK!==null){cL=[cL,cK];cM=cL}else{bv=cM;cM=aB}}else{bv=cM;cM=aB}}if(cN!==null){cI=cO;cN=cp(cN)}if(cN===null){bv=cO;cO=cN}else{cO=cN}return cO}bd=bV();if(bd!==null&&bv===bg.length){return bd}else{S(a1);cI=Math.max(bv,a0);throw new a(a1,cI<bg.length?bg.charAt(cI):null,cI,I(cI).line,I(cI).column)}}return{SyntaxError:a,parse:b}})();ccc.libutil={};ccc.libutil.objectToNativeValue=function(b){var a=function(){throw new Error("Unable to convert object "+b+" to native value")};if(b===ccc.unspecified){return undefined}if(b===ccc.nil){return null}if(b===ccc.t){return true}if(b===ccc.f){return false}if(b.constructor===ccc.Number){return b.value_}if(b.constructor===ccc.String){return b.value_}if(b.constructor===ccc.Symbol){return b.name}if(b.constructor===ccc.Vector){return b.elements_.map(ccc.libutil.objectToNativeValue)}if(b.constructor===ccc.Pair){var c={};b.forEach(function(d){if(d.constructor!==ccc.Pair){a()}if(d.cdr().constructor!==ccc.Pair){a()}if(d.cdr().cdr()!==ccc.nil){a()}c[ccc.libutil.objectToNativeValue(d.car())]=ccc.libutil.objectToNativeValue(d.cdr().car())},function(){a()});return c}a()};ccc.libutil.objectFromNativeValue=function(e,b){if(e===undefined){return ccc.unspecified}if(e===null){return ccc.nil}if(e===true){return ccc.t}if(e===false){return ccc.f}if(+e===e){return new ccc.Number(e)}if(""+e===e){return new ccc.String(e)}if(e instanceof Array){if(b){return ccc.unspecified}var f=function(g){return ccc.libutil.objectFromNativeValue(g,true)};return new ccc.Vector(e.map(f))}if(e instanceof Object){if(b){return ccc.unspecified}var a=[];for(var c in e){if(e.hasOwnProperty(c)){var d=ccc.libutil.objectFromNativeValue(e[c],true);if(d!==undefined){a.push(ccc.Pair.makeList(new ccc.Symbol(c),d))}}}return ccc.Pair.makeList.apply(null,a)}throw new Error("Unable to convert native value "+e+" to object")};ccc.libutil.resolveNativeName=function(b){if(b.constructor===ccc.Symbol){return{object:window,value:window[b.name]}}else{if(b.constructor===ccc.Pair){var d=b.toArray().map(function(e){return e.toString()});var a=window;var c=window;while(c instanceof Object&&d.length>0){a=c;c=c[d.shift()]}if(d.length===0){return{object:a,value:c}}}}throw new Error("Unable to resolve native object name: "+b.toSource())};ccc.lib.base=new ccc.Library("base");(function(){var a=function(b){if(b.constructor===ccc.String){return b.value_}if(b.constructor===ccc.Symbol){return b.name}throw new Error("load: Names and prefixes must be symbols or strings")};ccc.lib.base.addNativeFunction("load",function(d,c,g){g=g.toArray();if(g.length<1){throw new Error("load: Expected at least 1 argument; received 0.")}for(var h=0;h<g.length;++h){var b=g[h];var f,j;if(b.constructor===ccc.Pair){f=a(b.car());j=a(b.cdr())}else{f=a(b);j=f}var e=ccc.lib[f];if(!e||e.constructor!==ccc.Library){throw new Error("load: Unknown library '"+f)}d.importLibrary(e,j)}return c(ccc.unspecified)})}());(function(){ccc.lib.base.registerEntries([{name:"+",optionalArgs:"number",impl:function(c){var d=0;c.toArray().forEach(function(e){d+=e.value_});return new ccc.Number(d)}},{name:"*",optionalArgs:"number",impl:function(c){var d=1;c.toArray().forEach(function(e){d*=e.value_});return new ccc.Number(d)}},{name:"-",requiredArgs:["number"],optionalArgs:"number",impl:function(d,c){d=d.value_;if(c===ccc.nil){return new ccc.Number(-d)}c.forEach(function(e){d-=e.value_});return new ccc.Number(d)}},{name:"/",requiredArgs:["number"],optionalArgs:"number",impl:function(d,c){d=d.value_;if(c===ccc.nil){return new ccc.Number(1/d)}c.forEach(function(e){d/=e.value_});return new ccc.Number(d)}},]);ccc.lib.base.addSimpleFunctions({"integer?":function(c){if(c.constructor===ccc.Number&&c.value_===(c.value_|0)){return ccc.t}return ccc.f},"zero?":function(c){requireNumber(c,0,"zero?");return c.value_===0?ccc.t:ccc.f},"positive?":function(c){requireNumber(c,0,"positive?");return c.value_>0?ccc.t:ccc.f},"negative?":function(c){requireNumber(c,0,"negative?");return c.value_<0?ccc.t:ccc.f},"even?":function(c){requireNumber(c,0,"even?");return c.value_%2===0?ccc.t:ccc.f},"odd?":function(c){requireNumber(c,0,"odd?");return c.value_%2===1?ccc.t:ccc.f},max:function(){var d=Array.prototype.slice.call(arguments);if(d.length===0){throw new Error("max: Expected at least 1 argument")}var c=d[0];requireNumber(c,0,"max");d.slice(1).forEach(function(f,e){requireNumber(f,e+1,"max");if(f.value_>c.value_){c=f}});return c},min:function(){var c=Array.prototype.slice.call(arguments);if(c.length===0){throw new Error("min: Expected at least 1 argument")}var d=c[0];requireNumber(d,0,"min");c.slice(1).forEach(function(f,e){requireNumber(f,e+1,"min");if(f.value_<d.value_){d=f}});return d},modulo:function(d,c){requireNumber(d,0,"modulo");requireNumber(c,1,"modulo");return new ccc.Number(d.value_%c.value_)},});var b=function(d,c){ccc.lib.base.addSimpleFunction(c,function(){var e=Array.prototype.slice.call(arguments);if(e.length!==d.length){throw new Error(c+": Expected exactly "+d.length+" arguments")}var f=e.map(function(h,g){requireNumber(h,g,c);return h.value_});return new ccc.Number(d.apply(null,f))})};b(Math.abs,"abs");b(Math.floor,"floor");b(Math.ceil,"ceiling");b(Math.exp,"exp");b(Math.log,"log");b(Math.sin,"sin");b(Math.cos,"cos");b(Math.tan,"tan");b(Math.asin,"asin");b(Math.acos,"acos");b(Math.sqrt,"sqrt");b(Math.pow,"expt");ccc.lib.base.addSimpleFunction("atan",function(){var c=Array.prototype.slice.call(arguments);if(c.length<1||c.length>2){throw new Error("atan: Expected 1 or 2 arguments")}requireNumber(c[0],0,"atan");if(c.length===1){return new ccc.Number(Math.atan(c[0].value_))}requireNumber(c[1],1,"atan");return new ccc.Number(Math.atan2(c[0].value_,c[1].value_))});var a=function(d,c){ccc.lib.base.addSimpleFunction(d,function(){var e=Array.prototype.slice.call(arguments);if(e.length<2){return ccc.t}var g=e[0];requireNumber(g,0,d);for(var f=1;f<e.length;++f){requireNumber(e[f],f,d);if(!c(g.value_,e[f].value_)){return ccc.f}g=e[f]}return ccc.t})};a("=",function(d,c){return d===c});a("<",function(d,c){return d<c});a(">",function(d,c){return d>c});a("<=",function(d,c){return d<=c});a(">=",function(d,c){return d>=c})}());(function(){var b=function(d,e){return{name:d,requiredArgs:["any"],impl:function(f){return e(f)?ccc.t:ccc.f}}};var a=function(d,e){return{name:d,requiredArgs:["any"],impl:function(f){return f.constructor===e?ccc.t:ccc.f}}};var c=function(e,d){return{name:e,optionalArgs:"any",impl:function(f){if(f===ccc.nil){return ccc.t}var g=f.car_;for(f=f.cdr_;f!==ccc.nil;f=f.cdr_){if(!d(g,f.car_)){return ccc.f}}return ccc.t}}};ccc.lib.base.registerEntries([a("boolean?",ccc.Boolean),a("number?",ccc.Number),a("string?",ccc.String),a("char?",ccc.Char),a("symbol?",ccc.Symbol),a("pair?",ccc.Pair),a("vector?",ccc.Vector),b("null?",function(d){return d===ccc.nil}),b("procedure?",function(d){return d.apply instanceof Function}),c("eq?",function(e,d){return e.eq(d)}),c("eqv?",function(e,d){return e.eqv(d)}),c("equal?",function(e,d){return e.equal(d)}),b("not",function(d){return d===ccc.f}),])}());(function(){var b=function(d,c){return{name:d,requiredArgs:["any","pair_or_nil"],impl:function(f,g){if(g===ccc.nil){return ccc.f}while(g.constructor===ccc.Pair){var e=c(f,g);if(e){return e}g=g.cdr()}if(g!==ccc.nil){throw new Error(d+": Argument 1 is not a proper list")}return ccc.f}}};ccc.lib.base.registerEntries([{name:"car",requiredArgs:["pair"],impl:function(c){return c.car()}},{name:"cdr",requiredArgs:["pair"],impl:function(c){return c.cdr()}},{name:"cons",requiredArgs:["any","any"],impl:function(c,d){return new ccc.Pair(c,d)}},{name:"list",optionalArgs:"any",impl:function(c){return c}},{name:"set-car!",requiredArgs:["pair","any"],impl:function(d,c){d.car_=c}},{name:"set-cdr!",requiredArgs:["pair","any"],impl:function(d,c){d.cdr_=c}},{name:"length",requiredArgs:["pair_or_nil"],impl:function(d){if(d===ccc.nil){return new ccc.Number(0)}var c=0;d.forEach(function(){++c},function(){throw new Error("length: Expected proper list")});return new ccc.Number(c)}},{name:"append",optionalArgs:"any",impl:function(e){if(e.length===0){return ccc.nil}e=e.toArray();var d=e[e.length-1];for(var f=e.length-2;f>=0;--f){var g=e[f],c=[];if(g===ccc.nil){continue}if(g.constructor!==ccc.Pair){throw new Error("append: Argument: "+f+" is not a list")}g.forEach(function(h){c.push(h)},function(){throw new Error("append: Argument "+f+" is not a proper list")});while(c.length>0){d=new ccc.Pair(c.pop(),d)}}return d}},{name:"reverse",requiredArgs:["pair_or_nil"],impl:function(c){if(c===ccc.nil){return ccc.nil}var d=ccc.nil;c.forEach(function(e){d=new ccc.Pair(e,d)},function(){throw new Error("reverse: Argument 0 is not a proper list")});return d}},{name:"list-tail",requiredArgs:["pair_or_nil","integer"],impl:function(d,c){c=c.value_;while(c>0){if(d.constructor!==ccc.Pair){throw new Error("list-tail: Wrong argument type")}d=d.cdr();--c}return d}},{name:"list-ref",requiredArgs:["pair","integer"],impl:function(d,c){if(c.value_<0){throw new Error("list-ref: Index out of bounds")}c=c.value_;while(c>0){if(d.constructor!==ccc.Pair){throw new Error("list-ref: Index out of bounds")}d=d.cdr();--c}if(d.constructor!==ccc.Pair){throw new Error("list-ref: Index out of bounds")}return d.car()}},b("memq",function(c,d){if(c.eq(d.car())){return d}return false}),b("memv",function(c,d){if(c.eqv(d.car())){return d}return false}),b("member",function(c,d){if(c.equal(d.car())){return d}return false}),b("assq",function(c,d){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assq: Argument 1 is not an association list")}if(c.eq(e.car())){return e}return false}),b("assv",function(c,d){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assv: Argument 1 is not an association list")}if(c.eqv(e.car())){return e}return false}),b("assoc",function(c,d){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assoc: Argument 1 is not an association list")}if(c.equal(e.car())){return e}return false}),]);var a=function(f){var d="c"+f+"r";var c={a:ccc.Pair.prototype.car,d:ccc.Pair.prototype.cdr};var e=f.split("").map(function(g){return c[g]});e.reverse();return{name:d,requiredArgs:["pair"],impl:function(g){e.forEach(function(h){if(g.constructor!==ccc.Pair){throw new Error(d+": Wrong type for argument 0")}g=h.apply(g)});return g}}};ccc.lib.base.registerEntries(("aa,ad,da,dd,aaa,aad,ada,add,daa,dad,dda,ddd,aaaa,aaad,aada,aadd,adaa,adad,adda,addd,daaa,daad,dada,dadd,ddaa,ddad,ddda,dddd").split(",").map(a))}());(function(){var c=function(e,d){return{name:e,requiredArgs:["char","char"],impl:function(g,f){return d(g.charCode_,f.charCode_)?ccc.t:ccc.f}}};var a=function(e,d){return{name:e,requiredArgs:["char","char"],impl:function(i,h){var g=String.fromCharCode(i.charCode_).toLocaleLowerCase().charCodeAt(0);var f=String.fromCharCode(h.charCode_).toLocaleLowerCase().charCodeAt(0);return d(g,f)?ccc.t:ccc.f}}};var b=function(d,e){return{name:d,requiredArgs:["char"],impl:function(f){requireChar(f,0,d);return String.fromCharCode(f.charCode_).match(e)?ccc.t:ccc.f}}};ccc.lib.base.registerEntries([c("char=?",function(e,d){return e===d}),c("char<?",function(e,d){return e<d}),c("char>?",function(e,d){return e>d}),c("char<=?",function(e,d){return e<=d}),c("char>=?",function(e,d){return e>=d}),a("char-ci=?",function(e,d){return e===d}),a("char-ci<?",function(e,d){return e<d}),a("char-ci>?",function(e,d){return e>d}),a("char-ci<=?",function(e,d){return e<=d}),a("char-ci>=?",function(e,d){return e>=d}),b("char-alphabetic?",/[a-zA-Z]/),b("char-numeric?",/[0-9]/),b("char-whitespace?",/[ \t\f\r\n\v\xa0\u2000-\u200b\u2028\u2029\u202f\u3000]/),b("char-upper-case?",/[A-Z]/),b("char-lower-case?",/[a-z]/),{name:"char->integer",requiredArgs:["char"],impl:function(d){return new ccc.Number(d.charCode_)}},{name:"integer->char",requiredArgs:["integer"],impl:function(d){return new ccc.Char(d.value_)}},{name:"char-upcase",requiredArgs:["char"],impl:function(d){return new ccc.Char(String.fromCharCode(d.charCode_).toLocaleUpperCase().charCodeAt(0))}},{name:"char-downcase",requiredArgs:["char"],impl:function(d){return new ccc.Char(String.fromCharCode(d.charCode_).toLocaleLowerCase().charCodeAt(0))}},])}());(function(){var a=function(e,d){return{name:e,requiredArgs:["string","string"],impl:function(f,g){return d(f.value_,g.value_)?ccc.t:ccc.f}}};var b=function(e,d){return{name:e,requiredArgs:["string","string"],impl:function(f,g){return d(f.value_.toLocaleLowerCase(),g.value_.toLocaleLowerCase())?ccc.t:ccc.f}}};var c=function(d){return String.fromCharCode(d.charCode_)};ccc.lib.base.registerEntries([{name:"make-string",requiredArgs:["integer"],optionalArgs:["char"],impl:function(e,d){if(d===ccc.unspecified){d=new ccc.Char(0)}return new ccc.String((Array(e.value_+1)).join(c(d)))}},{name:"string",optionalArgs:"char",impl:function(e){var d="";if(e!==ccc.nil){e.forEach(function(f){d+=c(f)})}return new ccc.String(d)},},{name:"string-length",requiredArgs:["string"],impl:function(d){return ccc.Number(d.value_.length)}},{name:"string-ref",requiredArgs:["string","integer"],impl:function(e,d){d=d.value_;if(d<0||d>=e.value_.length){throw new Error("string-ref: Index out of bounds")}return new ccc.Char(e.value_.charCodeAt(d))}},{name:"string-set!",requiredArgs:["string","integer","char"],impl:function(e,d,f){d=d.value_;if(d<0||d>=e.value_.length){throw new Error("string-set!: Index out of bounds")}e.value_=e.value_.substr(0,d)+c(f)+e.value_.substr(d+1)}},{name:"substring",requiredArgs:["string","integer","integer"],impl:function(e,f,d){f=f.value_;d=d.value_;if(f>d){throw new Error("substring: Invalid index range")}if(d>e.value_.length){throw new Error("substring: Index out of bounds")}return new ccc.String(e.value_.substring(f,d))}},{name:"string-append",optionalArgs:"string",impl:function(e){var d="";if(e===ccc.nil){return new ccc.String("")}e.forEach(function(f){d+=f.value_});return new ccc.String(d)},},{name:"string->symbol",requiredArgs:["string"],impl:function(d){return new ccc.Symbol(d.value_)}},{name:"symbol->string",requiredArgs:["symbol"],impl:function(d){return new ccc.String(d.name)}},{name:"number->string",requiredArgs:["number"],optionalArgs:["integer"],impl:function(e,d){d=(d===ccc.unspecified)?10:d.value_;return new ccc.String(e.value_.toString(d))}},{name:"string->number",requiredArgs:["string"],optionalArgs:["integer"],impl:function(d,e){e=(e===ccc.unspecified)?10:e.value_;if(e===10){return new ccc.Number(parseFloat(d.value_))}return new ccc.Number(parseInt(d.value_,e))}},{name:"string->list",requiredArgs:["string"],impl:function(d){var f=[];for(var e=0;e<d.value_.length;++e){f.push(new ccc.Char(d.value_.charCodeAt(e)))}return ccc.Pair.makeList.apply(null,f)},},{name:"list->string",requiredArgs:["list"],impl:function(e){var d="";if(e!==ccc.nil){e.forEach(function(f){d+=c(f)})}return new ccc.String(d)},},{name:"string-copy",requiredArgs:["string"],impl:function(d){return new ccc.String(d.value_)}},{name:"string-fill!",requiredArgs:["string","char"],impl:function(d,e){d.value_=(Array(d.value_.length+1)).join(c(e))}},a("string=?",function(e,d){return e===d}),a("string<?",function(e,d){return e<d}),a("string>?",function(e,d){return e>d}),a("string<=?",function(e,d){return e<=d}),a("string>=?",function(e,d){return e>=d}),b("string-ci=?",function(e,d){return e===d}),b("string-ci<?",function(e,d){return e<d}),b("string-ci>?",function(e,d){return e>d}),b("string-ci<=?",function(e,d){return e<=d}),b("string-ci>=?",function(e,d){return e>=d}),])}());(function(){ccc.lib.base.registerEntries([{name:"make-vector",requiredArgs:["integer"],optionalArgs:["any"],impl:function(b,d){var c=[];for(var a=0;a<b.value_;++a){c[a]=d}return new ccc.Vector(c)}},{name:"vector",optionalArgs:"any",impl:function(a){return new ccc.Vector(a.toArray())}},{name:"vector-length",requiredArgs:["vector"],impl:function(a){return new ccc.Number(a.elements_.length)}},{name:"vector-ref",requiredArgs:["vector","integer"],impl:function(a,b){b=b.value_;if(b<0||b>=a.elements_.length){throw new Error("vector-ref: Index out of bounds")}return a.elements_[b]},},{name:"vector-set!",requiredArgs:["vector","integer","any"],impl:function(a,c,b){c=c.value_;if(c<0||c>=a.elements_.length){throw new Error("vector-set!: Index out of bounds")}a.elements_[c]=b}},{name:"vector->list",requiredArgs:["vector"],impl:function(a){return ccc.Pair.makeList.apply(null,a.elements_)}},{name:"list->vector",requiredArgs:["list"],impl:function(b){var a=[];if(b!==ccc.nil){b.forEach(function(c){a.push(c)})}return new ccc.Vector(a)}},{name:"vector-fill!",requiredArgs:["vector","any"],impl:function(a,b){for(var c=0;c<a.elements_.length;++c){a.elements_[c]=b}}},])}());ccc.lib.base.registerEntries([{name:"call/cc",requiredArgs:["procedure"],customContinuation:true,impl:function(a){var b=new ccc.Pair(new ccc.Continuation(this.continuation),ccc.nil);return a.apply(this.environment,this.continuation,b)},},{name:"apply",requiredArgs:["procedure"],optionalArgs:"any",customContinuation:true,impl:function(a,c){if(c===ccc.nil){throw new Error("apply: Not enough arguments")}c=c.toArray();var b=c[c.length-1];if(b!==ccc.nil&&(b.constructor!==ccc.Pair||!b.isList())){throw new Error("apply: Wrong type for argument "+(c.length-1))}var e=c.slice(0,c.length-1);for(var d=e.length-1;d>=0;--d){b=new ccc.Pair(e[d],b)}return a.apply(this.environment,this.continuation,b)}},{name:"map",requiredArgs:["procedure"],optionalArgs:"pair_or_nil",customContinuation:true,impl:function(d,e){if(e===ccc.nil){throw new Error("map: Not enough arguments")}var c=e.toArray();var b=this.environment;var a=this.continuation;var f=function(h,g){var j=[];for(var k=0;k<h.length;++k){if(h[k]===ccc.nil){return a(ccc.Pair.makeList.apply(null,g))}j.push(h[k].car_)}var l=function(i){return f(h.map(function(m){return m.cdr_}),g.concat(i))};return d.apply(b,l,ccc.Pair.makeList.apply(null,j))};return f(c,[])}},{name:"for-each",requiredArgs:["procedure"],optionalArgs:"pair_or_nil",customContinuation:true,impl:function(e,f){if(f===ccc.nil){throw new Error("for-each: Not enough arguments")}var d=f.toArray();var c=this.environment;var b=this.continuation;var a=function(g){var h=[];for(var j=0;j<g.length;++j){if(g[j]===ccc.nil){return b(ccc.unspecified)}h.push(g[j].car_)}var k=function(i){return a(g.map(function(l){return l.cdr_}))};return e.apply(c,k,ccc.Pair.makeList.apply(null,h))};return a(d)}},]);ccc.lib.base.registerEntry({name:"display",requiredArgs:["any"],impl:function(a){console.log(a.toSource())}});ccc.lib.window=new ccc.Library("window");ccc.lib.window.registerEntries([{name:"set-title",requiredArgs:["string"],impl:function(a){window.document.title=a.value_}},]);