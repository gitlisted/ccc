ccc={};ccc.lib={};ccc.Object=function(){};ccc.Object.prototype.toSource=function(){return this.toString()};ccc.Object.prototype.compile=function(a){return this};ccc.Object.prototype.eval=function(b,a){return function(){return a(this)}.bind(this)};ccc.Object.prototype.eq=function(a){return this===a};ccc.Object.prototype.eqv=function(a){return this.eq(a)};ccc.Object.prototype.equal=function(a){return this.eqv(a)};ccc.Unspecified=function(){};ccc.Unspecified.prototype={__proto__:ccc.Object.prototype};ccc.Unspecified.prototype.constructor=ccc.Unspecified;ccc.Unspecified.prototype.toString=function(){return"#<unspecified>"};ccc.Unspecified.prototype.toSource=function(){return"#?"};ccc.unspecified=new ccc.Unspecified();ccc.Nil=function(){};ccc.Nil.prototype={__proto__:ccc.Object.prototype};ccc.Nil.prototype.constructor=ccc.Nil;ccc.Nil.prototype.toString=function(){return"#<nil>"};ccc.Nil.prototype.toSource=function(){return"()"};ccc.Nil.prototype.toArray=function(){return[]};ccc.nil=new ccc.Nil();ccc.Bool=function(a){this.value_=!!a};ccc.Bool.prototype={__proto__:ccc.Object.prototype};ccc.Bool.prototype.constructor=ccc.Bool;ccc.Bool.prototype.toString=function(){return"#<bool:"+this.value_.toString()+">"};ccc.Bool.prototype.toSource=function(){return this.value_?"#t":"#f"};ccc.t=new ccc.Bool(true);ccc.f=new ccc.Bool(false);ccc.Number=function(a){this.value_=a};ccc.Number.prototype={__proto__:ccc.Object.prototype};ccc.Number.prototype.constructor=ccc.Number;ccc.Number.prototype.toString=function(){return this.value_.toString()};ccc.Number.prototype.eq=function(a){return this.value_===a.value_};ccc.Char=function(a){this.charCode_=a};ccc.Char.prototype={__proto__:ccc.Object.prototype};ccc.Char.prototype.constructor=ccc.Char;ccc.Char.prototype.toString=function(){var a=this.charCode_.toString(16);return"#<char:"+"0000".substr(a.length)+a+">"};ccc.Char.prototype.toSource=function(){var a=this.charCode_.toString(16);return"#\\u"+"0000".substr(a.length)+a};ccc.Char.prototype.eq=function(a){return this.charCode_===a.charCode_};ccc.String=function(a){this.value_=a};ccc.String.prototype={__proto__:ccc.Object.prototype};ccc.String.prototype.constructor=ccc.String;ccc.String.prototype.sanitizedValue_=function(){return this.value_.replace("\n","\\n")};ccc.String.prototype.toString=function(){return'"'+this.sanitizedValue_()+'"'};ccc.String.prototype.eq=function(a){return this.value_===a.value_};ccc.Symbol=function(a){this.name=a};ccc.Symbol.prototype={__proto__:ccc.Object.prototype};ccc.Symbol.prototype.constructor=ccc.Symbol;ccc.Symbol.prototype.toString=function(){if(this.name.match(/[ \t\n\r\f\v()[\]\|;#"]/)){return"|"+this.name.replace("|","\\|").replace("\n","\\n")+"|"}return this.name};ccc.Symbol.prototype.compile=function(a){var b=a.lookup(this.name);if(b){return b}return new ccc.GlobalBinding(this.name)};ccc.Symbol.prototype.eq=function(a){return this.name===a.name};ccc.Pair=function(a,b){this.car_=a;this.cdr_=b};ccc.Pair.prototype={__proto__:ccc.Object.prototype};ccc.Pair.prototype.constructor=ccc.Pair;ccc.Pair.prototype.toString=function(){return"#<pair:"+this.car_.toString()+" . "+this.cdr_.toString()+">"};ccc.Pair.prototype.toSource=function(){return"("+this.sourcify_()+")"};ccc.Pair.prototype.sourcify_=function(){var a=this.car_.toSource();if(this.cdr_.constructor===ccc.Pair){a+=" "+this.cdr_.sourcify_()}else{if(this.cdr_!==ccc.nil){a+=" . "+this.cdr_.toSource()}}return a};ccc.Pair.makeList=function(){var b=ccc.nil;for(var a=arguments.length-1;a>=0;--a){b=new ccc.Pair(arguments[a],b)}return b};ccc.Pair.prototype.toArray=function(){var b=[];var a=this;while(a.constructor===ccc.Pair){b.push(a.car_);a=a.cdr_}if(a!==ccc.nil){throw new Error("Cannot convert improper list to an array")}return b};ccc.Pair.prototype.isList=function(){var a=this;while(a.constructor===ccc.Pair){a=a.cdr_}if(a===ccc.nil){return true}return false};ccc.Pair.prototype.forEach=function(b,a){var c=this;while(c.constructor===ccc.Pair){b(c.car_,c);c=c.cdr_}if(c.constructor!==ccc.Nil&&a){a(c)}};ccc.Pair.prototype.car=function(){return this.car_};ccc.Pair.prototype.cdr=function(){return this.cdr_};ccc.Pair.prototype.withCar=function(a){return new ccc.Pair(a,this.cdr_)};ccc.Pair.prototype.compileElements_=function(a){var b=this.car_.compile(a);if(this.cdr_.constructor===ccc.Pair){return new ccc.Pair(b,this.cdr_.compileElements_(a))}return new ccc.Pair(b,this.cdr_.compile(a))};ccc.Pair.prototype.compile=function(b){if(this.car_.constructor===ccc.Symbol&&!b.lookup(this.car_.name)){var a=b.lookupSyntax(this.car_.name);if(a){var c=a.transform(b,this.cdr_);return c.compile(b)}}return this.compileElements_(b)};ccc.Pair.prototype.eval=function(environment,continuation){return function(){return this.car_.eval(environment,function(callee){if(!callee.apply){throw new Error("Object "+this.car_.toString()+" is not applicable")}var argsForm=this.cdr_;var argEvaluator=function(argsRemaining,args){if(argsRemaining===ccc.nil){var argsList=ccc.Pair.makeList.apply(null,args);return callee.apply(environment,continuation,argsList)}if(argsRemaining.constructor!==ccc.Pair){throw new Error("Invalid argument list: "+argsForm.toSource())}var head=argsRemaining.car_;return head.eval(environment,function(value){return argEvaluator(argsRemaining.cdr_,args.concat(value))})};return argEvaluator(argsForm,[])}.bind(this))}.bind(this)};ccc.Pair.prototype.equal=function(d){var e=this,c=d;while(e.constructor===ccc.Pair&&c.constructor===ccc.Pair){if(e.constructor!==c.constructor||!e.car_.equal(c.car_)){return false}e=e.cdr_;c=c.cdr_}if(e.constructor!==c.constructor||!e.equal(c)){return false}return true};ccc.Vector=function(a){this.elements_=a};ccc.Vector.prototype={__proto__:ccc.Object.prototype};ccc.Vector.prototype.constructor=ccc.Vector;ccc.Vector.prototype.toString=function(){return"#<vector:"+this.elements_.toString()+">"};ccc.Vector.prototype.toSource=function(){return"#("+this.elements_.map(function(a){return a.toSource()}).join(" ")+")"};ccc.Vector.prototype.equal=function(a){if(this.elements_.length!==a.elements_.length){return false}for(var b=0;b<this.elements_.length;++b){if(!this.elements_[b].equal(a.elements_[b])){return false}}return true};ccc.Environment=function(a){this.syntaxBindings_={};this.globalBindings_={};this.lexicalBindings_={};this.localBindings_={};if(a){this.parent_=a;this.nextLocal_=a.nextLocal_}else{this.initToplevel_();this.nextLocal_=0}};ccc.Environment.prototype={__proto__:ccc.Object.prototype};ccc.Environment.prototype.constructor=ccc.Environment;ccc.Environment.prototype.toString=function(){return"#<environment>"};ccc.Environment.prototype.initToplevel_=function(){var b=ccc.PrimitiveTransformers;for(var a in b){if(b.hasOwnProperty(a)){this.bindSyntax(a,b[a])}}};ccc.Environment.prototype.lookupSyntax=function(a){if(this.syntaxBindings_.hasOwnProperty(a)){return this.syntaxBindings_[a]}if(this.parent_){return this.parent_.lookupSyntax(a)}return null};ccc.Environment.prototype.lookup=function(a){if(this.lexicalBindings_.hasOwnProperty(a)){return this.lexicalBindings_[a]}if(this.globalBindings_.hasOwnProperty(a)){return this.globalBindings_[a]}if(this.parent_){return this.parent_.lookup(a)}return null};ccc.Environment.prototype.lookupLocal=function(a){if(this.localBindings_.hasOwnProperty(a)){return this.localBindings_[a]}if(this.parent_){return this.parent_.lookupLocal(a)}return null};ccc.Environment.prototype.bindSyntax=function(b,a){this.syntaxBindings_[b]=a;return a};ccc.Environment.prototype.bindGlobal=function(b,c){var a=new ccc.Location(b,c);this.globalBindings_[b]=a;return a};ccc.Environment.prototype.bindLexical=function(a){var b=new ccc.LexicalBinding(a,++this.nextLocal_);this.lexicalBindings_[a]=b;return b};ccc.Environment.prototype.bindLocal=function(b,a){this.localBindings_[b.id_]=new ccc.Location(b.name_,a)};ccc.Environment.prototype.importLibrary=function(b,d){if(d===undefined){d=""}else{d=d+":"}var a=b.entries();for(var c in a){if(a.hasOwnProperty(c)){this.bindGlobal(d+c,a[c])}}};ccc.Environment.prototype.evalForm=function(form,opt_receiver){var compiledForm=form.compile(this);var terminate=function(value){if(opt_receiver){opt_receiver(value)}};var continuation=compiledForm.eval(this,terminate);var timeslice=function(){var cyclesPerSlice=1000;while(cyclesPerSlice-->0&&continuation){continuation=continuation()}if(continuation){setTimeout(timeslice,0)}};timeslice()};ccc.Environment.prototype.evalProgram=function(b,c){if(b.length===0){throw new Error("Empty program?")}b=b.slice();var a=function(){var d=b.shift();this.evalForm(d,function(e){if(c){c(e,false)}if(b.length>0){a()}else{if(c){c(e,true)}}})}.bind(this);a()};ccc.Location=function(a,b){this.name_=a;this.value_=b||ccc.unspecified};ccc.Location.prototype={__proto__:ccc.Object.prototype};ccc.Location.prototype.constructor=ccc.Location;ccc.Location.prototype.toString=function(){return"#<location:"+this.name_+">"};ccc.Location.prototype.eval=function(b,a){return function(){return a(this.value_)}.bind(this)};ccc.GlobalBinding=function(a){this.name_=a};ccc.GlobalBinding.prototype={__proto__:ccc.Object.prototype};ccc.GlobalBinding.prototype.constructor=ccc.GlobalBinding;ccc.GlobalBinding.prototype.toString=function(){return"#<global-binding:"+this.name_+">"};ccc.GlobalBinding.prototype.eval=function(b,a){return function(){var c=b.lookup(this.name_);if(!c){throw new Error("Unbound variable: "+this.name_)}return a(c.value_)}.bind(this)};ccc.LexicalBinding=function(a,b){this.name_=a;this.id_=b};ccc.LexicalBinding.prototype={__proto__:ccc.Object.prototype};ccc.LexicalBinding.prototype.constructor=ccc.LexicalBinding;ccc.LexicalBinding.prototype.toString=function(){return"#<binding:"+this.name_+">"};ccc.LexicalBinding.prototype.eval=function(b,a){return function(){return a(b.lookupLocal(this.id_).value_)}.bind(this)};ccc.NativeFunction=function(b,a){this.fn_=b;this.name_=a||"(anonymous)"};ccc.NativeFunction.prototype={__proto__:ccc.Object.prototype};ccc.NativeFunction.prototype.constructor=ccc.NativeFunction;ccc.NativeFunction.prototype.toString=function(){return"#<native-function:"+this.name_+">"};ccc.NativeFunction.prototype.apply=function(b,a,c){return this.fn_(b,a,c)};ccc.Closure=function(a,b,d,c){this.capturedEnvironment_=a;this.compiledBody_=b;this.namedArgBindings_=d;this.argsTailBinding_=c};ccc.Closure.prototype={__proto__:ccc.Object.prototype};ccc.Closure.prototype.constructor=ccc.Closure;ccc.Closure.prototype.toString=function(){return"#<closure>"};ccc.Closure.prototype.apply=function(environment,continuation,args){var callEnvironment=new ccc.Environment(this.capturedEnvironment_);for(var i=0;i<this.namedArgBindings_.length;++i){if(args.constructor!==ccc.Pair){throw new Error("Too few arguments applied to closure")}callEnvironment.bindLocal(this.namedArgBindings_[i],args.car());args=args.cdr()}if(args!==ccc.nil&&this.argsTailBinding_===ccc.nil){throw new Error("Too many arguments applied to closure")}if(this.argsTailBinding_!==ccc.nil){callEnvironment.bindLocal(this.argsTailBinding_,args)}var evalForms=function(forms){if(forms.length===1){return forms[0].eval(callEnvironment,continuation)}return forms[0].eval(callEnvironment,function(){return evalForms(forms.slice(1))})};return evalForms(this.compiledBody_.slice())};ccc.Continuation=function(a){this.fn_=a};ccc.Continuation.prototype={__proto__:ccc.Object.prototype};ccc.Continuation.prototype.constructor=ccc.Continuation;ccc.Continuation.prototype.toString=function(){return"#<continuation>"};ccc.Continuation.prototype.apply=function(b,a,c){if(c===ccc.nil||c.cdr()!==ccc.nil){throw new Error("Wrong number of args given to continuation")}return function(){return this.fn_(c.car())}.bind(this)};ccc.Transformer=function(a){this.transform_=a};ccc.Transformer.prototype={__proto__:ccc.Object.prototype};ccc.Transformer.prototype.constructor=ccc.Transformer;ccc.Transformer.prototype.toString=function(){return"#<transformer>"};ccc.Transformer.prototype.transform=function(a,b){return this.transform_(a,b)};ccc.PrimitiveTransformers={};ccc.PrimitiveTransformers.quote=new ccc.Transformer(function(a,c){var b=c.car();return new ccc.Pair(new ccc.NativeFunction(function(e,d,f){return function(){return d(b)}},"quote"),ccc.nil)});ccc.PrimitiveTransformers.define=new ccc.Transformer(function(b,e){if(e.constructor!==ccc.Pair){throw new Error("Invalid form for 'define: not enough arguments")}var f=e.car();if(f.constructor===ccc.Pair){var c=f.cdr();var a=e.cdr();f=f.car();return ccc.Pair.makeList(new ccc.Symbol("define"),f,new ccc.Pair(new ccc.Symbol("lambda"),new ccc.Pair(c,a)))}if(f.constructor!==ccc.Symbol){throw new Error("Invalid form for 'define: symbol expected as first argument")}var d=e.cdr();if(d.constructor!==ccc.Pair){throw new Error("Invalid form for 'define")}if(d.cdr()!==ccc.nil){throw new Error("Invalid form for 'define: too many arguments")}return e.withCar(new ccc.NativeFunction(function(h,g,i){return function(){var j=h.lookup(f.name);if(!j||j.constructor!==ccc.Location){h.bindGlobal(f.name,i.car())}else{j.value_=i.car()}return g(ccc.unspecified)}},"bind-variable"))});ccc.PrimitiveTransformers["set!"]=new ccc.Transformer(function(a,c){if(c.constructor!==ccc.Pair){throw new Error("Invalid form for 'set!: not enough arguments")}var d=c.car();if(d.constructor!==ccc.Symbol){throw new Error("Invalid form for 'set!: symbol expected as first argument")}var b=c.cdr();if(b.constructor!==ccc.Pair){throw new Error("Invalid form for 'set!")}if(b.cdr()!==ccc.nil){throw new Error("Invalid form for 'set!: too many arguments")}var e=d.compile(a);return c.withCar(new ccc.NativeFunction(function(g,f,h){return function(){var i=e;if(e.constructor===ccc.LexicalBinding){i=g.lookupLocal(e.id_)}else{if(e.constructor===ccc.GlobalBinding){i=g.lookup(e.name_)}}if(!i){throw new Error("Unbound variable: "+d.name)}i.value_=h.car();return f(ccc.unspecified)}},"set-variable"))});ccc.PrimitiveTransformers.lambda=new ccc.Transformer(function(d,a){if(a.constructor!==ccc.Pair){throw new Error("Bad lambda body: "+a.toString())}var h=a.car();var f=a.cdr();if(f.constructor!==ccc.Pair){throw new Error("Bad lambda body: "+a.toString())}var c=new ccc.Environment(d);var b=[];var e=ccc.nil;if(h.constructor===ccc.Symbol){e=c.bindLexical(h.name)}else{if(h.constructor===ccc.Pair){var j=function(k){if(k.constructor!==ccc.Symbol){throw new Error("Invalid args form")}b.push(c.bindLexical(k.name))};var g=function(k){if(k.constructor!==ccc.Symbol){throw new Error("Invalid args form")}e=c.bindLexical(k.name)};h.forEach(j,g)}else{if(h!==ccc.nil){throw new Error("Invalid args form")}}}var i=[];f.forEach(function(k){i.push(k.compile(c))},function(){throw new Error("Invalid lambda body")});return new ccc.Pair(new ccc.NativeFunction(function(l,k,m){return function(){return k(new ccc.Closure(l,i,b,e))}},"make-closure"),ccc.nil)});ccc.PrimitiveTransformers["if"]=new ccc.Transformer(function(environment,form){if(form.constructor!==ccc.Pair){throw new Error("Bad 'if form")}var condition=form.car();var consequent=form.cdr();if(consequent===ccc.nil||consequent.constructor!==ccc.Pair){throw new Error("Bad 'if form")}var alternate=consequent.cdr();consequent=consequent.car();if(alternate===ccc.nil){alternate=ccc.unspecified}else{if(alternate.constructor===ccc.Pair){if(alternate.cdr()!==ccc.nil){throw new Error("Bad 'if form")}alternate=alternate.car()}else{throw new Error("Bad 'if form")}}condition=condition.compile(environment);consequent=consequent.compile(environment);alternate=alternate.compile(environment);return new ccc.Pair(new ccc.NativeFunction(function(environment,continuation,args){return function(){return condition.eval(environment,function(value){if(value!==ccc.f){return consequent.eval(environment,continuation)}return alternate.eval(environment,continuation)})}},"if"),ccc.nil)});ccc.PrimitiveTransformers["native-apply"]=new ccc.Transformer(function(a,c){if(c.constructor!==ccc.Pair){throw new Error("Bad native call form")}var b=c.car();return c.withCar(new ccc.NativeFunction(function(e,d,f){f=f.toArray();return function(){var h=ccc.libutil.resolveNativeName(b);f=f.map(ccc.libutil.objectToNativeValue);var g=ccc.libutil.objectFromNativeValue(h.value.apply(h.object,f));return d(g)}},"native-apply"))});ccc.Library=function(a){this.name_=a;this.entries_={}};ccc.Library.prototype={__proto__:ccc.Object.prototype};ccc.Library.prototype.constructor=ccc.Library;ccc.Library.prototype.name=function(){return this.name_};ccc.Library.prototype.entries=function(){return this.entries_};ccc.Library.prototype.addNativeFunction=function(a,b){this.entries_[a]=new ccc.NativeFunction(b,this.name_+":"+a)};ccc.Library.prototype.addNativeFunctions=function(a){for(var b in a){if(a.hasOwnProperty(b)){this.addNativeFunction(b,a[b])}}};ccc.Library.prototype.addSimpleFunction=function(a,b){this.entries_[a]=new ccc.NativeFunction(function(e,d,f){f=f.toArray();if(b.length>0&&f.length!==b.length){throw new Error(a+": Wrong number of arguments. Expected "+b.length+"; received "+f.length)}var c=b.apply(null,f);if(c===undefined){c=ccc.unspecified}return d(c)},this.name_+":"+a)};ccc.Library.prototype.addSimpleFunctions=function(a){for(var b in a){if(a.hasOwnProperty(b)){this.addSimpleFunction(b,a[b])}}};ccc.Parser=(function(){function c(f,d){function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e()}function a(g,h,i,e,f){function d(l,m){function j(o){function p(q){return q.charCodeAt(0).toString(16).toUpperCase()}return o.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(q){return"\\x0"+p(q)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(q){return"\\x"+p(q)}).replace(/[\u0180-\u0FFF]/g,function(q){return"\\u0"+p(q)}).replace(/[\u1080-\uFFFF]/g,function(q){return"\\u"+p(q)})}var n,k;switch(l.length){case 0:n="end of input";break;case 1:n=l[0];break;default:n=l.slice(0,-1).join(", ")+" or "+l[l.length-1]}k=m?'"'+j(m)+'"':"end of input";return"Expected "+n+" but "+k+" found."}this.expected=g;this.found=h;this.offset=i;this.line=e;this.column=f;this.name="SyntaxError";this.message=d(g,h)}c(a,Error);function b(bh){var b0=arguments.length>1?arguments[1]:{},t={start:co,datum:o},bW=co,aC=null,aB=function(cP){return cP},aA=/^[ \t\f\r\n\x0B\xA0\u2000-\u200B\u2028\u2029\u202F\u3000]/,az="[ \\t\\f\\r\\n\\x0B\\xA0\\u2000-\\u200B\\u2028\\u2029\\u202F\\u3000]",ay=[],aw=function(){return""},av="",au=/^[ "\t\f\r\n();[\]|]/,at='[ "\\t\\f\\r\\n();[\\]|]',ar="any character",cm=";",cl='";"',cj=/^[^\n\r]/,ci="[^\\n\\r]",ch=/^[\n\r]/,cg="[\\n\\r]",cf="#;",ce='"#;"',cd="\u03BB",cc='"\\u03BB"',ca=function(){return new ccc.Symbol("lambda")},b8=function(cQ,cP){return new ccc.Symbol(cQ+cP.join(""))},b7=function(cP){return new ccc.Symbol(cP)},b6=/^[!$%&*\/:<=>?\^_~a-z0-9]/i,b5="[!$%&*\\/:<=>?\\^_~a-z0-9]i",b4=/^[\x80-\uFFFF]/,b3="[\\x80-\\uFFFF]",b2=function(cP){return cP},b1=/^[0-9]/,bZ="[0-9]",bX=/^[0-9a-f]/i,bV="[0-9a-f]i",bT="+",bR='"+"',bQ="-",bP='"-"',bO=".",bN='"."',bL="@",bK='"@"',bG="...",bF='"..."',bE="#t",bD='"#t"',bC=function(){return ccc.t},bB="#f",bA='"#f"',bz=function(){return ccc.f},by="#\\space",bx='"#\\\\space"',bt=function(){return new ccc.Char(32)},bs="#\\newline",bq='"#\\\\newline"',bp=function(){return new ccc.Char(10)},bn="#\\x",bm='"#\\\\x"',bl=function(cQ,cP){return new ccc.Char(parseInt(cQ+cP,16))},bk="#\\u",bj='"#\\\\u"',bi=function(cQ,cP,cS,cR){return new ccc.Char(parseInt(cQ+cP+cS+cR,16))},bc="#\\",bb='"#\\\\"',ba=function(cP){return new ccc.Char(cP.charCodeAt(0))},a9='"',a8='"\\""',a7=function(cP){return new ccc.String(cP.join(""))},a6="\\\\",a5='"\\\\\\\\"',a4=function(){return"\\"},a3="\\n",aZ='"\\\\n"',aY=function(){return"\n"},aX="\\t",aW='"\\\\t"',aV=function(){return"\t"},aU="\\f",aT='"\\\\f"',aS=function(){return"\f"},aR="\\r",aP='"\\\\r"',aq=function(){return"\r"},ap="\\'",ao='"\\\\\'"',an=function(){return"'"},am='\\"',al='"\\\\\\""',aj=function(){return'"'},ah="\\x",ag='"\\\\x"',af=function(cQ,cP){return String.fromCharCode(parseInt(cQ+cP,16))},P="\\u",O='"\\\\u"',N=function(cQ,cP,cS,cR){return String.fromCharCode(parseInt(cQ+cP+cS+cR,16))},M=/^[^"\\]/,L='[^"\\\\]',K="|",I='"|"',H=function(cP){return new ccc.Symbol(cP.join(""))},G=/^[^|\\]/,E="[^|\\\\]",aN="\\|",aM='"\\\\|"',aL=function(){return"|"},aJ="(",aI='"("',aH=")",aG='")"',aF=function(){return ccc.nil},aE="[",aD='"["',ae="]",ad='"]"',ac="#?",ab='"#?"',aa=function(){return ccc.unspecified},Z="#b",Y='"#b"',V=/^[\-+]/,U="[\\-+]",S=/^[01]/,D="[01]",C=function(cP,cQ){return new ccc.Number(parseInt(cP+cQ.join(""),2))},B="#o",A='"#o"',z=/^[0-7]/,y="[0-7]",x=function(cP,cQ){return new ccc.Number(parseInt(cP+cQ.join(""),8))},w="#x",v='"#x"',u=function(cP,cQ){return new ccc.Number(parseInt(cP+cQ.join(""),16))},n=/^[eE]/,l="[eE]",k=function(cQ,cP,cR){return cQ+cP+cR.join("")},j="#d",h='"#d"',g=function(cP,cR,cQ,cS){return new ccc.Number(parseFloat(cP+cR.join("")+"."+cQ.join("")+cS))},f=function(cP,cQ,cR){return new ccc.Number(parseFloat(cP+cQ.join("")+cR))},e=function(cP,cQ){return new ccc.Pair(cP,cQ)},d=function(cP){return new ccc.Pair(cP,ccc.nil)},cO=function(cP){return cP},cM=",@",cK='",@"',cJ=function(cP){return ccc.Pair.makeList(new ccc.Symbol("unquote-splicing"),cP)},cI="'",cG='"\'"',cF=function(cP){return ccc.Pair.makeList(new ccc.Symbol("quote"),cP)},cD="`",cB='"`"',cA=function(cP){return ccc.Pair.makeList(new ccc.Symbol("quasiquote"),cP)},cz=",",cx='","',cw=function(cP){return ccc.Pair.makeList(new ccc.Symbol("unquote"),cP)},cv="#(",cu='"#("',ct=function(cP){return new ccc.Vector(cP.map(function(cQ){return cQ[0]}))},cs="#[",cr='"#["',cq=function(cP){return cP.map(function(cQ){return cQ[0]})},bw=0,cN=0,cp=0,ax={line:1,column:1,seenCR:false},a1=0,a2=[],cn=0,be;if("startRule" in b0){if(!(b0.startRule in t)){throw new Error("Can't start parsing from rule \""+b0.startRule+'".')}bW=t[b0.startRule]}function b9(){return bh.substring(cN,bw)}function cy(){return cN}function ck(){return J(cN).line}function cE(){return J(cN).column}function J(cQ){function cP(cT,cS,cR){var cV,cU;for(cV=cS;cV<cR;cV++){cU=bh.charAt(cV);if(cU==="\n"){if(!cT.seenCR){cT.line++}cT.column=1;cT.seenCR=false}else{if(cU==="\r"||cU==="\u2028"||cU==="\u2029"){cT.line++;cT.column=1;cT.seenCR=true}else{cT.column++;cT.seenCR=false}}}}if(cp!==cQ){if(cp>cQ){cp=0;ax={line:1,column:1,seenCR:false}}cP(ax,cp,cQ);cp=cQ}return ax}function cb(cP){if(bw<a1){return}if(bw>a1){a1=bw;a2=[]}a2.push(cP)}function T(cQ){var cP=0;cQ.sort();while(cP<cQ.length){if(cQ[cP-1]===cQ[cP]){cQ.splice(cP,1)}else{cP++}}}function co(){var cS,cR,cQ,cP;cS=bw;cR=cH();if(cR!==null){cQ=cL();if(cQ!==null){cP=cH();if(cP!==null){cN=cS;cR=aB(cQ);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}return cS}function ai(){var cP;if(aA.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(az)}}return cP}function bI(){var cP;cP=ai();if(cP===null){cP=cC()}return cP}function cH(){var cR,cQ,cP;cR=bw;cQ=[];cP=bI();while(cP!==null){cQ.push(cP);cP=bI()}if(cQ!==null){cN=cR;cQ=aw()}if(cQ===null){bw=cR;cR=cQ}else{cR=cQ}return cR}function X(){var cR,cQ,cP;cR=bw;cQ=bw;cn++;if(au.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(at)}}cn--;if(cP!==null){bw=cQ;cQ=av}else{cQ=aC}if(cQ!==null){cP=cH();if(cP!==null){cQ=[cQ,cP];cR=cQ}else{bw=cR;cR=aC}}else{bw=cR;cR=aC}if(cR===null){cR=bw;cn++;if(bh.length>bw){cQ=bh.charAt(bw);bw++}else{cQ=null;if(cn===0){cb(ar)}}cn--;if(cQ===null){cR=av}else{bw=cR;cR=aC}}return cR}function cC(){var cS,cR,cQ,cP;cS=bw;if(bh.charCodeAt(bw)===59){cR=cm;bw++}else{cR=null;if(cn===0){cb(cl)}}if(cR!==null){cQ=[];if(cj.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(ci)}}while(cP!==null){cQ.push(cP);if(cj.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(ci)}}}if(cQ!==null){if(ch.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(cg)}}if(cP===null){cP=av}if(cP!==null){cR=[cR,cQ,cP];cS=cR}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;if(bh.substr(bw,2)===cf){cR=cf;bw+=2}else{cR=null;if(cn===0){cb(ce)}}if(cR!==null){cQ=cH();if(cQ!==null){cP=o();if(cP!==null){cR=[cR,cQ,cP];cS=cR}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}return cS}function bg(){var cS,cR,cQ,cP;cS=bw;if(bh.charCodeAt(bw)===955){cR=cd;bw++}else{cR=null;if(cn===0){cb(cc)}}if(cR!==null){cQ=X();if(cQ!==null){cN=cS;cR=ca();if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;cR=W();if(cR!==null){cQ=[];cP=i();while(cP!==null){cQ.push(cP);cP=i()}if(cQ!==null){cP=X();if(cP!==null){cN=cS;cR=b8(cR,cQ);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;cR=bu();if(cR!==null){cQ=X();if(cQ!==null){cN=cS;cR=b7(cR);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bJ()}}}return cS}function W(){var cR,cQ,cP;if(b6.test(bh.charAt(bw))){cR=bh.charAt(bw);bw++}else{cR=null;if(cn===0){cb(b5)}}if(cR===null){cR=bw;cQ=bw;cn++;cP=ai();cn--;if(cP===null){cQ=av}else{bw=cQ;cQ=aC}if(cQ!==null){if(b4.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(b3)}}if(cP!==null){cN=cR;cQ=b2(cP);if(cQ===null){bw=cR;cR=cQ}else{cR=cQ}}else{bw=cR;cR=aC}}else{bw=cR;cR=aC}}return cR}function i(){var cP;cP=W();if(cP===null){cP=a0();if(cP===null){cP=aK()}}return cP}function a0(){var cP;if(b1.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(bZ)}}return cP}function bU(){var cP;if(bX.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(bV)}}return cP}function aK(){var cP;if(bh.charCodeAt(bw)===43){cP=bT;bw++}else{cP=null;if(cn===0){cb(bR)}}if(cP===null){if(bh.charCodeAt(bw)===45){cP=bQ;bw++}else{cP=null;if(cn===0){cb(bP)}}if(cP===null){if(bh.charCodeAt(bw)===46){cP=bO;bw++}else{cP=null;if(cn===0){cb(bN)}}if(cP===null){if(bh.charCodeAt(bw)===64){cP=bL;bw++}else{cP=null;if(cn===0){cb(bK)}}}}}return cP}function bu(){var cP;if(bh.charCodeAt(bw)===43){cP=bT;bw++}else{cP=null;if(cn===0){cb(bR)}}if(cP===null){if(bh.charCodeAt(bw)===45){cP=bQ;bw++}else{cP=null;if(cn===0){cb(bP)}}if(cP===null){if(bh.substr(bw,3)===bG){cP=bG;bw+=3}else{cP=null;if(cn===0){cb(bF)}}}}return cP}function ak(){var cR,cQ,cP;cR=bw;if(bh.substr(bw,2).toLowerCase()===bE){cQ=bh.substr(bw,2);bw+=2}else{cQ=null;if(cn===0){cb(bD)}}if(cQ!==null){cP=X();if(cP!==null){cN=cR;cQ=bC();if(cQ===null){bw=cR;cR=cQ}else{cR=cQ}}else{bw=cR;cR=aC}}else{bw=cR;cR=aC}if(cR===null){cR=bw;if(bh.substr(bw,2).toLowerCase()===bB){cQ=bh.substr(bw,2);bw+=2}else{cQ=null;if(cn===0){cb(bA)}}if(cQ!==null){cP=X();if(cP!==null){cN=cR;cQ=bz();if(cQ===null){bw=cR;cR=cQ}else{cR=cQ}}else{bw=cR;cR=aC}}else{bw=cR;cR=aC}}return cR}function R(){var cU,cT,cS,cR,cQ,cP,cV;cU=bw;if(bh.substr(bw,7).toLowerCase()===by){cT=bh.substr(bw,7);bw+=7}else{cT=null;if(cn===0){cb(bx)}}if(cT!==null){cS=X();if(cS!==null){cN=cU;cT=bt();if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,9).toLowerCase()===bs){cT=bh.substr(bw,9);bw+=9}else{cT=null;if(cn===0){cb(bq)}}if(cT!==null){cS=X();if(cS!==null){cN=cU;cT=bp();if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,3).toLowerCase()===bn){cT=bh.substr(bw,3);bw+=3}else{cT=null;if(cn===0){cb(bm)}}if(cT!==null){cS=bU();if(cS!==null){cR=bU();if(cR!==null){cQ=X();if(cQ!==null){cN=cU;cT=bl(cS,cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,3).toLowerCase()===bk){cT=bh.substr(bw,3);bw+=3}else{cT=null;if(cn===0){cb(bj)}}if(cT!==null){cS=bU();if(cS!==null){cR=bU();if(cR!==null){cQ=bU();if(cQ!==null){cP=bU();if(cP!==null){cV=X();if(cV!==null){cN=cU;cT=bi(cS,cR,cQ,cP);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,2)===bc){cT=bc;bw+=2}else{cT=null;if(cn===0){cb(bb)}}if(cT!==null){if(bh.length>bw){cS=bh.charAt(bw);bw++}else{cS=null;if(cn===0){cb(ar)}}if(cS!==null){cR=X();if(cR!==null){cN=cU;cT=ba(cS);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}}}}return cU}function bo(){var cS,cR,cQ,cP;cS=bw;if(bh.charCodeAt(bw)===34){cR=a9;bw++}else{cR=null;if(cn===0){cb(a8)}}if(cR!==null){cQ=[];cP=bS();while(cP!==null){cQ.push(cP);cP=bS()}if(cQ!==null){if(bh.charCodeAt(bw)===34){cP=a9;bw++}else{cP=null;if(cn===0){cb(a8)}}if(cP!==null){cN=cS;cR=a7(cQ);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}return cS}function bY(){var cU,cT,cS,cR,cQ,cP;cU=bw;if(bh.substr(bw,2)===a6){cT=a6;bw+=2}else{cT=null;if(cn===0){cb(a5)}}if(cT!==null){cN=cU;cT=a4()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===a3){cT=a3;bw+=2}else{cT=null;if(cn===0){cb(aZ)}}if(cT!==null){cN=cU;cT=aY()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===aX){cT=aX;bw+=2}else{cT=null;if(cn===0){cb(aW)}}if(cT!==null){cN=cU;cT=aV()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===aU){cT=aU;bw+=2}else{cT=null;if(cn===0){cb(aT)}}if(cT!==null){cN=cU;cT=aS()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===aR){cT=aR;bw+=2}else{cT=null;if(cn===0){cb(aP)}}if(cT!==null){cN=cU;cT=aq()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===ap){cT=ap;bw+=2}else{cT=null;if(cn===0){cb(ao)}}if(cT!==null){cN=cU;cT=an()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===am){cT=am;bw+=2}else{cT=null;if(cn===0){cb(al)}}if(cT!==null){cN=cU;cT=aj()}if(cT===null){bw=cU;cU=cT}else{cU=cT}if(cU===null){cU=bw;if(bh.substr(bw,2)===ah){cT=ah;bw+=2}else{cT=null;if(cn===0){cb(ag)}}if(cT!==null){cS=bU();if(cS!==null){cR=bU();if(cR!==null){cN=cU;cT=af(cS,cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,2)===P){cT=P;bw+=2}else{cT=null;if(cn===0){cb(O)}}if(cT!==null){cS=bU();if(cS!==null){cR=bU();if(cR!==null){cQ=bU();if(cQ!==null){cP=bU();if(cP!==null){cN=cU;cT=N(cS,cR,cQ,cP);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}}}}}}}}return cU}function bS(){var cP;if(M.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(L)}}if(cP===null){cP=bY()}return cP}function bJ(){var cS,cR,cQ,cP;cS=bw;if(bh.charCodeAt(bw)===124){cR=K;bw++}else{cR=null;if(cn===0){cb(I)}}if(cR!==null){cQ=[];cP=bd();if(cP!==null){while(cP!==null){cQ.push(cP);cP=bd()}}else{cQ=aC}if(cQ!==null){if(bh.charCodeAt(bw)===124){cP=K;bw++}else{cP=null;if(cn===0){cb(I)}}if(cP!==null){cN=cS;cR=H(cQ);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}return cS}function bd(){var cQ,cP;if(G.test(bh.charAt(bw))){cQ=bh.charAt(bw);bw++}else{cQ=null;if(cn===0){cb(E)}}if(cQ===null){cQ=bw;if(bh.substr(bw,2)===aN){cP=aN;bw+=2}else{cP=null;if(cn===0){cb(aM)}}if(cP!==null){cN=cQ;cP=aL()}if(cP===null){bw=cQ;cQ=cP}else{cQ=cP}if(cQ===null){cQ=bY()}}return cQ}function aO(){var cS,cR,cQ,cP;cS=bw;if(bh.charCodeAt(bw)===40){cR=aJ;bw++}else{cR=null;if(cn===0){cb(aI)}}if(cR!==null){cQ=cH();if(cQ!==null){if(bh.charCodeAt(bw)===41){cP=aH;bw++}else{cP=null;if(cn===0){cb(aG)}}if(cP!==null){cN=cS;cR=aF();if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;if(bh.charCodeAt(bw)===91){cR=aE;bw++}else{cR=null;if(cn===0){cb(aD)}}if(cR!==null){cQ=cH();if(cQ!==null){if(bh.charCodeAt(bw)===93){cP=ae;bw++}else{cP=null;if(cn===0){cb(ad)}}if(cP!==null){cN=cS;cR=aF();if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}return cS}function bf(){var cQ,cP;cQ=bw;if(bh.substr(bw,2)===ac){cP=ac;bw+=2}else{cP=null;if(cn===0){cb(ab)}}if(cP!==null){cN=cQ;cP=aa()}if(cP===null){bw=cQ;cQ=cP}else{cQ=cP}return cQ}function Q(){var cP;cP=r();if(cP===null){cP=m();if(cP===null){cP=q();if(cP===null){cP=s()}}}return cP}function r(){var cT,cS,cR,cQ,cP;cT=bw;if(bh.substr(bw,2).toLowerCase()===Z){cS=bh.substr(bw,2);bw+=2}else{cS=null;if(cn===0){cb(Y)}}if(cS!==null){if(V.test(bh.charAt(bw))){cR=bh.charAt(bw);bw++}else{cR=null;if(cn===0){cb(U)}}if(cR===null){cR=av}if(cR!==null){cQ=[];if(S.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(D)}}if(cP!==null){while(cP!==null){cQ.push(cP);if(S.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(D)}}}}else{cQ=aC}if(cQ!==null){cP=X();if(cP!==null){cN=cT;cS=C(cR,cQ);if(cS===null){bw=cT;cT=cS}else{cT=cS}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}return cT}function m(){var cT,cS,cR,cQ,cP;cT=bw;if(bh.substr(bw,2).toLowerCase()===B){cS=bh.substr(bw,2);bw+=2}else{cS=null;if(cn===0){cb(A)}}if(cS!==null){if(V.test(bh.charAt(bw))){cR=bh.charAt(bw);bw++}else{cR=null;if(cn===0){cb(U)}}if(cR===null){cR=av}if(cR!==null){cQ=[];if(z.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(y)}}if(cP!==null){while(cP!==null){cQ.push(cP);if(z.test(bh.charAt(bw))){cP=bh.charAt(bw);bw++}else{cP=null;if(cn===0){cb(y)}}}}else{cQ=aC}if(cQ!==null){cP=X();if(cP!==null){cN=cT;cS=x(cR,cQ);if(cS===null){bw=cT;cT=cS}else{cT=cS}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}return cT}function q(){var cT,cS,cR,cQ,cP;cT=bw;if(bh.substr(bw,2).toLowerCase()===w){cS=bh.substr(bw,2);bw+=2}else{cS=null;if(cn===0){cb(v)}}if(cS!==null){if(V.test(bh.charAt(bw))){cR=bh.charAt(bw);bw++}else{cR=null;if(cn===0){cb(U)}}if(cR===null){cR=av}if(cR!==null){cQ=[];cP=bU();if(cP!==null){while(cP!==null){cQ.push(cP);cP=bU()}}else{cQ=aC}if(cQ!==null){cP=X();if(cP!==null){cN=cT;cS=u(cR,cQ);if(cS===null){bw=cT;cT=cS}else{cT=cS}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}return cT}function br(){var cT,cS,cR,cQ,cP;cT=bw;if(n.test(bh.charAt(bw))){cS=bh.charAt(bw);bw++}else{cS=null;if(cn===0){cb(l)}}if(cS!==null){if(V.test(bh.charAt(bw))){cR=bh.charAt(bw);bw++}else{cR=null;if(cn===0){cb(U)}}if(cR===null){cR=av}if(cR!==null){cQ=[];cP=a0();if(cP!==null){while(cP!==null){cQ.push(cP);cP=a0()}}else{cQ=aC}if(cQ!==null){cN=cT;cS=k(cS,cR,cQ);if(cS===null){bw=cT;cT=cS}else{cT=cS}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}}else{bw=cT;cT=aC}return cT}function s(){var cU,cT,cS,cR,cQ,cP,cW,cV;cU=bw;if(bh.substr(bw,2).toLowerCase()===j){cT=bh.substr(bw,2);bw+=2}else{cT=null;if(cn===0){cb(h)}}if(cT===null){cT=av}if(cT!==null){if(V.test(bh.charAt(bw))){cS=bh.charAt(bw);bw++}else{cS=null;if(cn===0){cb(U)}}if(cS===null){cS=av}if(cS!==null){cR=[];cQ=a0();while(cQ!==null){cR.push(cQ);cQ=a0()}if(cR!==null){if(bh.charCodeAt(bw)===46){cQ=bO;bw++}else{cQ=null;if(cn===0){cb(bN)}}if(cQ!==null){cP=[];cW=a0();if(cW!==null){while(cW!==null){cP.push(cW);cW=a0()}}else{cP=aC}if(cP!==null){cW=br();if(cW===null){cW=av}if(cW!==null){cV=X();if(cV!==null){cN=cU;cT=g(cS,cR,cP,cW);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,2).toLowerCase()===j){cT=bh.substr(bw,2);bw+=2}else{cT=null;if(cn===0){cb(h)}}if(cT===null){cT=av}if(cT!==null){if(V.test(bh.charAt(bw))){cS=bh.charAt(bw);bw++}else{cS=null;if(cn===0){cb(U)}}if(cS===null){cS=av}if(cS!==null){cR=[];cQ=a0();if(cQ!==null){while(cQ!==null){cR.push(cQ);cQ=a0()}}else{cR=aC}if(cR!==null){if(bh.charCodeAt(bw)===46){cQ=bO;bw++}else{cQ=null;if(cn===0){cb(bN)}}if(cQ!==null){cP=[];cW=a0();while(cW!==null){cP.push(cW);cW=a0()}if(cP!==null){cW=br();if(cW===null){cW=av}if(cW!==null){cV=X();if(cV!==null){cN=cU;cT=g(cS,cR,cP,cW);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,2).toLowerCase()===j){cT=bh.substr(bw,2);bw+=2}else{cT=null;if(cn===0){cb(h)}}if(cT===null){cT=av}if(cT!==null){if(V.test(bh.charAt(bw))){cS=bh.charAt(bw);bw++}else{cS=null;if(cn===0){cb(U)}}if(cS===null){cS=av}if(cS!==null){cR=[];cQ=a0();if(cQ!==null){while(cQ!==null){cR.push(cQ);cQ=a0()}}else{cR=aC}if(cR!==null){cQ=br();if(cQ===null){cQ=av}if(cQ!==null){cP=X();if(cP!==null){cN=cU;cT=f(cS,cR,cQ);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}}return cU}function o(){var cP;cP=bM();if(cP===null){cP=F()}return cP}function bM(){var cP;cP=ak();if(cP===null){cP=Q();if(cP===null){cP=R();if(cP===null){cP=bo();if(cP===null){cP=bg();if(cP===null){cP=aO();if(cP===null){cP=bf()}}}}}}return cP}function F(){var cP;cP=aQ();if(cP===null){cP=bv()}return cP}function p(){var cU,cT,cS,cR,cQ,cP;cU=bw;cT=o();if(cT!==null){cS=cH();if(cS!==null){if(bh.charCodeAt(bw)===46){cR=bO;bw++}else{cR=null;if(cn===0){cb(bN)}}if(cR!==null){cQ=cH();if(cQ!==null){cP=o();if(cP!==null){cN=cU;cT=e(cT,cP);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;cT=o();if(cT!==null){cS=cH();if(cS!==null){cR=p();if(cR!==null){cN=cU;cT=e(cT,cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;cT=o();if(cT!==null){cN=cU;cT=d(cT)}if(cT===null){bw=cU;cU=cT}else{cU=cT}}}return cU}function aQ(){var cU,cT,cS,cR,cQ,cP;cU=bw;if(bh.charCodeAt(bw)===40){cT=aJ;bw++}else{cT=null;if(cn===0){cb(aI)}}if(cT!==null){cS=cH();if(cS!==null){cR=p();if(cR!==null){cQ=cH();if(cQ!==null){if(bh.charCodeAt(bw)===41){cP=aH;bw++}else{cP=null;if(cn===0){cb(aG)}}if(cP!==null){cN=cU;cT=cO(cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.charCodeAt(bw)===91){cT=aE;bw++}else{cT=null;if(cn===0){cb(aD)}}if(cT!==null){cS=cH();if(cS!==null){cR=p();if(cR!==null){cQ=cH();if(cQ!==null){if(bh.charCodeAt(bw)===93){cP=ae;bw++}else{cP=null;if(cn===0){cb(ad)}}if(cP!==null){cN=cU;cT=cO(cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bH()}}return cU}function bH(){var cS,cR,cQ,cP;cS=bw;if(bh.substr(bw,2)===cM){cR=cM;bw+=2}else{cR=null;if(cn===0){cb(cK)}}if(cR!==null){cQ=cH();if(cQ!==null){cP=o();if(cP!==null){cN=cS;cR=cJ(cP);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;if(bh.charCodeAt(bw)===39){cR=cI;bw++}else{cR=null;if(cn===0){cb(cG)}}if(cR!==null){cQ=cH();if(cQ!==null){cP=o();if(cP!==null){cN=cS;cR=cF(cP);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;if(bh.charCodeAt(bw)===96){cR=cD;bw++}else{cR=null;if(cn===0){cb(cB)}}if(cR!==null){cQ=cH();if(cQ!==null){cP=o();if(cP!==null){cN=cS;cR=cA(cP);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}if(cS===null){cS=bw;if(bh.charCodeAt(bw)===44){cR=cz;bw++}else{cR=null;if(cn===0){cb(cx)}}if(cR!==null){cQ=cH();if(cQ!==null){cP=o();if(cP!==null){cN=cS;cR=cw(cP);if(cR===null){bw=cS;cS=cR}else{cS=cR}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}else{bw=cS;cS=aC}}}}return cS}function bv(){var cU,cT,cS,cR,cQ,cP,cV;cU=bw;if(bh.substr(bw,2)===cv){cT=cv;bw+=2}else{cT=null;if(cn===0){cb(cu)}}if(cT!==null){cS=cH();if(cS!==null){cR=[];cQ=bw;cP=o();if(cP!==null){cV=cH();if(cV!==null){cP=[cP,cV];cQ=cP}else{bw=cQ;cQ=aC}}else{bw=cQ;cQ=aC}while(cQ!==null){cR.push(cQ);cQ=bw;cP=o();if(cP!==null){cV=cH();if(cV!==null){cP=[cP,cV];cQ=cP}else{bw=cQ;cQ=aC}}else{bw=cQ;cQ=aC}}if(cR!==null){if(bh.charCodeAt(bw)===41){cQ=aH;bw++}else{cQ=null;if(cn===0){cb(aG)}}if(cQ!==null){cN=cU;cT=ct(cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}if(cU===null){cU=bw;if(bh.substr(bw,2)===cs){cT=cs;bw+=2}else{cT=null;if(cn===0){cb(cr)}}if(cT!==null){cS=cH();if(cS!==null){cR=[];cQ=bw;cP=o();if(cP!==null){cV=cH();if(cV!==null){cP=[cP,cV];cQ=cP}else{bw=cQ;cQ=aC}}else{bw=cQ;cQ=aC}while(cQ!==null){cR.push(cQ);cQ=bw;cP=o();if(cP!==null){cV=cH();if(cV!==null){cP=[cP,cV];cQ=cP}else{bw=cQ;cQ=aC}}else{bw=cQ;cQ=aC}}if(cR!==null){if(bh.charCodeAt(bw)===93){cQ=ae;bw++}else{cQ=null;if(cn===0){cb(ad)}}if(cQ!==null){cN=cU;cT=ct(cR);if(cT===null){bw=cU;cU=cT}else{cU=cT}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}else{bw=cU;cU=aC}}return cU}function cL(){var cT,cS,cR,cQ,cP;cT=bw;cS=[];cR=bw;cQ=o();if(cQ!==null){cP=cH();if(cP!==null){cQ=[cQ,cP];cR=cQ}else{bw=cR;cR=aC}}else{bw=cR;cR=aC}while(cR!==null){cS.push(cR);cR=bw;cQ=o();if(cQ!==null){cP=cH();if(cP!==null){cQ=[cQ,cP];cR=cQ}else{bw=cR;cR=aC}}else{bw=cR;cR=aC}}if(cS!==null){cN=cT;cS=cq(cS)}if(cS===null){bw=cT;cT=cS}else{cT=cS}return cT}be=bW();if(be!==null&&bw===bh.length){return be}else{T(a2);cN=Math.max(bw,a1);throw new a(a2,cN<bh.length?bh.charAt(cN):null,cN,J(cN).line,J(cN).column)}}return{SyntaxError:a,parse:b}})();ccc.libutil={};ccc.libutil.objectToNativeValue=function(b){var a=function(){throw new Error("Unable to convert object "+b+" to native value")};if(b===ccc.unspecified){return undefined}if(b===ccc.nil){return null}if(b===ccc.t){return true}if(b===ccc.f){return false}if(b.constructor===ccc.Number){return b.value_}if(b.constructor===ccc.String){return b.value_}if(b.constructor===ccc.Symbol){return b.name}if(b.constructor===ccc.Vector){return b.elements_.map(ccc.libutil.objectToNativeValue)}if(b.constructor===ccc.Pair){var c={};b.forEach(function(d){if(d.constructor!==ccc.Pair){a()}if(d.cdr().constructor!==ccc.Pair){a()}if(d.cdr().cdr()!==ccc.nil){a()}c[ccc.libutil.objectToNativeValue(d.car())]=ccc.libutil.objectToNativeValue(d.cdr().car())},function(){a()});return c}a()};ccc.libutil.objectFromNativeValue=function(e,b){if(e===undefined){return ccc.unspecified}if(e===null){return ccc.nil}if(e===true){return ccc.t}if(e===false){return ccc.f}if(+e===e){return new ccc.Number(e)}if(""+e===e){return new ccc.String(e)}if(e instanceof Array){if(b){return ccc.unspecified}var f=function(g){return ccc.libutil.objectFromNativeValue(g,true)};return new ccc.Vector(e.map(f))}if(e instanceof Object){if(b){return ccc.unspecified}var a=[];for(var c in e){if(e.hasOwnProperty(c)){var d=ccc.libutil.objectFromNativeValue(e[c],true);if(d!==undefined){a.push(ccc.Pair.makeList(new ccc.Symbol(c),d))}}}return ccc.Pair.makeList.apply(null,a)}throw new Error("Unable to convert native value "+e+" to object")};ccc.libutil.resolveNativeName=function(b){if(b.constructor===ccc.Symbol){return{object:window,value:window[b.name]}}else{if(b.constructor===ccc.Pair){var d=b.toArray().map(function(e){return e.toString()});var a=window;var c=window;while(c instanceof Object&&d.length>0){a=c;c=c[d.shift()]}if(d.length===0){return{object:a,value:c}}}}throw new Error("Unable to resolve native object name: "+b.toSource())};ccc.lib.base=new ccc.Library("base");(function(){var a=function(b){if(b.constructor===ccc.String){return b.value_}if(b.constructor===ccc.Symbol){return b.name}throw new Error("load: Names and prefixes must be symbols or strings")};ccc.lib.base.addNativeFunction("load",function(d,c,g){g=g.toArray();if(g.length<1){throw new Error("load: Expected at least 1 argument; received 0.")}for(var h=0;h<g.length;++h){var b=g[h];var f,j;if(b.constructor===ccc.Pair){f=a(b.car());j=a(b.cdr())}else{f=a(b);j=f}var e=ccc.lib[f];if(!e||e.constructor!==ccc.Library){throw new Error("load: Unknown library '"+f)}d.importLibrary(e,j)}return c(ccc.unspecified)})}());(function(){var b=function(f,d,e){if(f.constructor!==ccc.Number){throw new Error(e+": Argument "+d+" is not a number")}};ccc.lib.base.addSimpleFunctions({"+":function(){var d=0;Array.prototype.forEach.call(arguments,function(f,e){b(f,e,"+");d+=f.value_});return new ccc.Number(d)},"*":function(){var d=1;Array.prototype.forEach.call(arguments,function(f,e){b(f,e,"*");d*=f.value_});return new ccc.Number(d)},"-":function(){var d;if(arguments.length===0){throw new Error("-: Not enough arguments applied")}b(arguments[0],0,"-");if(arguments.length===1){return new ccc.Number(-arguments[0].value_)}else{d=arguments[0].value_}Array.prototype.slice.call(arguments,1).forEach(function(f,e){b(f,e+1,"-");d-=f.value_});return new ccc.Number(d)},"/":function(){var d;if(arguments.length===0){throw new Error("/: Not enough arguments applied")}b(arguments[0],0,"/");if(arguments.length===1){return new ccc.Number(1/arguments[0].value_)}else{d=arguments[0].value_}Array.prototype.slice.call(arguments,1).forEach(function(f,e){b(f,e+1,"/");d/=f.value_});return new ccc.Number(d)},"integer?":function(d){if(d.constructor===ccc.Number&&d.value_===(d.value_|0)){return ccc.t}return ccc.f},"zero?":function(d){b(d,0,"zero?");return d.value_===0?ccc.t:ccc.f},"positive?":function(d){b(d,0,"positive?");return d.value_>0?ccc.t:ccc.f},"negative?":function(d){b(d,0,"negative?");return d.value_<0?ccc.t:ccc.f},"even?":function(d){b(d,0,"even?");return d.value_%2===0?ccc.t:ccc.f},"odd?":function(d){b(d,0,"odd?");return d.value_%2===1?ccc.t:ccc.f},max:function(){var e=Array.prototype.slice.call(arguments);if(e.length===0){throw new Error("max: Expected at least 1 argument")}var d=e[0];b(d,0,"max");e.slice(1).forEach(function(g,f){b(g,f+1,"max");if(g.value_>d.value_){d=g}});return d},min:function(){var d=Array.prototype.slice.call(arguments);if(d.length===0){throw new Error("min: Expected at least 1 argument")}var e=d[0];b(e,0,"min");d.slice(1).forEach(function(g,f){b(g,f+1,"min");if(g.value_<e.value_){e=g}});return e},modulo:function(e,d){b(e,0,"modulo");b(d,1,"modulo");return new ccc.Number(e.value_%d.value_)},});var c=function(e,d){ccc.lib.base.addSimpleFunction(d,function(){var f=Array.prototype.slice.call(arguments);if(f.length!==e.length){throw new Error(d+": Expected exactly "+e.length+" arguments")}var g=f.map(function(i,h){b(i,h,d);return i.value_});return new ccc.Number(e.apply(null,g))})};c(Math.abs,"abs");c(Math.floor,"floor");c(Math.ceil,"ceiling");c(Math.exp,"exp");c(Math.log,"log");c(Math.sin,"sin");c(Math.cos,"cos");c(Math.tan,"tan");c(Math.asin,"asin");c(Math.acos,"acos");c(Math.sqrt,"sqrt");c(Math.pow,"expt");ccc.lib.base.addSimpleFunction("atan",function(){var d=Array.prototype.slice.call(arguments);if(d.length<1||d.length>2){throw new Error("atan: Expected 1 or 2 arguments")}b(d[0],0,"atan");if(d.length===1){return new ccc.Number(Math.atan(d[0].value_))}b(d[1],1,"atan");return new ccc.Number(Math.atan2(d[0].value_,d[1].value_))});var a=function(e,d){ccc.lib.base.addSimpleFunction(e,function(){var f=Array.prototype.slice.call(arguments);if(f.length<2){return ccc.t}var h=f[0];b(h,0,e);for(var g=1;g<f.length;++g){b(f[g],g,e);if(!d(h.value_,f[g].value_)){return ccc.f}h=f[g]}return ccc.t})};a("=",function(e,d){return e===d});a("<",function(e,d){return e<d});a(">",function(e,d){return e>d});a("<=",function(e,d){return e<=d});a(">=",function(e,d){return e>=d})}());(function(){var b=function(d){return function(e){return d(e)?ccc.t:ccc.f}};var a=function(d){return function(e){return e.constructor===d?ccc.t:ccc.f}};var c=function(d){return function(){var e=true;if(arguments.length<2){return ccc.t}var g=arguments[0];for(var f=1;f<arguments.length&&e;++f){e=e&&d(g,arguments[f])}return e?ccc.t:ccc.f}};ccc.lib.base.addSimpleFunctions({"boolean?":a(ccc.Boolean),"number?":a(ccc.Number),"string?":a(ccc.String),"char?":a(ccc.Char),"symbol?":a(ccc.Symbol),"pair?":a(ccc.Pair),"vector?":a(ccc.Vector),"null?":b(function(d){return d===ccc.nil}),"procedure?":b(function(d){return d.apply instanceof Function}),"eq?":c(function(e,d){return e.eq(d)}),"eqv?":c(function(e,d){return e.eqv(d)}),"equal?":c(function(e,d){return e.equal(d)}),not:b(function(d){return d===ccc.f}),})}());(function(){var b=function(e,c,d){if(e.constructor!==ccc.Pair){throw new Error(d+": Argument "+c+" is not a pair.")}};ccc.lib.base.addSimpleFunctions({car:function(c){b(c,0,"car");return c.car()},cdr:function(c){b(c,0,"cdr");return c.cdr()},cons:function(c,d){return new ccc.Pair(c,d)},list:function(){return ccc.Pair.makeList.apply(null,Array.prototype.slice.call(arguments))},"set-car!":function(d,c){b(d,0,"set-car!");d.car_=c},"set-cdr!":function(d,c){b(d,0,"set-cdr!");d.cdr_=c},length:function(d){if(d===ccc.nil){return new ccc.Number(0)}var c=0;b(d,0,"length");d.forEach(function(){++c},function(){throw new Error("length: Expected proper list")});return new ccc.Number(c)},append:function(){var e=Array.prototype.slice.call(arguments);var d=e.length>0?e[e.length-1]:ccc.nil;for(var f=e.length-2;f>=0;--f){var g=e[f];var c=[];if(g===ccc.nil){continue}b(g,f,"append");g.forEach(function(h){c.push(h)},function(){throw new Error("append: Argument "+f+" is not a proper list")});while(c.length>0){d=new ccc.Pair(c.pop(),d)}}return d},reverse:function(c){var d=ccc.nil;if(c===ccc.nil){return ccc.nil}b(c,0,"reverse");c.forEach(function(e){d=new ccc.Pair(e,d)},function(){throw new Error("reverse: Expected proper list")});return d},"list-tail":function(d,c){if(c.constructor!==ccc.Number){throw new Error("list-tail: Argument 1 is not a number")}if(c.value_<1){return d}c=c.value_;while(c>0){if(d.constructor!==ccc.Pair){throw new Error("list-tail: Wrong argument type")}d=d.cdr();--c}return d},"list-ref":function(d,c){if(c.constructor!==ccc.Number||c.value_<0){throw new Error("list-ref: Invalid index")}c=c.value_;while(c>0){if(d.constructor!==ccc.Pair){throw new Error("list-ref: Wrong argument type")}d=d.cdr();--c}if(d.constructor!==ccc.Pair){throw new Error("list-ref: Wrong argument type")}return d.car()},memq:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"memq");while(d.constructor===ccc.Pair){if(c.eq(d.car())){return d}d=d.cdr()}if(d!==ccc.nil){throw new Error("memq: Improper list")}return ccc.f},memv:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"memv");while(d.constructor===ccc.Pair){if(c.eqv(d.car())){return d}d=d.cdr()}if(d!==ccc.nil){throw new Error("memv: Improper list")}return ccc.f},member:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"member");while(d.constructor===ccc.Pair){if(c.equal(d.car())){return d}d=d.cdr()}if(d!==ccc.nil){throw new Error("member: Improper list")}return ccc.f},assq:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"assq");while(d.constructor===ccc.Pair){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assq: Invalid association list")}if(c.eq(e.car())){return e}d=d.cdr()}if(d!==ccc.nil){throw new Error("assq: Invalid association list")}return ccc.f},assv:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"assv");while(d.constructor===ccc.Pair){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assv: Invalid association list")}if(c.eqv(e.car())){return e}d=d.cdr()}if(d!==ccc.nil){throw new Error("assv: Invalid association list")}return ccc.f},assoc:function(c,d){if(d===ccc.nil){return ccc.f}b(d,1,"assoc");while(d.constructor===ccc.Pair){var e=d.car();if(e.constructor!==ccc.Pair){throw new Error("assoc: Invalid association list")}if(c.equal(e.car())){return e}d=d.cdr()}if(d!==ccc.nil){throw new Error("assoc: Invalid association list")}return ccc.f},});var a=function(f){var d="c"+f+"r";var c={a:ccc.Pair.prototype.car,d:ccc.Pair.prototype.cdr};var e=f.split("").map(function(g){return c[g]});e.reverse();ccc.lib.base.addSimpleFunction(d,function(g){e.forEach(function(h){if(g.constructor!==ccc.Pair){throw new Error(d+": Pair expected")}g=h.apply(g)});return g})};["aa","ad","da","dd","aaa","aad","ada","add","daa","dad","dda","ddd","aaaa","aaad","aada","aadd","adaa","adad","adda","addd","daaa","daad","dada","dadd","ddaa","ddad","ddda","dddd"].forEach(a)}());(function(){var d=function(h,f,g){if(h.constructor!==ccc.Number){throw new Error(g+": Argument "+f+" is not a number")}};var a=function(h,f,g){if(h.constructor!==ccc.Char){throw new Error(g+": Argument "+f+" is not a character")}};var e=function(g,f){ccc.lib.base.addSimpleFunction(g,function(i,h){a(i,0,g);a(h,1,g);return f(i.charCode_,h.charCode_)?ccc.t:ccc.f})};e("char=?",function(g,f){return g===f});e("char<?",function(g,f){return g<f});e("char>?",function(g,f){return g>f});e("char<=?",function(g,f){return g<=f});e("char>=?",function(g,f){return g>=f});var c=function(g,f){ccc.lib.base.addSimpleFunction(g,function(k,j){a(k,0,g);a(j,1,g);var i=String.fromCharCode(k.charCode_).toLocaleLowerCase().charCodeAt(0);var h=String.fromCharCode(j.charCode_).toLocaleLowerCase().charCodeAt(0);return f(i,h)?ccc.t:ccc.f})};c("char-ci=?",function(g,f){return g===f});c("char-ci<?",function(g,f){return g<f});c("char-ci>?",function(g,f){return g>f});c("char-ci<=?",function(g,f){return g<=f});c("char-ci>=?",function(g,f){return g>=f});var b=function(f,g){ccc.lib.base.addSimpleFunction(f,function(h){a(h,0,f);return String.fromCharCode(h.charCode_).match(g)?ccc.t:ccc.f})};b("char-alphabetic?",/[a-zA-Z]/);b("char-numeric?",/[0-9]/);b("char-whitespace?",/[ \t\f\r\n\v\xa0\u2000-\u200b\u2028\u2029\u202f\u3000]/);b("char-upper-case?",/[A-Z]/);b("char-lower-case?",/[a-z]/);ccc.lib.base.addSimpleFunctions({"char->integer":function(f){a(f,0,"char->integer");return new ccc.Number(f.charCode_)},"integer->char":function(f){d(f,0,"integer->char");if((f.value_|0)!==f.value_){throw new Error("integer->char: Expected integer")}return new ccc.Char(f.value_)},"char-upcase":function(f){a(f,0,"char-upcase");return new ccc.Char(String.fromCharCode(f.charCode_).toLocaleUpperCase().charCodeAt(0))},"char-downcase":function(f){a(f,0,"char-downcase");return new ccc.Char(String.fromCharCode(f.charCode_).toLocaleLowerCase().charCodeAt(0))},})}());(function(){var c=function(h,f,g){if(h.constructor!==ccc.String){throw new Error(g+": Argument "+f+" is not a string")}};var a=function(h,f,g){if(h.constructor!==ccc.Char){throw new Error(g+": Argument "+f+" is not a character")}};var d=function(h,f,g){if(h.constructor!==ccc.Number){throw new Error(g+": Argument "+f+" is not a number")}};ccc.lib.base.addSimpleFunctions({"make-string":function(g,f){d(g,0,"make-string");a(f,1,"make-string");return new ccc.String((Array(g.value_+1)).join(String.fromCharCode(f.charCode_)))},string:function(){var g=Array.prototype.slice.call(arguments);var f="";g.forEach(function(i,h){a(i,h,"string");f+=String.fromCharCode(i.charCode_)});return new ccc.String(f)},"string-length":function(f){c(f,0,"string-length");return new ccc.Number(f.value_.length)},"string-ref":function(g,f){c(g,0,"string-ref");d(f,1,"string-ref");f=f.value_|0;if(f<0||f>=g.value_.length){throw new Error("string-ref: Index out of bounds")}return new ccc.Char(g.value_.charCodeAt(f))},"string-set!":function(g,f,h){c(g,0,"string-set!");d(f,1,"string-set!");a(h,2,"string-set!");f=f.value_|0;if(f<0||f>=g.value_.length){throw new Error("string-set!: Index out of bounds")}g.value_=g.value_.substr(0,f)+String.fromCharCode(h.charCode_)+g.value_.substr(f+1)},substring:function(g,h,f){c(g,0,"substring");d(h,1,"substring");d(f,1,"substring");if(h>f){throw new Error("substring: Invalid range")}if(f>g.value_.length){throw new Error("substring: Index out of range")}return new ccc.String(g.value_.substring(h,f))},"string-append":function(){var g=Array.prototype.slice.call(arguments);var f="";g.forEach(function(h,i){c(h,i,"string-append");f+=h.value_});return new ccc.String(f)},"string->symbol":function(f){c(f,0,"string->symbol");return new ccc.Symbol(f.value_)},"symbol->string":function(f){if(f.constructor!==ccc.Symbol){throw new Error("symbol->string: Expected symbol; received "+f)}return new ccc.String(f.name)},"number->string":function(){var f=Array.prototype.slice.call(arguments);var g=10;if(f.length<1||f.length>2){throw new Error("number->string: Expected 1 or 2 arguments")}d(f[0],0,"number->string");if(f.length===2){d(f[1],1,"number->string");g=f[1].value_}return new ccc.String(f[0].value_.toString(g))},"string->number":function(){var f=Array.prototype.slice.call(arguments);var g=10;if(f.length<1||f.length>2){throw new Error("string->number: Expected 1 or 2 arguments")}if(f[0].constructor!==ccc.String){throw new Error("string->number: Argument 0 is not a string")}if(f.length===2){d(f[1],1,"string->number");g=f[1].value_}return new ccc.Number(parseInt(f[0].value_,g))},"string->list":function(f){c(f,0,"string->list");var h=[];for(var g=0;g<f.value_.length;++g){h.push(new ccc.Char(f.value_.charCodeAt(g)))}return ccc.Pair.makeList.apply(null,h)},"list->string":function(g){if(g!==ccc.nil&&g.constructor!==ccc.Pair){throw new Error("list->string: Argument 0 is not a list")}var f="";g.forEach(function(h){if(h.constructor!==ccc.Char){throw new Error("list->string: Expected list of characters")}f+=String.fromCharCode(h.charCode_)},function(){throw new Error("list->string: Argument 0 is not a proper list")});return new ccc.String(f)},"string-copy":function(f){c(f,0,"string-copy");return new ccc.String(f.value_)},"string-fill!":function(f,g){c(f,0,"string-fill!");a(g,1,"string-fill!");f.value_=(Array(f.value_.length+1)).join(String.fromCharCode(g.charCode_))},});var b=function(g,f){ccc.lib.base.addSimpleFunction(g,function(h,i){c(h,0,g);c(i,1,g);return f(h.value_,i.value_)?ccc.t:ccc.f})};b("string=?",function(g,f){return g===f});b("string<?",function(g,f){return g<f});b("string>?",function(g,f){return g>f});b("string<=?",function(g,f){return g<=f});b("string>=?",function(g,f){return g>=f});var e=function(g,f){ccc.lib.base.addSimpleFunction(g,function(h,i){c(h,0,g);c(i,1,g);return f(h.value_.toLocaleLowerCase(),i.value_.toLocaleLowerCase())?ccc.t:ccc.f})};e("string-ci=?",function(g,f){return g===f});e("string-ci<?",function(g,f){return g<f});e("string-ci>?",function(g,f){return g>f});e("string-ci<=?",function(g,f){return g<=f});e("string-ci>=?",function(g,f){return g>=f})}());(function(){var a=function(e,c,d){if(e.constructor!==ccc.Number||e.value_!==(e.value_|0)){throw new Error(d+": Argument "+c+" is not an integer")}};var b=function(e,c,d){if(e.constructor!==ccc.Vector){throw new Error(d+": Argument "+c+"is not a vector")}};ccc.lib.base.addSimpleFunctions({"make-vector":function(){var c=Array.prototype.slice.call(arguments);if(c.length===0){throw new Error("make-vector: Expected 1 or 2 argments; received 0")}if(c.length>2){throw new Error("make-vector: Expected 1 or 2 arguments; received "+c.length)}var f=c.length===2?c[1]:ccc.unspecified;var e=[];a(c[0],0,"make-vector");for(var d=0;d<c[0].value_;++d){e[d]=f}return new ccc.Vector(e)},vector:function(){var c=Array.prototype.slice.call(arguments);return new ccc.Vector(c)},"vector-length":function(c){b(c,0,"vector-length");return new ccc.Number(c.elements_.length)},"vector-ref":function(c,d){b(c,0,"vector-ref");a(d,1,"vector-ref");if(d<0||d>=c.elements_.length){throw new Error("vector-ref: Index out of bounds")}return c.elements_[d]},"vector-set!":function(c,e,d){b(c,0,"vector-ref");a(e,1,"vector-ref");if(e<0||e>=c.elements_.length){throw new Error("vector-ref: Index out of bounds")}c.elements_[e]=d},"vector->list":function(c){b(c,0,"vector->list");return ccc.Pair.makeList.apply(null,c.elements_)},"list->vector":function(d){if(d!==ccc.nil&&d.constructor!==ccc.Pair){throw new Error("list->vector: Argument 0 is not a list")}var c=[];d.forEach(function(e){c.push(e)},function(){throw new Error("list->vector: Argument 0 is not a proper list")});return new ccc.Vector(c)},"vector-fill!":function(c,d){b(c,0,"vector-fill!");for(var e=0;e<c.elements_.length;++e){c.elements_[e]=d}},})}());ccc.lib.base.addNativeFunction("call/cc",function(b,a,c){c=c.toArray();if(c.length!==1){throw new Error("call/cc: Exactly 1 argument expected.")}if(!(c[0].apply instanceof Function)){throw new Error("call/cc: Object "+c[0]+" is not applicable.")}return c[0].apply(b,a,ccc.Pair.makeList(new ccc.Continuation(a)))});ccc.lib.base.addNativeFunction("apply",function(b,a,c){c=c.toArray();if(c.length!==2){throw new Error("apply: Exactly 2 arguments expected")}var d=c[0];if(!(d.apply instanceof Function)){throw new Error("apply: Object "+d+" is not applicable.")}c=c[1];if(c!==ccc.nil&&(c.constructor!==ccc.Pair||!c.isList())){throw new Error("apply: Argument 1 is not a list")}return d.apply(b,a,c)});ccc.lib.base.addSimpleFunction("display",function(a){console.log(a.toSource())});ccc.lib.window=new ccc.Library("window");ccc.lib.window.addSimpleFunctions({"set-title":function(a){if(a.constructor!==ccc.String){throw new Error("set-title: Expected string; received "+a)}window.document.title=a.value_},});